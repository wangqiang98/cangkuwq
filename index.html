<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-day26" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/08/day26/" class="article-date">
  <time datetime="2020-08-08T06:07:46.000Z" itemprop="datePublished">2020-08-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/08/day26/">day26</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="css定位之position"><a href="#css定位之position" class="headerlink" title="css定位之position"></a>css定位之position</h1><h2 id="Position-static（默认定位"><a href="#Position-static（默认定位" class="headerlink" title="Position-static（默认定位)"></a>Position-static（默认定位)</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"./index.css"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>优课达<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>MOUNTAIN<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    The Facebook post was heartfelt. We like our little town just as it is:</span><br><span class="line">    Little. Homey. Just us’ns.</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img-box"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"first"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/1.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/2.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/3.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/4.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>LISTEN<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    Listen, I can empathize. As someone who’s lived in the Denver area since</span><br><span class="line">    1971 — right about the time John Denver’s songs were enticing folks to move</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>; <span class="comment">/*去掉默认的样式*/</span></span><br><span class="line">  <span class="attribute">font-family</span>: Sans-serif;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.84</span>);</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意: img 默认会根据图片自身的宽度展示，因此我们给他设置<strong>width: 100%， 撑</strong>满左右屏幕。</p>
<p>大家可能会发现，我们在index.css中并没有设置任何的position属性。浏览器会自动给所有的DOM元素，添加position: static ，如下图所示。</p>
<p><img src="https://document.youkeda.com/P3-1-HTML-CSS/1.8/1-static/1.png" alt></p>
<p>因此 static 遵循默认的文档流布局，top、left、right、bottom（我们在后面几节会讲到这几个属性）属性都无效。</p>
<p><strong>position</strong>除了static 属性值外，还有4个常用值,分别<br>为:➊<br><strong>●relative (相对定位)</strong><br><strong>●absolute (绝对定位)</strong><br><strong>●fixed (固定定位)</strong><br><strong>●sticky (粘性定位)</strong><br>接下来,我们分别来学些下这几个值有什么特点。</p>
<h2 id="position-relative-相对定位"><a href="#position-relative-相对定位" class="headerlink" title="position- relative(相对定位)"></a>position- relative(相对定位)</h2><p>position - relative(相对定位)<br>在上一节课的基础上，如果我们想让第一张图片往右下<br>角分别移动50px,如下效果图，那我们该怎么实现?</p>
<p><img src="https://document.youkeda.com/P3-1-HTML-CSS/1.8/2-relative/1.jpeg" alt></p>
<p><strong>可以使用position-relative</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.first</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意:</strong><br>relative先遵循默认的文档流布局也就是上一文说的static布局，然后再在不改变页面布局的前提下根据left、right、 top、 bottom 调整此元素的位置。也就是left、right、 top、 bottom 的调整都是相对于当前元素static布局位置进行的调整。<strong>relative也被称为相对定位</strong>.</p>
<h3 id="代码案例："><a href="#代码案例：" class="headerlink" title="代码案例："></a>代码案例：</h3><p>参考上文中的定位，修改 第二张图片 的 CSS 属性，让其往右移动 100px。如下效果图所示</p>
<p><img src="https://document.youkeda.com/P3-1-HTML-CSS/1.8/2-relative/3.jpeg" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 start--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//qgt-style.oss-cn-hangzhou.aliyuncs.com/commonJSCSS/console.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 end--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"./index.css"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>优课达<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>MOUNTAIN<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    The Facebook post was heartfelt. We like our little town just as it is:</span><br><span class="line">    Little. Homey. Just us’ns.</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img-box"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"first"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/1.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"secent"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/2.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/3.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/4.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>LISTEN<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    Listen, I can empathize. As someone who’s lived in the Denver area since</span><br><span class="line">    1971 — right about the time John Denver’s songs were enticing folks to move</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>; <span class="comment">/*去掉默认的样式*/</span></span><br><span class="line">  <span class="attribute">font-family</span>: Sans-serif;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.84</span>);</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">position</span>: static;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.secent</span>&#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line"> <span class="attribute">left</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="position-absolute-绝对定位"><a href="#position-absolute-绝对定位" class="headerlink" title="position -absolute(绝对定位)"></a>position -absolute(绝对定位)</h2><p>我们继续修改position的属性，在上面代码的基础上,如果我们把position: relative| 改为<br>position: absolute 结果会怎么样呢?</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.first</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://document.youkeda.com/P3-1-HTML-CSS/1.8/3-absolute/1.jpeg" alt></p>
<p>在图中和<strong>relative</strong> 相比较<br><strong>1.文档第一 张下面的所有DOM元素，自动往上移动占据了第一-张图片的位置， 文档流(布局)已经没有为第一张图预留空间了</strong><br><strong>2.第一张图片脱离了文档流，变成了第二个图层,再在新的图层中往右下偏移50px.</strong></p>
<p>在<strong>MDN</strong>中，訪描述为<strong>absolute被称为绝对定位绝对定位不为元素预留空间</strong>，通过指定元素相对于最近的非static定位祖先元素的偏移，来确定元素位置</p>
<p>我们重点理解下，什么叫<strong>做相对于最近的非static定位祖先元素的偏移?</strong><br>在这里，我们提取三个关键词<strong>最近和非static定位和祖先元素</strong>。<br>连贯起来分析下在上面的网页中，浏览器是怎么布局absolute 元素<br>的。<br>1.首先我们获取到第-张图片元素<br><img class="first" src="/.com//xxx"> ，我们发现它是absolute布<br>局<br>2.因此寻找它的父亲节点<div class="img-box"> ，我们发现此元索<br>并未配置position 属性，其遵循默认布局position = static,并不<br>符合非static要求。<br>3.因此继续找<div class="img-box"> 的父亲节点，找到&lt;body</div></div></p>
<p>4、<body>已经没有父亲节点了，所以按照<body> 的位置为标准进行<br>偏移⑦</body></body></p>
<p><strong>总结下: absolute (绝对定位)和relation (相对定位)的区别,</strong><br><strong>relation是相对自己进行top、left、 right、 bottom 进行偏移,而</strong><br><strong>absolute是寻找最近的非static的祖先节点进行偏移。</strong></p>
<h2 id="position-absolute-代码案例"><a href="#position-absolute-代码案例" class="headerlink" title="position-absolute 代码案例"></a>position-absolute 代码案例</h2><p><img src="https://document.youkeda.com/P3-1-HTML-CSS/1.8/3-absolute/4.png" alt></p>
<p><img src="https://document.youkeda.com/P3-1-HTML-CSS/1.8/3-absolute/8.jpeg" alt></p>
<p><strong>新知识</strong><br>section标签为HTML5中新增的标签，， 户表示一个区块，比div更有区块代表的含义script标签为Javascript脚本标签，于引入Javascript代码，大家先不用掌握,在这里是为了实现点击效果.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 start--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//qgt-style.oss-cn-hangzhou.aliyuncs.com/commonJSCSS/console.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 end--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"./post.css"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>优课达<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"java"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/new-learn-path/Bitmap.png"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"select"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./post.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">190px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">240px</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#f5f5f5</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.java</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">160px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">160px</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">36px</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: bold;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.select</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#bfbfbf</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> isSelected = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">const</span> box = <span class="built_in">document</span>.querySelector(<span class="string">'.box'</span>);</span><br><span class="line"><span class="keyword">const</span> select = <span class="built_in">document</span>.querySelector(<span class="string">'.select'</span>);</span><br><span class="line">box.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  isSelected = !isSelected;</span><br><span class="line">  <span class="keyword">if</span> (isSelected) &#123;</span><br><span class="line">    <span class="comment">// 如果是选择，则添加一个选中的图标</span></span><br><span class="line">    <span class="keyword">const</span> img = <span class="built_in">document</span>.createElement(<span class="string">'img'</span>);</span><br><span class="line">    img.src = <span class="string">'https://style.youkeda.com/img/sandwich/check.png'</span>;</span><br><span class="line">    img.style = <span class="string">'width: 100%; height: 100%;'</span>;</span><br><span class="line">    select.appendChild(img);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 如果不是选择，则清空图标</span></span><br><span class="line">    select.innerHTML = <span class="string">''</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="position-fixed-固定定位"><a href="#position-fixed-固定定位" class="headerlink" title="position-fixed(固定定位)"></a>position-fixed(固定定位)</h2><p><img src="http://document.youkeda.com/P3-1-HTML-CSS/1.8/4-fixed/6.png" alt></p>
<p>我们会发现无论怎么滚动，MOUNTAIN永远在窗口的左上角。<br><strong>fixed为固定定位</strong><br>固定定位和绝对定位类似，元素的包含块为屏幕视口(viewport)➊定定位不为元素预留空间，而是通过指定元素相对于屏在屏幕滚动时不会改变。</p>
<p><img src="http://document.youkeda.com/P3-1-HTML-CSS/1.8/4-fixed/2.jpeg" alt></p>
<p><strong>Z-index</strong></p>
<p>在刚才absolute ，fixed演示中，我们知道HTML页面<br>是由多个图层构成的，那浏览器怎么决定不同的图层优先级呢(到底是谁覆盖谁、谁在谁的上面，谁离观察者最近) ?这就是「z- index决定。默认非static元素的z-index都为0</p>
<ol start="2">
<li>z-index越大，则越在最上面，离观察者越近</li>
</ol>
<p>3.同样的z-index，在HTML中的元素越靠后，则越在最上面， 离观察者越近因此，分析下上面的场景中| </p><h1>MOUNTAIN</h1>元愫<p></p>
<div class="img -box"></div>元素都是非static元素,
z- index
都为0。
而因为<h1>在文档流前部，因此会被后者遮挡,所以
MOUNTAIN移动到图片区域时，被图片遮挡了，那我们如何解决?的z-index 大于0即可!大
家可以修改下代码，观察下效果，如下所示:

<p>h1 {<br>  position: fixed;<br>  left: 30px;<br>  top: 30px;<br>  <strong>z-index: 1;</strong><br>  color: yellowgreen;<br>}</p>
<h2 id="代码案例：-1"><a href="#代码案例：-1" class="headerlink" title="代码案例："></a>代码案例：</h2><p>在我们平时使用网页时，当我们页面往下滑动后，大家肯定遇到过置顶快捷按钮。如下图所示，下图是我截取的天猫超市的手机版图片，大家注意右下角红色框标注的区域。</p>
<p><img src="http://document.youkeda.com/P3-1-HTML-CSS/1.8/4-fixed/3.png" alt></p>
<p>在本次作业中，我们需要给我们的文章右下角加上如下元.素，让我们文章能够快速置顶，如下图所示。</p>
<p><img src="http://document.youkeda.com/P3-1-HTML-CSS/1.8/4-fixed/4.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 start--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//qgt-style.oss-cn-hangzhou.aliyuncs.com/commonJSCSS/console.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 end--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"./top.css"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>优课达<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>MOUNTAIN<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    The Facebook post was heartfelt. We like our little town just as it is:</span><br><span class="line">    Little. Homey. Just us’ns.</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img-box"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"first"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/1.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/2.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/3.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/4.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>LISTEN<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    Listen, I can empathize. As someone who’s lived in the Denver area since</span><br><span class="line">    1971 — right about the time John Denver’s songs were enticing folks to move</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"top"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">src</span>=<span class="string">"http://document.youkeda.com/P3-1-HTML-CSS/1.8/top.png"</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./top.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>; <span class="comment">/*去掉默认的样式*/</span></span><br><span class="line">  <span class="attribute">font-family</span>: Sans-serif;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.84</span>);</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">100</span>;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">color</span>: yellowgreen; <span class="comment">/*为了方便观看，我们修改MOUNTAIN的颜色*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.img-box</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.top</span> &#123;</span><br><span class="line"> </span><br><span class="line">  <span class="attribute">position</span>:fixed;</span><br><span class="line">  <span class="comment">/*完成top css*/</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">50px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> topDom = <span class="built_in">document</span>.querySelector(<span class="string">'.top'</span>);</span><br><span class="line">topDom.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">document</span>.body.scrollTop = <span class="built_in">document</span>.documentElement.scrollTop = <span class="number">0</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Position-大作业"><a href="#Position-大作业" class="headerlink" title="Position -大作业"></a>Position -大作业</h2><p>到现在为止，大家已经掌握了position |的4大主要的布局，我们做一个作业巩固下所学的知识。大家试着修改代码实现如下的效果:在每张图片右上角,加上图片名称，片1、片2、片3、图片4。</p>
<p><img src="http://document.youkeda.com/P3-1-HTML-CSS/1.8/5-homework/2.png" alt></p>
<p>为了实现每张图片的名称都显示在其右上角，我们需要把图片和名字包裹在一个容器里面，再利用学习到的绝对定位进行渲染.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 start--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//qgt-style.oss-cn-hangzhou.aliyuncs.com/commonJSCSS/console.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 end--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"./index.css"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>优课达<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>MOUNTAIN<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    The Facebook post was heartfelt. We like our little town just as it is:</span><br><span class="line">    Little. Homey. Just us’ns.</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img-box"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img-item"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"first"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/1.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>图片1<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img-item"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">        <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/2.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>图片2<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img-item"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">        <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/3.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>图片3<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img-item"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">        <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/4.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>图片4<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>LISTEN<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    Listen, I can empathize. As someone who’s lived in the Denver area since</span><br><span class="line">    1971 — right about the time John Denver’s songs were enticing folks to move</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>; <span class="comment">/*去掉默认的样式*/</span></span><br><span class="line">  <span class="attribute">font-family</span>: Sans-serif;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.84</span>);</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">img</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.img-item</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.img-item</span> &gt; <span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">right</span>:<span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">color</span>: yellow;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="position-sticky"><a href="#position-sticky" class="headerlink" title="position-sticky"></a>position-sticky</h2><p>h1 {<br>  position: sticky;<br>  color: yellowgreen;<br>  top: 50px;<br>  z-index: 1;<br>}</p>
<p><strong>sticky是新的position属性</strong>,右侧的编辑器不支持，会提醒warning,没关系,大家忽略它。<br>这个布局是position的新特性, sticky 中文叫做粘性，因此这种布局，我们叫做<strong>粘性布局。</strong></p>
<p>在很多网站都有 sticky 效果，我们来看几个实际场景，大家可以实际滚动页面，观察高亮元素的位置。</p>
<p><img src="https://document.youkeda.com/P3-1-HTML-CSS/1.8/6-sticky/2.png" alt></p>
<p><img src="https://document.youkeda.com/P3-1-HTML-CSS/1.8/6-sticky/3.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"./index.css"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>优课达<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"first"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">alt</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">    <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/1.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>MOUNTAIN<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    The Facebook post was heartfelt. We like our little town just as it is:</span><br><span class="line">    Little. Homey. Just us’ns.</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img-box"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"first"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/1.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/2.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/3.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">""</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">"https://document.youkeda.com/P3-1-HTML-CSS/1.8/4.jpg?x-oss-process=image/resize,h_300"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>LISTEN<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    Listen, I can empathize. As someone who’s lived in the Denver area since</span><br><span class="line">    1971 — right about the time John Denver’s songs were enticing folks to move</span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>; <span class="comment">/*去掉默认的样式*/</span></span><br><span class="line">  <span class="attribute">font-family</span>: Sans-serif;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.84</span>);</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/08/day26/" data-id="ckdn9i6ni000ojwuxb0tl1e2g" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/css-%E5%AE%9A%E4%BD%8D-position/" rel="tag">css 定位- position</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-day25" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/08/day25/" class="article-date">
  <time datetime="2020-08-08T01:28:13.000Z" itemprop="datePublished">2020-08-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/08/day25/">day25</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="盒模型–content"><a href="#盒模型–content" class="headerlink" title="盒模型–content"></a>盒模型–content</h2><p>content首先我们要学习的是div的content。<br>div标签写出来的时候是<br>没有高度的，但是有宽度，宽度默认和父标签的宽度是一样的。比<br>如我们在页面中只写一句代码:➊</p>
<div> </div>

<p>这里所说的宽度不是肉眼看到的宽度，而是width属性设置的宽度width/height要画一个矩形，首先要设置矩形的宽高，矩形的宽高对应两个CSS属性width，height ，它们的值是数字，单位是px。下面我们来画一个宽200px,高100px的矩形:<br>核心代码如下:</p>
<div class="box"></div>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="selector-tag">DOCTYPE</span> <span class="selector-tag">html</span>&gt;</span><br><span class="line">&lt;html lang="en"&gt;</span><br><span class="line">&lt;<span class="selector-tag">head</span>&gt;</span><br><span class="line">    &lt;meta charset="UTF-8"&gt;</span><br><span class="line">    &lt;title&gt;案例&lt;/title&gt;</span><br><span class="line">    &lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line">      <span class="comment">/*给div设置宽高，并添加背景颜色*/</span></span><br><span class="line">      <span class="selector-class">.box</span>&#123;</span><br><span class="line">        <span class="attribute">width</span>:<span class="number">200px</span>;</span><br><span class="line">        <span class="attribute">height</span>:<span class="number">100px</span>;</span><br><span class="line">        <span class="attribute">background-color</span>:purple;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;<span class="selector-tag">body</span>&gt;</span><br><span class="line">    &lt;!<span class="selector-tag">--</span> 定义一个<span class="selector-tag">div</span>标签 <span class="selector-tag">--</span>&gt;</span><br><span class="line">    &lt;div class="box"&gt;&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h4 id="百分百尺寸"><a href="#百分百尺寸" class="headerlink" title="百分百尺寸"></a>百分百尺寸</h4><p>设置块元素的宽高，除了px 形式,还有%形式，比如说:</p>
<div class="father">
<div class="son"></div>
</div>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">, father &#123;</span><br><span class="line">width: 200px;</span><br><span class="line">height: 80px;</span><br><span class="line">background-color: #5b6dcd;</span><br><span class="line">&#125;</span><br><span class="line">.son &#123;</span><br><span class="line">width: 60%;</span><br><span class="line">height: 20%;</span><br><span class="line">background-color: #fec03e;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="任务案例"><a href="#任务案例" class="headerlink" title="任务案例"></a>任务案例</h4><p>1.在index.html中的body标签内添加一-个div标签，并设置类名,类名.为box<br>2.在index.css文件中用类选择器设置div的属性，要求设置一个宽200px，高100px，背景颜色为#000000的矩形</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 start--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//qgt-style.oss-cn-hangzhou.aliyuncs.com/commonJSCSS/console.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 end--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>练习<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"index.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#000000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="盒模型–padding"><a href="#盒模型–padding" class="headerlink" title="盒模型–padding"></a>盒模型–padding</h2><p>经过.上一节的学习，大家已经了解了盒模型的一部分，即内容部分，接下来要学习的是盒模型中的<strong>内边距–padding</strong>，比如说我们最常见的网页的标题栏部分(点击可以放大图片):</p>
<p><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/P3-1-HTML-CSS/1.7/taobao-padding.png" alt></p>
<p>我们可以很清楚的看到，由绿色边框圈起来的文字，距离上、下、左、右都有一定的距离，或许这个例子看起来有点难受，它太小了，我们可以换一个更大更明显的例子:</p>
<p><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/P3-1-HTML-CSS/1.7/google-padding.png" alt></p>
<p>核心代码如下;</p>
<div class="box">
    All afternoon his tractor pulls a flat wagon with bales to the barn, then back to the waiting chopped field. 
    It trails a feather of smoke. Down the block we bend with the season: shoes to polish for a big game,storm windows to batten or patch. 
    And how like a field is the whole sky now that the maples have shed their leaves, too.
</div>

<p>.box{<br>    width:300px;<br>    height:300px;<br>    background-color:purple;<br>    padding:20px;<br>    color:white;<br>}</p>
<p><strong>更好理解</strong></p>
<p><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/P3-1-HTML-CSS/1.7/padding-explore.png" alt></p>
<h4 id="padding简写"><a href="#padding简写" class="headerlink" title="padding简写"></a>padding简写</h4><p>学习padding分开写的形式主要是为了更好的理解如何简写padding，现在我们知道了padding 分为top、right、bottom、left ，在简写的时候就会从这四个方向，上去设置。之前我们知道这种形式的简写padding: 20px ，意思是给content的上、右、下、四个方向.上都设置了相同的padding，它最初的形式是这样：<br>div{<br>padding: 20px 20px 20px 20px;<br>}</p>
<h4 id="box-sizing"><a href="#box-sizing" class="headerlink" title="box-sizing"></a>box-sizing</h4><p>box-sizing规定了如何计算一个元素的总宽度和高度, 它有两个<br>值content-box ，border-box, 默认是content-box。</p>
<p><strong>content-box尺寸计算公式:</strong><br>width =内容的宽度<br>height =内容的高度<br>border _box尺寸计算公式:<br>width = border + padding +内容的宽度<br>height = border + padding +内容的高度<br>这里的内容就是我们学过的<br>content，border 属性我们还没有学，但是在这里已经可以说明一下box-sizing属性的性质，下一节学习border的时候，我们会将border 的尺寸也算进去。</p>
<div class="father">
    <div class="son"></div>
</div>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.father&#123;</span><br><span class="line">    width:200px;</span><br><span class="line">    height: 100px;</span><br><span class="line">    background-color: #5C70CA; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.son&#123;</span><br><span class="line">    /* 修改box-sizing */</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 40px;</span><br><span class="line">    /* 添加padding */</span><br><span class="line">    padding: 0px 20px;</span><br><span class="line">    background-color:#FEC03E;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="任务案例-1"><a href="#任务案例-1" class="headerlink" title="任务案例"></a>任务案例</h4><p>按照步骤实现如下效果:</p>
<p>在淡淡的朝阳下，<br>昏昏的夕阳中，<br>倾洒着如梦的歌声。<br>凭风凝伫，<br>遥望着、细述着，<br>层层诗意映在月明中….</p>
<p><strong>步骤:</strong><br>在index.css文件中设置矩形的宽为300px，高为300px ，背景颜.色为#6699CC ，padding 为15px</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 start--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//qgt-style.oss-cn-hangzhou.aliyuncs.com/commonJSCSS/console.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 end--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>练习<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"index.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"font-box"</span>&gt;</span></span><br><span class="line">        在淡淡的朝阳下，<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        昏昏的夕阳中，<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        倾洒着如梦的歌声。<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        凭风凝伫，<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        遥望着、细述着，<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        层层诗意映在月明中……<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.font-box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#6699cc</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="案例二"><a href="#案例二" class="headerlink" title="案例二"></a>案例二</h4><p>不禁感叹多少游子们自从工作后，故乡对<br>于自己来说便只有冬，再也没有了春、<br>夏、秋啊!<br>乡音裊裊，生生扯落眼底的泪。即便是在<br>一个城市多年，依旧感觉像是在漂泊，没<br>有家的感觉。<br>在index.css中的. todo中为矩形添加内边距，要求:<br>1.左侧内边距为10px<br>2.顶部内边距为30px<br>3.右侧内边距为20px观察你所设置的内边距是否各不相同</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 start--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//qgt-style.oss-cn-hangzhou.aliyuncs.com/commonJSCSS/console.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 end--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>练习<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"index.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"base todo"</span>&gt;</span></span><br><span class="line">        不禁感叹多少游子们自从工作后，故乡对于自己来说便只有冬，再也没有了春、夏、秋啊！<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        乡音袅袅，生生扯落眼底的泪。即便是在一个城市多年，依旧感觉像是在漂泊，没有家的感觉。</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.base</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: deeppink;</span><br><span class="line">    <span class="attribute">color</span>: whitesmoke;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.todo</span> &#123;</span><br><span class="line">    <span class="attribute">padding-top</span>: <span class="number">30px</span>; <span class="comment">/*上内边距*/</span></span><br><span class="line">    <span class="attribute">padding-right</span>: <span class="number">20px</span>; <span class="comment">/*右内边距*/</span></span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="number">30px</span>; <span class="comment">/*下内边距*/</span></span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="number">10px</span>; <span class="comment">/*左内边距*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="盒模型–border"><a href="#盒模型–border" class="headerlink" title="盒模型–border"></a>盒模型–border</h2><p>学习了盒模型的<strong>content、| padding</strong> 之后，基本上我们就可以满足很多开发的需求，接下来我们要学习的是盒模型中的<strong>边框- -border。</strong><br><strong>边框就是包裏在padding外面的一层线，说到线,肯定会有粗细、颜色，</strong>首先我们要学习如何给一个矩形设置边框线。给矩形设置边框线设置边框线的语法是(请注意花括号里面的内容，.box 是类名，类名是可以自己定义的):</p>
<p>.box {<br>  /* 设置矩形大小 <em>/<br>  width: 200px;<br>  height: 30px;<br>  /</em> 设置边框线 */<br>  border-width: 2px;<br>  border-color: grey;<br>  border-style: solid;<br>}</p>
<h6 id="具体使用方法"><a href="#具体使用方法" class="headerlink" title="具体使用方法"></a>具体使用方法</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>案例<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.box</span>&#123;</span></span><br><span class="line"><span class="css">    <span class="comment">/*设置矩形的宽*/</span></span></span><br><span class="line"><span class="css">    <span class="selector-tag">width</span><span class="selector-pseudo">:300px</span>;</span></span><br><span class="line"><span class="css">    <span class="comment">/*设置矩形的高*/</span></span></span><br><span class="line"><span class="css">    <span class="selector-tag">height</span><span class="selector-pseudo">:150px</span>;</span></span><br><span class="line"><span class="css">    <span class="comment">/*设置矩形的背景颜色*/</span></span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span><span class="selector-pseudo">:white</span>;</span></span><br><span class="line"><span class="css">    <span class="comment">/*设置矩形的边框*/</span></span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-width</span><span class="selector-pseudo">:2px</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-color</span><span class="selector-pseudo">:black</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">border-style</span><span class="selector-pseudo">:solid</span>;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 定义一个div标签 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="分别使用边框"><a href="#分别使用边框" class="headerlink" title="分别使用边框"></a>分别使用边框</h4><p>在我们学习padding 的时候，我们曾经给padding 的上下左右设<br>置了不同的值，那么在border中同样是可以这样设置的。</p>
<p>.box {<br>  /<em>设置顶部border</em>/<br>  border-top-color: blue;<br>  border-top-style: solid;<br>  border-top-width: 2px;<br>  /<em>那么接下来，left，right，bottom是类似的，这里忽略不写</em>/<br>}</p>
<p><strong>重点关注：</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="comment">/* 添加顶部border */</span></span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">1px</span> solid black;</span><br><span class="line">  <span class="comment">/*添加右侧border*/</span></span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">3px</span> solid orange;</span><br><span class="line">  <span class="comment">/*添加底部border*/</span></span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">5px</span> dashed pink;</span><br><span class="line">  <span class="comment">/*添加左侧border*/</span></span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">10px</span> dashed purple;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>无边框：</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">border-bottom</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="圆角"><a href="#圆角" class="headerlink" title="圆角"></a>圆角</h4><p>在很多场景下，矩形一般都不是四四方方的，需要一点点的圆角来点缀,圆角的属性是归类于边框的，即border- radius。有了之前的基础，相信圆角对大家来说很好理解。</p>
<h4 id="圆角的统一设置"><a href="#圆角的统一设置" class="headerlink" title="圆角的统一设置"></a>圆角的统一设置</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="圆角的分开设置"><a href="#圆角的分开设置" class="headerlink" title="圆角的分开设置"></a>圆角的分开设置</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: violet;</span><br><span class="line">  <span class="attribute">border-top-left-radius</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">border-top-right-radius</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border-bottom-left-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border-bottom-right-radius</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="阴影"><a href="#阴影" class="headerlink" title="阴影"></a>阴影</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#c4c4c4</span>;</span><br><span class="line">  <span class="comment">/* x偏移量 | y偏移量 | 阴影模糊半径 | 阴影扩散半径 | 阴影颜色 */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">2px</span> <span class="number">2px</span> <span class="number">2px</span> <span class="number">1px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="盒模型–border代码案例"><a href="#盒模型–border代码案例" class="headerlink" title="盒模型–border代码案例"></a>盒模型–border代码案例</h4><p><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/P3-1-HTML-CSS/1.7/exercse-pic/7-3-1-%E8%AE%BE%E8%AE%A1%E5%9B%BE.png" alt></p>
<p>页面中:<br>●蓝色的背景颜色为:| #0091ff<br>●黑文字颜色为: #333333， 白色文字颜色为: f#ffff<br>●字体大小为:16px .</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 start--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//qgt-style.oss-cn-hangzhou.aliyuncs.com/commonJSCSS/console.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 end--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>练习<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"index.css"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"current"</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>优课达学院<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>App下载<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="attribute">list-style</span>: none;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333333</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#a4a4a4</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">  <span class="comment">/* </span></span><br><span class="line"><span class="comment">        display:inline-block可以让一个块元素和行内元素在同一行显示</span></span><br><span class="line"><span class="comment">        具有想同属性的块元素也可以并排显示</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">padding-right</span>: <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">60px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-class">.current</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#0091ff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="代码案例："><a href="#代码案例：" class="headerlink" title="代码案例："></a>代码案例：</h4><p><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/P3-1-HTML-CSS/1.7/exercse-pic/3-2%E8%AE%BE%E8%AE%A1%E5%9B%BE.png" alt></p>
<p>●矩形阴影的x轴偏移量为0，y轴偏移量为1px,模糊度为17px,<br>不扩散，阴影颜色为rgb(0, 0, 0)，透明度为0.1 .<br>●矩形圆角为7px<br>●“教学目标”文字的字体大小为14px,字体颜色为rgb(0,0,0)透明度为0.65,文字居中显示<br>●介绍内容的文字字体大小为12px,文字颜色为#2c2c2c</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 start--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//qgt-style.oss-cn-hangzhou.aliyuncs.com/commonJSCSS/console.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 end--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>练习<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"index.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>教学目标<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>统地学习数据体系：MySQL、Redis、Mongodb 并深入全栈能力包括 Vue 框架和 SSM</span><br><span class="line">            框架（Spring、SpringMVC、MyBatis），掌握处理大数据的能力，可以独立完成复杂而真实的项目，比如美团外卖。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h3</span>,</span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">280px</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">17px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">7px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.65</span>);</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#2c2c2c</span>;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="盒模型–-margin"><a href="#盒模型–-margin" class="headerlink" title="盒模型– margin"></a>盒模型– margin</h2><p>在这一节我们要学习的是盒模型中的margin—外边距。所谓外边距就是矩形和矩形之间的距离，我们可以看一下下面这张图:</p>
<p><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/P3-1-HTML-CSS/1.7/margin1.png" alt></p>
<p>如果想要中间红色边框的矩形与四周绿色背景的矩形之间有一定的间隙，就可以给红色边框的矩形设置-个margin属性。接下来我们来实现一下下图的页面效果，来感受一下margin的作用<br>(因为我们还没有学习浮动，所以暂时还不能设置左右margin) :</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>案例<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        div &#123;</span><br><span class="line">            width: 300px;</span><br><span class="line">            height: 100px;</span><br><span class="line"><span class="css">            <span class="selector-tag">background-color</span>: <span class="selector-id">#D5E8D4</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#82B366</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="css">        <span class="selector-class">.box</span>&#123;</span></span><br><span class="line"><span class="css">          <span class="selector-tag">background-color</span>: <span class="selector-id">#F5F5F5</span>;</span></span><br><span class="line"><span class="css">          <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#FF0818</span>;</span></span><br><span class="line">          margin-top: 20px;</span><br><span class="line">          margin-bottom: 20px;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="两个盒子之间margin的计算"><a href="#两个盒子之间margin的计算" class="headerlink" title="两个盒子之间margin的计算"></a>两个盒子之间margin的计算</h6><h6 id="水平距离"><a href="#水平距离" class="headerlink" title="水平距离"></a>水平距离</h6><p>首先我们来看最容易理解的水平距离，下图中，第- -个盒子的右margin为30px，第二个盒子的左margin为20x，那么最后两个盒子之间的水平距离就是30px+ 20px= 50px;如果第二个盒 子没有设置magrin-left，那么默认为第二个 盒子的margin-left为0px。</p>
<p><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/P3-1-HTML-CSS/1.7/leftandrightmargin.png" alt></p>
<p>垂直距离<br>水平距离很符合我们的常规理解，但是垂直距离就略有不同，垂直距离取两个盒子margin的最大值。<br>如下图所示，首先，只给其中一个盒舒设置margin-bottom,两个盒子之间的垂直距离就是第-个盒子的margin-bottom;然后，给第二个盒子设置- -个margin-top, 但是值小于第一个子的margin-bottom的值，得到两个盒子之间的垂直距离，是取两个margin的最大值;<br>后，将下方盒子的margin-top设置为50px，大于第一个盒子的margin-bottom,两盒子之间的垂直距离变成了50px。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box1</span>&#123;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因此，要设置两个盒子之间的垂直距离，选择其中的一个去设置即可。</p>
<h5 id="盒子左右居中"><a href="#盒子左右居中" class="headerlink" title="盒子左右居中"></a>盒子左右居中</h5><p>margin还有一个作用就是使 盒子可以在父盒子中左右居中,但是有<br>一个前提， 就是必须有宽度。。<br>例如下面这个案例:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"father"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"son"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">400px</span>;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.son</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">margin</span>:<span class="number">0</span> auto;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="代码案例"><a href="#代码案例" class="headerlink" title="代码案例"></a>代码案例</h4><p><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/P3-1-HTML-CSS/1.7/exercse-pic/4-1-%E8%AE%BE%E8%AE%A1%E5%9B%BE1.png" alt></p>
<p>题目要求:<br>●边框颜色为#c4c4c4，粗细为1px,实线<br>鞋子描述，字体大小为14px,字体颜色为#333333,行鎬<br>20px,超出部分要隐藏，文字区域宽度为135px<br>●价格文字大小为18px,字体颜色为#FF0036，行高1 8px</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 start--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//qgt-style.oss-cn-hangzhou.aliyuncs.com/commonJSCSS/console.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 end--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"index.css"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://gw.alicdn.com/bao/uploaded/i1/749716436/O1CN01OSPWqa1xPjeErSSzf_!!749716436-0-pixelsss.jpg"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"introduce"</span>&gt;</span>人本春季红色帆布鞋男网红休闲布鞋潮鞋百搭运动小白鞋子男运动鞋<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"price"</span>&gt;</span> ¥78.3 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">234px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#c4c4c4</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span> <span class="number">0px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">185px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">185px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.introduce</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">135px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">8px</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.price</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#FF0036</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">10px</span> auto <span class="number">0px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="盒模型-display-inline-inline-block"><a href="#盒模型-display-inline-inline-block" class="headerlink" title="盒模型-display:inline/inline-block"></a>盒模型-display:inline/inline-block</h2><h4 id="inline"><a href="#inline" class="headerlink" title="inline"></a>inline</h4><p>在上一节我们已经用过inline ，在这一节我们需要更细致的探索<br><strong>它的性质:</strong><br>1.行内元素不能设置宽、高;这个属性我们在上一节的时候已经接触，这里不做解释<br>2.行内元素可以设置padding ;<br><a href="#">超链接</a><br>a{<br>bac kground-color: #fff2cc;<br>padding: 20px;<br>}</p>
<p><strong>2.行内元素可以设置padding ;</strong></p>
<p><a href="#">超链接</a></p>
<p>a {<br>  background-color: #fff2cc;<br>  padding: 20px;<br>}</p>
<p><strong>3.行内元素可以设置左右margin，但是不能设置上下margin</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">a &#123;</span><br><span class="line">  margin-left: 40px;</span><br><span class="line">  margin-right: 30px;</span><br><span class="line">  margin-top: 400px;</span><br><span class="line">  margin-bottom: 400px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">span &#123;</span><br><span class="line">  margin-left: 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">div &#123;</span><br><span class="line">  width: 300px;</span><br><span class="line">  height: 50px;</span><br><span class="line">  background-color: #b0e3e6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="inline-block"><a href="#inline-block" class="headerlink" title="inline-block"></a>inline-block</h2><p>从名字可以看出，inline-block 既具有block 的性质，还具有<br>inline的性质，可以简单的理解为，inline-block 就是一个可<br>以在同一-行显示的块元素。<br>inline -block要比block在应用中更为广泛，因为我们更多的时候需要的是一个能和其他元素共存的盒子，相比而言，block 显得较为孤僻。关于inline- block这个值的作用，大家可以根据block的性质去理解，这里主要给大家介绍一下空白折叠的现象。按照常理，我们将div的display属性从block切换成inline-block之后,我们希望得到的效果是这样的:</p>
<p><strong>空白折叠</strong></p>
<p>可以看到，两个盒子中间多了一点空白，但是我们并没有设置margin，这就是传说中的空白折叠现象，其原因就是因为两个div之间多了一个回车，在html中，回车被当作是一个文字，所以这里的空白就是文字的空白，相当于在两个div之间加了一个字母。</p>
<p><strong>解决方法：</strong></p>
<p><strong>1、去除回车</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 将div标签写在一行 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff2cc</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box2</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#b0e3e6</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2. 给父元素添加 word-spacing 属性</strong></p>
<p>word- spacing就是单词和单词之间的距离,这里将这个距离写成负值就可以了，这个值要尽量小，我们一般写于-20px的值。➊<br>具体做法如下:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"father"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">word-spacing</span>: -<span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff2cc</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box2</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#b0e3e6</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3.给父元素设置font-size: 0px;</strong><br>从第二点我们了解到，回车可以当作是一个文字,那么如果将文字<br>大小设置为0，空隙自然就会消失。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"father"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff2cc</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box2</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#b0e3e6</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="代码案例-1"><a href="#代码案例-1" class="headerlink" title="代码案例"></a>代码案例</h4><p>根据要求完成代码：</p>
<p><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/P3-1-HTML-CSS/1.7/exercse-pic/6-1-%E8%AE%BE%E8%AE%A1%E5%9B%BE.png" alt></p>
<p><strong>题目要求:</strong><br>●将li标签:<br>  。字体大小为12px<br>。字体颜色为#fffff<br>。文字左右居中<br>。背景颜色为#783A3E<br>list-style: none;属性是为了去除li标签前面默认的小圆点o</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 start--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//qgt-style.oss-cn-hangzhou.aliyuncs.com/commonJSCSS/console.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 end--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>案例<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"index.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"father"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span>手机<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box2"</span>&gt;</span>电视<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box3"</span>&gt;</span>电脑<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box4"</span>&gt;</span>路由器<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">li</span> &#123;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.father</span> &#123;<span class="attribute">display</span>: inline-block;</span><br><span class="line">   <span class="attribute">font-size</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box1</span>&#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">70px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#783A3E</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">display</span>:inline-block;   <span class="comment">/* 使所有盒子在同一行*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box2</span>&#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">70px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#783A3E</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">display</span>:inline-block;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box3</span>&#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">70px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#783A3E</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">display</span>:inline-block;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box4</span>&#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">70px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#783A3E</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">display</span>:inline-block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="代码案例二"><a href="#代码案例二" class="headerlink" title="代码案例二"></a>代码案例二</h2><p><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/P3-1-HTML-CSS/1.7/exercse-pic/6-2-%E8%AE%BE%E8%AE%A1%E5%9B%BE.png" alt></p>
<p>●页面中所有文字颜色均为#ffff<br>●顶部”商品分类”背景色为#C60A0A, “天猫双十背景色为#464444， 底部列表背景色为#413F3F<br>●“商品分类”、”天猫双十一”字体大小为12px<br>●列表边框颜色为#cb0c10,粗细1px,倒角10px<br>●列表里的每个选项都是超链接,要用a标签包裹起来，可点击范围不能只是文字，而是红色边框内的所有区域。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 start--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//qgt-style.oss-cn-hangzhou.aliyuncs.com/commonJSCSS/console.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--系统内置 end--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>案例<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"index.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"head"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"head-first"</span>&gt;</span>商品分类<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"head-second"</span>&gt;</span>天猫双十一<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>大牌女装<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>运动户外<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>潮流男装<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>美妆洗护<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>母婴好货<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>数码家电<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>家具建材<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>全球尖货<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>苏宁易购<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>汽车用品<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ul</span>,</span><br><span class="line"><span class="selector-tag">li</span> &#123;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.head</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">0px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.head</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">36px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.head</span> <span class="selector-class">.head-first</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#C60A0A</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.head</span> <span class="selector-class">.head-second</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#464444</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.list</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">padding-top</span>: <span class="number">29px</span>;</span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#413F3F</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.list</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="number">24px</span>;</span><br><span class="line">    <span class="attribute">padding-right</span>: <span class="number">24px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.list</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#cb0c10</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">29px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/08/day25/" data-id="ckdn9i6nq000xjwux8d9g1qgz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/css%E7%9B%92%E6%A8%A1%E5%9E%8B/" rel="tag">css盒模型</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-day21" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/02/day21/" class="article-date">
  <time datetime="2020-08-02T13:12:09.000Z" itemprop="datePublished">2020-08-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/02/day21/">day21</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="制作图云"><a href="#制作图云" class="headerlink" title="制作图云"></a>制作图云</h2><p><img src="https://style.youkeda.com/img/ham/course/j12/1-8.png" alt></p>
<p>类似这种由关键词组成的图云，就是<strong>词云</strong>。词云的呈现形式是图片，在视觉上突出了关键词，效果非常好。而关键词的来源，就是歌单中，每首歌的评论。那么具体怎么做呢?<br>1.对评论进行分词。例如:。老子要听一辈耔周杰伦分词结果: 老子/要/听/一辈子/周杰伦。半夜听着周董的老歌，看着大家的评论，满满的回忆分词结果:半夜/听着/周董/的/老歌/看着/大家/的/评论/满满的/回忆<br>2.把分词以后的关键词出现次数进行统计,排序<br>3.最后根据关键词的频率进行视觉显示上述都是理论思路，但每-步其实都是很难的，涉及到非常多复杂技术，比如:词性标注，自然语言分析,歧义词分析，图片绘制，图文智能排版等。</p>
<h2 id="Kumo"><a href="#Kumo" class="headerlink" title="Kumo"></a>Kumo</h2><p>在| Java中，最常用的词云库为| Kumo<br>github地址为:<a href="https://github.com/kennycason/kumo" target="_blank" rel="noopener">https://github.com/kennycason/kumo</a><br>使用方式也比较简单，首先我们需要在<strong>pom . xml</strong>文件中引<br>入相关的依赖。<br><dependency><br><groupId>com. kennycason&lt;/ groupId&gt;<br><artifactId>kumo- core</artifactId><br><version>1.17</version><br></groupId></dependency></p>
<!-- 下面tokenizers是为了中文分词引入-->
<dependency>
<groupId>com. kennycason</groupId>
<artifactId>kumo- tokenizers</artifactId>
<version>1.17</version>
</dependency>
每个语言的分词词性和分词算法是不同的，所以需要单独
引入中文分词: **kumo-tokenizers** 。

<h4 id="服务设计"><a href="#服务设计" class="headerlink" title="服务设计"></a>服务设计</h4><p><img src="https://style.youkeda.com/img/ham/course/j12/4-1-1.svg" alt></p>
<p>在「<strong>SongcrawlerServiceImpl</strong> 中增加一个方法<br><strong>private void generatewordCloud(String artistId)</strong><br>此方法被对外暴露的接口方法<strong>start()</strong> 在最后-一个步骤调用，爬取信息后接着制作词云。</p>
<h3 id="使用Kumo"><a href="#使用Kumo" class="headerlink" title="使用Kumo"></a>使用Kumo</h3><p>K umo的使用，学习起来也是要理解很多概念。我们已经为大家封装好了一个工具类:| <strong>Wordcloudutil</strong>。<br><strong>generateWordCloud()</strong>会调用到<strong>WordCloudutil</strong> 。</p>
<h2 id="任务"><a href="#任务" class="headerlink" title="任务"></a>任务</h2><p><img src="https://style.youkeda.com/img/ham/course/j12/4-1-2.svg" alt></p>
<p>完成:<br>在 <strong>SongCrawlerServiceImpl</strong>中增加一个方法<strong>private void generatewordCloud(String artistId)</strong>并且实现调用逻辑，完成词云制作。<br>●<br><strong>start()</strong>在最后一个步骤调用<strong>generateWordCloud()</strong><br>注意避免重复代码  执行完毕以后，在工程目录下找一找，有没有名称形<br>如”wordCloud-XXX.png”的图片文件。文件存在表示执行成<br>功，点击图片即阿查看效果哦。</p>
<h2 id="SongCrawlerServiceImpl-java"><a href="#SongCrawlerServiceImpl-java" class="headerlink" title="SongCrawlerServiceImpl.java"></a>SongCrawlerServiceImpl.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.music.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Album;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Artist;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Comment;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Song;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.User;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.service.SongCrawlerService;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.util.WordCloudUtil;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Call;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 音乐抓取服务的实现</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SongCrawlerServiceImpl</span> <span class="keyword">implements</span> <span class="title">SongCrawlerService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 歌单 API</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String ARTIEST_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/artists?id="</span>;</span><br><span class="line">  <span class="comment">// 歌曲详情 API</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String S_D_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/song/detail?ids="</span>;</span><br><span class="line">  <span class="comment">// 歌曲评论 API</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String S_C_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/comment/music?id="</span>;</span><br><span class="line">  <span class="comment">// 歌曲音乐文件 API</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String S_F_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/song/url?id="</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// okHttpClient 实例</span></span><br><span class="line">  <span class="keyword">private</span> OkHttpClient okHttpClient;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 歌单数据仓库</span></span><br><span class="line">  <span class="keyword">private</span> Map&lt;String, Artist&gt; artists;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1. 构建 okHttpClient 实例</span></span><br><span class="line">    okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">    artists = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 参数判断，未输入参数则直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (artistId == <span class="keyword">null</span> || artistId.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行初始化</span></span><br><span class="line">    init();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化歌曲及歌单</span></span><br><span class="line">    initArtistHotSongs(artistId);</span><br><span class="line">    assembleSongDetail(artistId);</span><br><span class="line">    assembleSongComment(artistId);</span><br><span class="line">    assembleSongUrl(artistId);</span><br><span class="line">    generateWordCloud(artistId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Artist <span class="title">getArtist</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> artists.get(artistId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Song <span class="title">getSong</span><span class="params">(String artistId, String songId)</span> </span>&#123;</span><br><span class="line">    Artist artist = artists.get(artistId);</span><br><span class="line">    List&lt;Song&gt; songs = artist.getSongList();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (songs == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      <span class="keyword">if</span> (song.getId().equals(songId)) &#123;</span><br><span class="line">        <span class="keyword">return</span> song;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Map <span class="title">getSourceDataObj</span><span class="params">(String prefix, String postfix)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 构建歌单url</span></span><br><span class="line">    String aUrl = prefix + postfix;</span><br><span class="line">    <span class="comment">// 调用 okhttp3 获取返回数据</span></span><br><span class="line">    String content = getPageContentSync(aUrl);</span><br><span class="line">    <span class="comment">// 反序列化成 Map 对象</span></span><br><span class="line">    Map returnData = JSON.parseObject(content, Map<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> returnData;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Artist <span class="title">buildArtist</span><span class="params">(Map returnData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 从 Map 对象中取得 歌单 数据。歌单也是一个子 Map 对象。</span></span><br><span class="line">    Map artistData = (Map) returnData.get(<span class="string">"artist"</span>);</span><br><span class="line">    Artist artist = <span class="keyword">new</span> Artist();</span><br><span class="line">    artist.setId(artistData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">    <span class="keyword">if</span> (artistData.get(<span class="string">"picUrl"</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">      artist.setPicUrl(artistData.get(<span class="string">"picUrl"</span>).toString());</span><br><span class="line">    &#125;</span><br><span class="line">    artist.setBriefDesc(artistData.get(<span class="string">"briefDesc"</span>).toString());</span><br><span class="line">    artist.setImg1v1Url(artistData.get(<span class="string">"img1v1Url"</span>).toString());</span><br><span class="line">    artist.setName(artistData.get(<span class="string">"name"</span>).toString());</span><br><span class="line">    artist.setAlias((List) artistData.get(<span class="string">"alias"</span>));</span><br><span class="line">    <span class="keyword">return</span> artist;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> List&lt;Song&gt; <span class="title">buildSongs</span><span class="params">(Map returnData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 从 Map 对象中取得一组 歌曲 数据</span></span><br><span class="line">    List songsData = (List) returnData.get(<span class="string">"hotSongs"</span>);</span><br><span class="line">    List&lt;Song&gt; songs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; songsData.size(); i++) &#123;</span><br><span class="line">      Map songData = (Map) songsData.get(i);</span><br><span class="line">      Song songObj = <span class="keyword">new</span> Song();</span><br><span class="line">      songObj.setId(songData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">      songObj.setName(songData.get(<span class="string">"name"</span>).toString());</span><br><span class="line"></span><br><span class="line">      songs.add(songObj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> songs;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">getPageContentSync</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//2.定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">    <span class="comment">//3.使用client去请求</span></span><br><span class="line">    Call call = okHttpClient.newCall(request);</span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//4.获得返回结果</span></span><br><span class="line">      result = call.execute().body().string();</span><br><span class="line">      System.out.println(<span class="string">"call "</span> + url + <span class="string">" , content's size="</span> + result.length());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initArtistHotSongs</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 取得整体数据对象。</span></span><br><span class="line">    Map returnData = getSourceDataObj(ARTIEST_API_PREFIX, artistId);</span><br><span class="line">    <span class="comment">// 构建填充了属性的 Artist 实例</span></span><br><span class="line">    Artist artist = buildArtist(returnData);</span><br><span class="line">    <span class="comment">// 构建一组填充了属性的 Song 实例</span></span><br><span class="line">    List&lt;Song&gt; songs = buildSongs(returnData);</span><br><span class="line">    <span class="comment">// 歌曲填入歌单</span></span><br><span class="line">    artist.setSongList(songs);</span><br><span class="line">    <span class="comment">// 存入本地</span></span><br><span class="line">    artists.put(artist.getId(), artist);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">assembleSongDetail</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    Artist artist = getArtist(artistId);</span><br><span class="line">    <span class="comment">// 取不到歌单说明参数输入错误</span></span><br><span class="line">    <span class="keyword">if</span> (artist == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除其它语句，保留必要的语句</span></span><br><span class="line">    List&lt;Song&gt; songs = artist.getSongList();</span><br><span class="line">    String sIdsParam = buildManyIdParam(songs);</span><br><span class="line">    <span class="comment">// 抓取结果</span></span><br><span class="line">    Map songsDetailObj = getSourceDataObj(S_D_API_PREFIX, sIdsParam);</span><br><span class="line">    <span class="comment">// 原始数据中的 songs 是歌曲列表</span></span><br><span class="line">    List&lt;Map&gt; sourceSongs = (List&lt;Map&gt;) songsDetailObj.get(<span class="string">"songs"</span>);</span><br><span class="line">    <span class="comment">// 临时的 Map</span></span><br><span class="line">    Map&lt;String, Map&gt; sourceSongsMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">// 遍历歌曲列表</span></span><br><span class="line">    <span class="keyword">for</span> (Map songSourceData : sourceSongs) &#123;</span><br><span class="line">      String sId = songSourceData.get(<span class="string">"id"</span>).toString();</span><br><span class="line">      <span class="comment">// 原始歌曲数据对象放入一个临时的 Map 中</span></span><br><span class="line">      sourceSongsMap.put(sId, songSourceData);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 再次遍历歌单中的歌曲，填入详情数据</span></span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      String sId = song.getId();</span><br><span class="line">      <span class="comment">// 从临时的Map中取得对应的歌曲源数据，使用id直接获取，比较方便</span></span><br><span class="line">      Map songSourceData = sourceSongsMap.get(sId);</span><br><span class="line">      <span class="comment">// 源歌曲数据中，ar 字段是歌手列表</span></span><br><span class="line">      List&lt;Map&gt; singersData = (List&lt;Map&gt;) songSourceData.get(<span class="string">"ar"</span>);</span><br><span class="line">      <span class="comment">// 歌手集合</span></span><br><span class="line">      List&lt;User&gt; singers = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">      <span class="keyword">for</span> (Map singerData : singersData) &#123;</span><br><span class="line">        <span class="comment">// 歌手对象</span></span><br><span class="line">        User singer = <span class="keyword">new</span> User();</span><br><span class="line">        singer.setId(singerData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">        singer.setNickName(singerData.get(<span class="string">"name"</span>).toString());</span><br><span class="line">        <span class="comment">// 歌手集合放入歌手对象</span></span><br><span class="line">        singers.add(singer);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 歌手集合放入歌曲</span></span><br><span class="line">      song.setSingers(singers);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 专辑</span></span><br><span class="line">      Map albumData = (Map) songSourceData.get(<span class="string">"al"</span>);</span><br><span class="line">      Album album = <span class="keyword">new</span> Album();</span><br><span class="line">      album.setId(albumData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">      album.setName(albumData.get(<span class="string">"name"</span>).toString());</span><br><span class="line">      <span class="keyword">if</span> (albumData.get(<span class="string">"picUrl"</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        album.setPicUrl(albumData.get(<span class="string">"picUrl"</span>).toString());</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 专辑对象放入歌曲</span></span><br><span class="line">      song.setAlbum(album);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">assembleSongComment</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    Artist artist = getArtist(artistId);</span><br><span class="line">    <span class="comment">// 取不到歌单说明参数输入错误</span></span><br><span class="line">    <span class="keyword">if</span> (artist == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    List&lt;Song&gt; songs = artist.getSongList();</span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      String sIdsParam = song.getId() + <span class="string">"&amp;limit=5"</span>;</span><br><span class="line">      <span class="comment">// 抓取结果</span></span><br><span class="line">      Map songsCommentObj = getSourceDataObj(S_C_API_PREFIX, sIdsParam);</span><br><span class="line">      <span class="comment">// 热门评论列表</span></span><br><span class="line">      List&lt;Map&gt; hotCommentsObj = (List&lt;Map&gt;) songsCommentObj.get(<span class="string">"hotComments"</span>);</span><br><span class="line">      <span class="comment">// 热门评论列表</span></span><br><span class="line">      List&lt;Map&gt; commontsObj = (List&lt;Map&gt;) songsCommentObj.get(<span class="string">"comments"</span>);</span><br><span class="line"></span><br><span class="line">      song.setHotComments(buildComments(hotCommentsObj));</span><br><span class="line">      song.setComments(buildComments(commontsObj));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">assembleSongUrl</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    Artist artist = getArtist(artistId);</span><br><span class="line">    <span class="comment">// 取不到歌单说明参数输入错误</span></span><br><span class="line">    <span class="keyword">if</span> (artist == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除其它语句，保留必要的语句</span></span><br><span class="line">    List&lt;Song&gt; songs = artist.getSongList();</span><br><span class="line">    String sIdsParam = buildManyIdParam(songs);</span><br><span class="line">    <span class="comment">// 抓取结果</span></span><br><span class="line">    Map songsFileObj = getSourceDataObj(S_F_API_PREFIX, sIdsParam);</span><br><span class="line">    <span class="comment">// 原始数据中的 data 是音乐文件列表</span></span><br><span class="line">    List&lt;Map&gt; datas = (List&lt;Map&gt;) songsFileObj.get(<span class="string">"data"</span>);</span><br><span class="line">    <span class="comment">// 临时的 Map</span></span><br><span class="line">    Map&lt;String, Map&gt; sourceSongsMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">// 遍历音乐文件列表</span></span><br><span class="line">    <span class="keyword">for</span> (Map songFileData : datas) &#123;</span><br><span class="line">      String sId = songFileData.get(<span class="string">"id"</span>).toString();</span><br><span class="line">      <span class="comment">// 原始音乐文件数据对象放入一个临时的 Map 中</span></span><br><span class="line">      sourceSongsMap.put(sId, songFileData);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 再次遍历歌单中的歌曲，填入音乐文件URL</span></span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      String sId = song.getId();</span><br><span class="line">      <span class="comment">// 从临时的Map中取得对应的音乐文件源数据，使用id直接获取，比较方便</span></span><br><span class="line">      Map songFileData = sourceSongsMap.get(sId);</span><br><span class="line">      <span class="comment">// 源音乐文件数据中，url 字段就是文件地址</span></span><br><span class="line">      <span class="keyword">if</span> (songFileData != <span class="keyword">null</span> &amp;&amp; songFileData.get(<span class="string">"url"</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        String songFileUrl = songFileData.get(<span class="string">"url"</span>).toString();</span><br><span class="line">        song.setSourceUrl(songFileUrl);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generateWordCloud</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    Artist artist = getArtist(artistId);</span><br><span class="line">    <span class="comment">// 取不到歌单说明参数输入错误</span></span><br><span class="line">    <span class="keyword">if</span> (artist == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    List&lt;Song&gt; songs = artist.getSongList();</span><br><span class="line">    List&lt;String&gt; contents = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      <span class="comment">// 遍历歌曲所有的评论，包括普通评论和热门评论，把评论内容字符串存入集合</span></span><br><span class="line">      collectContent(song.getComments(), contents);</span><br><span class="line">      collectContent(song.getHotComments(), contents);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 制作词云</span></span><br><span class="line">    WordCloudUtil.generate(artistId, contents);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">collectContent</span><span class="params">(List&lt;Comment&gt; comments, List&lt;String&gt; contents)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (Comment comment : comments) &#123;</span><br><span class="line">      contents.add(comment.getContent());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> List&lt;Comment&gt; <span class="title">buildComments</span><span class="params">(List&lt;Map&gt; commontsObj)</span> </span>&#123;</span><br><span class="line">    List&lt;Comment&gt; comments = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Map sourceComment : commontsObj) &#123;</span><br><span class="line">      Comment commont = <span class="keyword">new</span> Comment();</span><br><span class="line">      commont.setContent(sourceComment.get(<span class="string">"content"</span>).toString());</span><br><span class="line">      commont.setId(sourceComment.get(<span class="string">"commentId"</span>).toString());</span><br><span class="line">      commont.setLikedCount(sourceComment.get(<span class="string">"likedCount"</span>).toString());</span><br><span class="line">      commont.setTime(sourceComment.get(<span class="string">"time"</span>).toString());</span><br><span class="line"></span><br><span class="line">      User user = <span class="keyword">new</span> User();</span><br><span class="line">      Map sourceUserData = (Map) sourceComment.get(<span class="string">"user"</span>);</span><br><span class="line">      user.setId(sourceUserData.get(<span class="string">"userId"</span>).toString());</span><br><span class="line">      user.setNickName(sourceUserData.get(<span class="string">"nickname"</span>).toString());</span><br><span class="line">      user.setAvatar(sourceUserData.get(<span class="string">"avatarUrl"</span>).toString());</span><br><span class="line">      commont.setCommentUser(user);</span><br><span class="line"></span><br><span class="line">      comments.add(commont);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> comments;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">buildManyIdParam</span><span class="params">(List&lt;Song&gt; songs)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 收集一个歌单中所有歌曲的id，放入一个list</span></span><br><span class="line">    List&lt;String&gt; songIds = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      songIds.add(song.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 一个歌单中所有歌曲的id，组装成用逗号分割的字符串，形如：347230,347231。记住这个用法，很方便</span></span><br><span class="line">    String sIdsParam = String.join(<span class="string">","</span>, songIds);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> sIdsParam;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="WordCloudUtil-java"><a href="#WordCloudUtil-java" class="headerlink" title="WordCloudUtil.java"></a>WordCloudUtil.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.music.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.kennycason.kumo.CollisionMode;</span><br><span class="line"><span class="keyword">import</span> com.kennycason.kumo.WordCloud;</span><br><span class="line"><span class="keyword">import</span> com.kennycason.kumo.WordFrequency;</span><br><span class="line"><span class="keyword">import</span> com.kennycason.kumo.bg.CircleBackground;</span><br><span class="line"><span class="keyword">import</span> com.kennycason.kumo.font.FontWeight;</span><br><span class="line"><span class="keyword">import</span> com.kennycason.kumo.font.KumoFont;</span><br><span class="line"><span class="keyword">import</span> com.kennycason.kumo.font.scale.SqrtFontScalar;</span><br><span class="line"><span class="keyword">import</span> com.kennycason.kumo.nlp.FrequencyAnalyzer;</span><br><span class="line"><span class="keyword">import</span> com.kennycason.kumo.nlp.tokenizers.ChineseWordTokenizer;</span><br><span class="line"><span class="keyword">import</span> com.kennycason.kumo.palette.ColorPalette;</span><br><span class="line"><span class="keyword">import</span> java.awt.Color;</span><br><span class="line"><span class="keyword">import</span> java.awt.Dimension;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.time.ZoneOffset;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 生成图云的工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WordCloudUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 生成词云</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> artistId 歌单id</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> texts 文本</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">generate</span><span class="params">(String artistId, List&lt;String&gt; texts)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    FrequencyAnalyzer frequencyAnalyzer = <span class="keyword">new</span> FrequencyAnalyzer();</span><br><span class="line">    <span class="comment">//设置返回的词数</span></span><br><span class="line">    frequencyAnalyzer.setWordFrequenciesToReturn(<span class="number">500</span>);</span><br><span class="line">    <span class="comment">//设置返回的词语最小出现频次</span></span><br><span class="line">    frequencyAnalyzer.setMinWordLength(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//引入中文解析器</span></span><br><span class="line">    frequencyAnalyzer.setWordTokenizer(<span class="keyword">new</span> ChineseWordTokenizer());</span><br><span class="line">    <span class="comment">//输入文章数据，进行分词</span></span><br><span class="line">    <span class="keyword">final</span> List&lt;WordFrequency&gt; wordFrequencyList = frequencyAnalyzer.load(texts);</span><br><span class="line">    <span class="comment">//设置图片分辨率大小</span></span><br><span class="line">    Dimension dimension = <span class="keyword">new</span> Dimension(<span class="number">600</span>, <span class="number">600</span>);</span><br><span class="line">    <span class="comment">//此处的设置采用内置常量即可，生成词云对象</span></span><br><span class="line">    WordCloud wordCloud = <span class="keyword">new</span> WordCloud(dimension, CollisionMode.PIXEL_PERFECT);</span><br><span class="line">    <span class="comment">//设置边界及字体</span></span><br><span class="line">    wordCloud.setPadding(<span class="number">2</span>);</span><br><span class="line">    <span class="comment">// 设置字体，字体必须支持中文，不能随便改</span></span><br><span class="line">    wordCloud.setKumoFont(<span class="keyword">new</span> KumoFont(<span class="string">"阿里巴巴普惠体 Light"</span>, FontWeight.PLAIN));</span><br><span class="line">    <span class="comment">//设置词云显示的三种颜色，越靠前设置表示词频越高的词语的颜色</span></span><br><span class="line">    wordCloud.setColorPalette(</span><br><span class="line">        <span class="keyword">new</span> ColorPalette(<span class="keyword">new</span> Color(<span class="number">0x4055F1</span>), <span class="keyword">new</span> Color(<span class="number">0x408DF1</span>), <span class="keyword">new</span> Color(<span class="number">0x40AAF1</span>),</span><br><span class="line">            <span class="keyword">new</span> Color(<span class="number">0x40C5F1</span>), <span class="keyword">new</span> Color(<span class="number">0x40D3F1</span>), <span class="keyword">new</span> Color(<span class="number">0xFFFFFF</span>)));</span><br><span class="line">    wordCloud.setFontScalar(<span class="keyword">new</span> SqrtFontScalar(<span class="number">10</span>, <span class="number">70</span>));</span><br><span class="line">    <span class="comment">//设置背景图层为圆形</span></span><br><span class="line">    wordCloud.setBackground(<span class="keyword">new</span> CircleBackground(<span class="number">300</span>));</span><br><span class="line">    <span class="comment">//生成词云</span></span><br><span class="line">    wordCloud.build(wordFrequencyList);</span><br><span class="line">    <span class="comment">//输出到图片文件，用当前的毫秒数作为文件名</span></span><br><span class="line">    Long milliSecond = LocalDateTime.now().toInstant(ZoneOffset.of(<span class="string">"+8"</span>)).toEpochMilli();</span><br><span class="line">    <span class="comment">//输出到图片文件</span></span><br><span class="line">    wordCloud.writeToFile(<span class="string">"wordCloud-"</span> + artistId + <span class="string">".png"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/02/day21/" data-id="ckdn9i6nl000sjwuxh9xvdvte" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%9B%BE%E4%BA%91/" rel="tag">图云</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-day20" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/02/day20/" class="article-date">
  <time datetime="2020-08-02T02:28:05.000Z" itemprop="datePublished">2020-08-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/08/02/day20/">day20</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="获取热门歌单"><a href="#获取热门歌单" class="headerlink" title="获取热门歌单"></a>获取热门歌单</h2><h4 id="1-、需求分析"><a href="#1-、需求分析" class="headerlink" title="1 、需求分析"></a>1 、需求分析</h4><h4 id="2、概要设计"><a href="#2、概要设计" class="headerlink" title="2、概要设计"></a>2、概要设计</h4><p>概要设计阶段是完成模型+服务的整体结构。<br>这是一个比较经典的结构。以后大家在遇到复杂的场景时，区别只是需要设计更多的模型和更多的服务而已。</p>
<p><img src="https://style.youkeda.com/img/ham/course/j12/2-2-1.svg" alt></p>
<p><strong>service</strong>  包存放服务接口，子包<strong>impl</strong> 存放服务实现类。<br><strong>mode l</strong>   包存放模型。</p>
<h4 id="3、模型设计"><a href="#3、模型设计" class="headerlink" title="3、模型设计"></a>3、模型设计</h4><p>模型图：</p>
<p><img src="https://style.youkeda.com/img/ham/course/j12/2-2-2.svg" alt></p>
<p>Java来定义模型的类,叫<strong>POJO</strong>(Plain Ordinary Java Object)类。在《Java面向对象》课程第一章( Java面向对象)第四节(封装)已经讲过对象封装的规范(不熟悉的同学可以复习一下)。在此基础上，<strong>没有业务逻辑、即不允许有增、删、改、查等操作数据的方法的类</strong>，叫作<strong>P0J0</strong>类。➊</p>
<h4 id="4、服务设计"><a href="#4、服务设计" class="headerlink" title="4、服务设计"></a>4、服务设计</h4><p><strong>抓取</strong><br>项目目标是提供抓取歌单的服务，给其它类调用，是一个通用能力，让具体的业务根据需要抓取歌单。那么就需要抓取歌单数据的方法。<br>●<strong>既然是给其它类调用，那么应该定义成public</strong><br>●这个方法不需要返回值，只是提供抓取功能，所以方法返回值定义为<strong>void</strong><br>●方法的作用是开始执行抓取任务，可以命名为<strong>start</strong>。注意方法名一定要代表功能含义，让别人阅读时能理解是做什么的<br>●方法的参数当然是<strong>字符串类型的歌单ID</strong>。本章第一节讲了，歌单其实是属于某位歌手的,所以这里命名为<strong>artistId</strong>。两个单词，第二个单词首字母大写。 Id 是唯一的编号。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(String artistId)</span></span>;</span><br></pre></td></tr></table></figure>

<p><strong>二、歌单</strong><br>抓取歌单的目的，是使用歌单。所以还需要提供查询方法查询歌单。方法的参数也是歌单ID。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Artist <span class="title">getArtist</span><span class="params">(String artistId)</span></span>;</span><br></pre></td></tr></table></figure>

<p><strong>三、歌曲</strong><br>歌单中有很多歌曲，还可以提供一个查询歌曲的方法。虽然歌单模型中已经包含歌曲了，但是提供一个通用简单、| 易用的方法也是有意义的。方法参数是歌单ID和歌曲ID。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Song <span class="title">getSong</span><span class="params">(String artistId, String songId)</span></span>;</span><br></pre></td></tr></table></figure>

<p>模型图：</p>
<p><img src="https://style.youkeda.com/img/ham/course/j12/2-2-3.svg" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SongCrawlerServiceImpl</span> <span class="keyword">implements</span> <span class="title">SongCrawlerService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> Map&lt;String, Artist&gt; artists;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="comment">//初始化方法</span></span><br><span class="line">    artists = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">      <span class="comment">//实例化Map</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1、服务实现"><a href="#1、服务实现" class="headerlink" title="1、服务实现"></a>1、服务实现</h2><p><img src="https://style.youkeda.com/img/ham/course/j12/2-2-3.svg" alt></p>
<p><strong>start()方法实现的整体思路</strong></p>
<p><strong>SongcrawlerserviceImpl</strong>类的<strong>start()</strong> 方法的作用是执行歌单的抓取。</p>
<p><img src="https://style.youkeda.com/img/ham/course/j12/2-2-4-1.svg" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.music.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Artist;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Song;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.service.SongCrawlerService;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Call;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 音乐抓取服务的实现</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SongCrawlerServiceImpl</span> <span class="keyword">implements</span> <span class="title">SongCrawlerService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 歌单数据仓库</span></span><br><span class="line">  <span class="keyword">private</span> Map&lt;String, Artist&gt; artists;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    artists = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (artistId == <span class="keyword">null</span> || artistId.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span>;  </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 执行初始化</span></span><br><span class="line">    init();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 取得整体数据对象</span></span><br><span class="line">    Map returnData = getArtistObj(artistId);</span><br><span class="line">    <span class="comment">// 构建填充了属性的 Artist 实例</span></span><br><span class="line">    Artist artist = buildArtist(returnData);</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Artist <span class="title">getArtist</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Song <span class="title">getSong</span><span class="params">(String artistId, String songId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="function"><span class="keyword">private</span> Artist <span class="title">buildArtist</span><span class="params">(Map returnData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 从 Map 对象中取得 歌单 数据。歌单也是一个子 Map 对象。</span></span><br><span class="line">    Artist artist = <span class="keyword">new</span> Artist();</span><br><span class="line">      Map artistData = (Map) returnData.get(<span class="string">"artist"</span>);</span><br><span class="line">    artist.setId(artistData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> artist;</span><br><span class="line">  </span><br><span class="line">  &#125;</span><br><span class="line">   <span class="function"><span class="keyword">private</span> Map <span class="title">getArtistObj</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 构建歌单url</span></span><br><span class="line">    String aUrl = <span class="string">"http://neteaseapi.youkeda.com:3000/artists?id="</span> + artistId;</span><br><span class="line">    <span class="comment">// 调用 okhttp3 获取返回数据</span></span><br><span class="line">    String content = getPageContentSync(aUrl);</span><br><span class="line">    <span class="comment">// 反序列化成 Map 对象</span></span><br><span class="line">    Map returnData = JSON.parseObject(content, Map<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> returnData;</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="function"><span class="keyword">private</span> String <span class="title">getPageContentSync</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">     OkHttpClient okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">    <span class="comment">// 定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">    <span class="comment">// 使用client去请求</span></span><br><span class="line">    Call call = okHttpClient.newCall(request);</span><br><span class="line">    <span class="comment">// 返回结果字符串</span></span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 获得返回结果</span></span><br><span class="line">      result = call.execute().body().string();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      <span class="comment">// 抓取异常</span></span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2、构建填充了属性的Artist实例"><a href="#2、构建填充了属性的Artist实例" class="headerlink" title="2、构建填充了属性的Artist实例"></a>2、构建填充了属性的Artist实例</h3><p><img src="https://style.youkeda.com/img/ham/course/j12/2-2-4-2.svg" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.music.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Artist;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Song;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.service.SongCrawlerService;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Call;</span><br><span class="line"><span class="keyword">import</span> okhttp3.MediaType;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"><span class="keyword">import</span> okhttp3.RequestBody;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 音乐抓取服务的实现</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SongCrawlerServiceImpl</span> <span class="keyword">implements</span> <span class="title">SongCrawlerService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String ARTIEST_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/artists?id="</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// okHttpClient 实例</span></span><br><span class="line">  <span class="keyword">private</span> OkHttpClient okHttpClient;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 歌单数据仓库</span></span><br><span class="line">  <span class="keyword">private</span> Map&lt;String, Artist&gt; artists;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1. 构建 okHttpClient 实例</span></span><br><span class="line">    okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">    artists = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 参数判断，未输入参数则直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (artistId == <span class="keyword">null</span> || artistId.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行初始化</span></span><br><span class="line">    init();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 取得整体数据对象。</span></span><br><span class="line">    Map returnData = getArtistObj(artistId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Artist <span class="title">getArtist</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Song <span class="title">getSong</span><span class="params">(String artistId, String songId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Map <span class="title">getArtistObj</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 构建歌单url</span></span><br><span class="line">    String aUrl = ARTIEST_API_PREFIX + artistId;</span><br><span class="line">    <span class="comment">// 调用 okhttp3 获取返回数据</span></span><br><span class="line">    String content = getPageContentSync(aUrl);</span><br><span class="line">    <span class="comment">// 反序列化成 Map 对象</span></span><br><span class="line">    Map returnData = JSON.parseObject(content, Map<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> returnData;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">getPageContentSync</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//2.定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">    <span class="comment">//3.使用client去请求</span></span><br><span class="line">    Call call = okHttpClient.newCall(request);</span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//4.获得返回结果</span></span><br><span class="line">      result = call.execute().body().string();</span><br><span class="line">      System.out.println(<span class="string">"call "</span> + url + <span class="string">" , content's size="</span> + result.length());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MediaType JSON_TYPE = MediaType.parse(<span class="string">"application/json; charset=utf-8"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 向指定的 url 提交数据，以 json 的方式</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">postContent</span><span class="params">(String url, Map&lt;String, String&gt; datas)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// okHttpClient 实例</span></span><br><span class="line">    OkHttpClient okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 数据对象转换成 json 格式字符串</span></span><br><span class="line">    String param = JSON.toJSONString(datas);</span><br><span class="line">    <span class="comment">//post方式提交的数据</span></span><br><span class="line">    RequestBody requestBody = RequestBody.create(JSON_TYPE, param);</span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).post(requestBody).build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用client去请求</span></span><br><span class="line">    Call call = okHttpClient.newCall(request);</span><br><span class="line">    <span class="comment">// 返回结果字符串</span></span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 获得返回结果</span></span><br><span class="line">      result = call.execute().body().string();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      <span class="comment">// 抓取异常</span></span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3、构建一组填充了属性的Song实例"><a href="#3、构建一组填充了属性的Song实例" class="headerlink" title="3、构建一组填充了属性的Song实例"></a>3、构建一组填充了属性的Song实例</h4><p><img src="https://style.youkeda.com/img/ham/course/j12/2-2-4-3.svg" alt></p>
<p>要求<br>●参考流程图，在| SongCrawlerServiceImpl类的start()方法中添加第一个私有方法。<br>在这个私有方法中，从第一步抓取的源数据对象中，解析hotsongs数据字段,创建歌曲集合，并朱每个歌曲对象填充属性。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.music.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Artist;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Song;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.service.SongCrawlerService;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Call;</span><br><span class="line"><span class="keyword">import</span> okhttp3.MediaType;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"><span class="keyword">import</span> okhttp3.RequestBody;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 音乐抓取服务的实现</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SongCrawlerServiceImpl</span> <span class="keyword">implements</span> <span class="title">SongCrawlerService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String ARTIEST_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/artists?id="</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// okHttpClient 实例</span></span><br><span class="line">  <span class="keyword">private</span> OkHttpClient okHttpClient;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 歌单数据仓库</span></span><br><span class="line">  <span class="keyword">private</span> Map&lt;String, Artist&gt; artists;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1. 构建 okHttpClient 实例</span></span><br><span class="line">    okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">    artists = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 参数判断，未输入参数则直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (artistId == <span class="keyword">null</span> || artistId.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行初始化</span></span><br><span class="line">    init();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 取得整体数据对象。</span></span><br><span class="line">    Map returnData = getArtistObj(artistId);</span><br><span class="line">    <span class="comment">// 构建填充了属性的 Artist 实例</span></span><br><span class="line">    Artist artist = buildArtist(returnData);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Artist <span class="title">getArtist</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> artists.get(artistId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Song <span class="title">getSong</span><span class="params">(String artistId, String songId)</span> </span>&#123;</span><br><span class="line">    Artist artist = artists.get(artistId);</span><br><span class="line">    List&lt;Song&gt; songs = artist.getSongList();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (songs == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      <span class="keyword">if</span> (song.getId().equals(songId)) &#123;</span><br><span class="line">        <span class="keyword">return</span> song;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Map <span class="title">getArtistObj</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 构建歌单url</span></span><br><span class="line">    String aUrl = ARTIEST_API_PREFIX + artistId;</span><br><span class="line">    <span class="comment">// 调用 okhttp3 获取返回数据</span></span><br><span class="line">    String content = getPageContentSync(aUrl);</span><br><span class="line">    <span class="comment">// 反序列化成 Map 对象</span></span><br><span class="line">    Map returnData = JSON.parseObject(content, Map<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> returnData;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Artist <span class="title">buildArtist</span><span class="params">(Map returnData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 从 Map 对象中取得 歌单 数据。歌单也是一个子 Map 对象。</span></span><br><span class="line">    Map artistData = (Map) returnData.get(<span class="string">"artist"</span>);</span><br><span class="line">    Artist artist = <span class="keyword">new</span> Artist();</span><br><span class="line">    artist.setId(artistData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">    <span class="keyword">if</span> (artistData.get(<span class="string">"picUrl"</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">      artist.setPicUrl(artistData.get(<span class="string">"picUrl"</span>).toString());</span><br><span class="line">    &#125;</span><br><span class="line">    artist.setBriefDesc(artistData.get(<span class="string">"briefDesc"</span>).toString());</span><br><span class="line">    artist.setImg1v1Url(artistData.get(<span class="string">"img1v1Url"</span>).toString());</span><br><span class="line">    artist.setName(artistData.get(<span class="string">"name"</span>).toString());</span><br><span class="line">    artist.setAlias((List) artistData.get(<span class="string">"alias"</span>));</span><br><span class="line">    <span class="keyword">return</span> artist;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">getPageContentSync</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//2.定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">    <span class="comment">//3.使用client去请求</span></span><br><span class="line">    Call call = okHttpClient.newCall(request);</span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//4.获得返回结果</span></span><br><span class="line">      result = call.execute().body().string();</span><br><span class="line">      System.out.println(<span class="string">"call "</span> + url + <span class="string">" , content's size="</span> + result.length());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MediaType JSON_TYPE = MediaType.parse(<span class="string">"application/json; charset=utf-8"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 向指定的 url 提交数据，以 json 的方式</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">postContent</span><span class="params">(String url, Map&lt;String, String&gt; datas)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// okHttpClient 实例</span></span><br><span class="line">    OkHttpClient okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 数据对象转换成 json 格式字符串</span></span><br><span class="line">    String param = JSON.toJSONString(datas);</span><br><span class="line">    <span class="comment">//post方式提交的数据</span></span><br><span class="line">    RequestBody requestBody = RequestBody.create(JSON_TYPE, param);</span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).post(requestBody).build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用client去请求</span></span><br><span class="line">    Call call = okHttpClient.newCall(request);</span><br><span class="line">    <span class="comment">// 返回结果字符串</span></span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 获得返回结果</span></span><br><span class="line">      result = call.execute().body().string();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      <span class="comment">// 抓取异常</span></span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4、回顾流程"><a href="#4、回顾流程" class="headerlink" title="4、回顾流程"></a>4、回顾流程</h3><p><img src="https://style.youkeda.com/img/ham/course/j12/2-2-4.svg" alt></p>
<p><strong>要求</strong></p>
<p>完成最后两个小步骤。<strong>歌曲对象存入本地的数据仓库(Map类型的实例变量artists</strong> )</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.music.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Artist;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Song;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.service.SongCrawlerService;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Call;</span><br><span class="line"><span class="keyword">import</span> okhttp3.MediaType;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"><span class="keyword">import</span> okhttp3.RequestBody;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 音乐抓取服务的实现</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SongCrawlerServiceImpl</span> <span class="keyword">implements</span> <span class="title">SongCrawlerService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String ARTIEST_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/artists?id="</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// okHttpClient 实例</span></span><br><span class="line">  <span class="keyword">private</span> OkHttpClient okHttpClient;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 歌单数据仓库</span></span><br><span class="line">  <span class="keyword">private</span> Map&lt;String, Artist&gt; artists;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1. 构建 okHttpClient 实例</span></span><br><span class="line">    okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">    artists = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 参数判断，未输入参数则直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (artistId == <span class="keyword">null</span> || artistId.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行初始化</span></span><br><span class="line">    init();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 取得整体数据对象。</span></span><br><span class="line">    Map returnData = getArtistObj(artistId);</span><br><span class="line">    <span class="comment">// 构建填充了属性的 Artist 实例</span></span><br><span class="line">    Artist artist = buildArtist(returnData);</span><br><span class="line">    <span class="comment">// 构建一组填充了属性的 Song 实例</span></span><br><span class="line">    List&lt;Song&gt; songs = buildSongs(returnData);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Artist <span class="title">getArtist</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Song <span class="title">getSong</span><span class="params">(String artistId, String songId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Map <span class="title">getArtistObj</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 构建歌单url</span></span><br><span class="line">    String aUrl = ARTIEST_API_PREFIX + artistId;</span><br><span class="line">    <span class="comment">// 调用 okhttp3 获取返回数据</span></span><br><span class="line">    String content = getPageContentSync(aUrl);</span><br><span class="line">    <span class="comment">// 反序列化成 Map 对象</span></span><br><span class="line">    Map returnData = JSON.parseObject(content, Map<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> returnData;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Artist <span class="title">buildArtist</span><span class="params">(Map returnData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 从 Map 对象中取得 歌单 数据。歌单也是一个子 Map 对象。</span></span><br><span class="line">    Map artistData = (Map) returnData.get(<span class="string">"artist"</span>);</span><br><span class="line">    Artist artist = <span class="keyword">new</span> Artist();</span><br><span class="line">    artist.setId(artistData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">    <span class="keyword">if</span> (artistData.get(<span class="string">"picUrl"</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">      artist.setPicUrl(artistData.get(<span class="string">"picUrl"</span>).toString());</span><br><span class="line">    &#125;</span><br><span class="line">    artist.setBriefDesc(artistData.get(<span class="string">"briefDesc"</span>).toString());</span><br><span class="line">    artist.setImg1v1Url(artistData.get(<span class="string">"img1v1Url"</span>).toString());</span><br><span class="line">    artist.setName(artistData.get(<span class="string">"name"</span>).toString());</span><br><span class="line">    artist.setAlias((List) artistData.get(<span class="string">"alias"</span>));</span><br><span class="line">    <span class="keyword">return</span> artist;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> List&lt;Song&gt; <span class="title">buildSongs</span><span class="params">(Map returnData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 从 Map 对象中取得一组 歌曲 数据</span></span><br><span class="line">    List songsData = (List) returnData.get(<span class="string">"hotSongs"</span>);</span><br><span class="line">    List&lt;Song&gt; songs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; songsData.size(); i++) &#123;</span><br><span class="line">      Map songData = (Map) songsData.get(i);</span><br><span class="line">      Song songObj = <span class="keyword">new</span> Song();</span><br><span class="line">      songObj.setId(songData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">      songObj.setName(songData.get(<span class="string">"name"</span>).toString());</span><br><span class="line"></span><br><span class="line">      songs.add(songObj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> songs;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">getPageContentSync</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//2.定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">    <span class="comment">//3.使用client去请求</span></span><br><span class="line">    Call call = okHttpClient.newCall(request);</span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//4.获得返回结果</span></span><br><span class="line">      result = call.execute().body().string();</span><br><span class="line">      System.out.println(<span class="string">"call "</span> + url + <span class="string">" , content's size="</span> + result.length());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MediaType JSON_TYPE = MediaType.parse(<span class="string">"application/json; charset=utf-8"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 向指定的 url 提交数据，以 json 的方式</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">postContent</span><span class="params">(String url, Map&lt;String, String&gt; datas)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// okHttpClient 实例</span></span><br><span class="line">    OkHttpClient okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 数据对象转换成 json 格式字符串</span></span><br><span class="line">    String param = JSON.toJSONString(datas);</span><br><span class="line">    <span class="comment">//post方式提交的数据</span></span><br><span class="line">    RequestBody requestBody = RequestBody.create(JSON_TYPE, param);</span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).post(requestBody).build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用client去请求</span></span><br><span class="line">    Call call = okHttpClient.newCall(request);</span><br><span class="line">    <span class="comment">// 返回结果字符串</span></span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 获得返回结果</span></span><br><span class="line">      result = call.execute().body().string();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      <span class="comment">// 抓取异常</span></span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="歌曲详细信息"><a href="#歌曲详细信息" class="headerlink" title="歌曲详细信息"></a>歌曲详细信息</h1><h4 id="模型设计"><a href="#模型设计" class="headerlink" title="模型设计"></a>模型设计</h4><p><img src="https://style.youkeda.com/img/ham/course/j12/3-1-1-1.svg" alt></p>
<h4 id="2、服务设计"><a href="#2、服务设计" class="headerlink" title="2、服务设计"></a>2、服务设计</h4><p><img src="https://style.youkeda.com/img/ham/course/j12/3-1-2.svg" alt></p>
<p>●<br>把原来<strong>start()</strong> 方法里完成的抓取步骤,挪到<strong>initArtistHotSongs()</strong>中,作为歌曲和歌单初始化的<br>方法。<br>●增加三个装配方法:</p>
<p><strong>assemblesongDetail()</strong>组装歌曲的详细信息</p>
<p><strong>ass embleSongComment()</strong> 组装歌曲的评论。</p>
<p><strong>assemblesongurl()</strong>组装歌曲的音乐文件地址<br>●<strong>start()</strong>方法的作为装配工，按顺序调用各个步骤: .</p>
<p><img src="https://style.youkeda.com/img/ham/course/j12/3-2-2.svg" alt></p>
<p>●<strong>start()</strong> 方法变化较大，相当于做了一次<strong>重构</strong>。</p>
<p>这样做的目的，是基于把相对独立操作进行封装的思想，实现歌单抓取的过程中把步骤封装成私有方法也是基础这个思想。这么做的优点让代码条理更清晰、更容易理解、 更易于维护。</p>
<p>1.什么是重构?<br><strong>在不改变代码接口的情况下</strong>，对代码作出修改,以改进<br>程序的<strong>内部结构</strong>。本质上说，重构就是在代码写好之后<br>改进它的设计</p>
<p>2.重构的目的?<br>。提高代码质量(性能、可读性、可重用性)<br>。修改Bug<br>。增加新功能<br>本次start()方法的重构，为了增加新的功能。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.music.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Artist;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Song;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.service.SongCrawlerService;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Call;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 音乐抓取服务的实现</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SongCrawlerServiceImpl</span> <span class="keyword">implements</span> <span class="title">SongCrawlerService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String ARTIEST_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/artists?id="</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// okHttpClient 实例</span></span><br><span class="line">  <span class="keyword">private</span> OkHttpClient okHttpClient;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 歌单数据仓库</span></span><br><span class="line">  <span class="keyword">private</span> Map&lt;String, Artist&gt; artists;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1. 构建 okHttpClient 实例</span></span><br><span class="line">    okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">    artists = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 参数判断，未输入参数则直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (artistId == <span class="keyword">null</span> || artistId.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行初始化</span></span><br><span class="line">    init();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化歌曲及歌单</span></span><br><span class="line">    initArtistHotSongs(artistId);</span><br><span class="line">    assembleSongDetail(artistId);</span><br><span class="line">    assembleSongComment(artistId);</span><br><span class="line">    assembleSongUrl(artistId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Artist <span class="title">getArtist</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> artists.get(artistId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Song <span class="title">getSong</span><span class="params">(String artistId, String songId)</span> </span>&#123;</span><br><span class="line">    Artist artist = artists.get(artistId);</span><br><span class="line">    List&lt;Song&gt; songs = artist.getSongList();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (songs == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      <span class="keyword">if</span> (song.getId().equals(songId)) &#123;</span><br><span class="line">        <span class="keyword">return</span> song;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Map <span class="title">getArtistObj</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 构建歌单url</span></span><br><span class="line">    String aUrl = ARTIEST_API_PREFIX + artistId;</span><br><span class="line">    <span class="comment">// 调用 okhttp3 获取返回数据</span></span><br><span class="line">    String content = getPageContentSync(aUrl);</span><br><span class="line">    <span class="comment">// 反序列化成 Map 对象</span></span><br><span class="line">    Map returnData = JSON.parseObject(content, Map<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> returnData;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Artist <span class="title">buildArtist</span><span class="params">(Map returnData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 从 Map 对象中取得 歌单 数据。歌单也是一个子 Map 对象。</span></span><br><span class="line">    Map artistData = (Map) returnData.get(<span class="string">"artist"</span>);</span><br><span class="line">    Artist artist = <span class="keyword">new</span> Artist();</span><br><span class="line">    artist.setId(artistData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">    <span class="keyword">if</span> (artistData.get(<span class="string">"picUrl"</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">      artist.setPicUrl(artistData.get(<span class="string">"picUrl"</span>).toString());</span><br><span class="line">    &#125;</span><br><span class="line">    artist.setBriefDesc(artistData.get(<span class="string">"briefDesc"</span>).toString());</span><br><span class="line">    artist.setImg1v1Url(artistData.get(<span class="string">"img1v1Url"</span>).toString());</span><br><span class="line">    artist.setName(artistData.get(<span class="string">"name"</span>).toString());</span><br><span class="line">    artist.setAlias((List) artistData.get(<span class="string">"alias"</span>));</span><br><span class="line">    <span class="keyword">return</span> artist;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> List&lt;Song&gt; <span class="title">buildSongs</span><span class="params">(Map returnData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 从 Map 对象中取得一组 歌曲 数据</span></span><br><span class="line">    List songsData = (List) returnData.get(<span class="string">"hotSongs"</span>);</span><br><span class="line">    List&lt;Song&gt; songs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; songsData.size(); i++) &#123;</span><br><span class="line">      Map songData = (Map) songsData.get(i);</span><br><span class="line">      Song songObj = <span class="keyword">new</span> Song();</span><br><span class="line">      songObj.setId(songData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">      songObj.setName(songData.get(<span class="string">"name"</span>).toString());</span><br><span class="line"></span><br><span class="line">      songs.add(songObj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> songs;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">getPageContentSync</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//2.定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">    <span class="comment">//3.使用client去请求</span></span><br><span class="line">    Call call = okHttpClient.newCall(request);</span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//4.获得返回结果</span></span><br><span class="line">      result = call.execute().body().string();</span><br><span class="line">      System.out.println(<span class="string">"call "</span> + url + <span class="string">" , content's size="</span> + result.length());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initArtistHotSongs</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 取得整体数据对象。</span></span><br><span class="line">    Map returnData = getArtistObj(artistId);</span><br><span class="line">    <span class="comment">// 构建填充了属性的 Artist 实例</span></span><br><span class="line">    Artist artist = buildArtist(returnData);</span><br><span class="line">    <span class="comment">// 构建一组填充了属性的 Song 实例</span></span><br><span class="line">    List&lt;Song&gt; songs = buildSongs(returnData);</span><br><span class="line">    <span class="comment">// 歌曲填入歌单</span></span><br><span class="line">    artist.setSongList(songs);</span><br><span class="line">    <span class="comment">// 存入本地</span></span><br><span class="line">    artists.put(artist.getId(), artist);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">assembleSongDetail</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">assembleSongComment</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">assembleSongUrl</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="服务实现"><a href="#服务实现" class="headerlink" title="服务实现"></a>服务实现</h3><p><img src="https://style.youkeda.com/img/ham/course/j12/3-2-1.svg" alt></p>
<p>完成<br>.●开发完毕<strong>assemblesongDetail()</strong>方法,对于参数指定歌单中的所有歌曲，补充完歌手、专辑信息<br>●重构抓取API数据的方法<strong>getArtistobj()</strong> ，改为通用的方法<strong>getSourceDataobj()</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.music.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Album;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Artist;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Song;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.User;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.service.SongCrawlerService;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Call;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 音乐抓取服务的实现</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SongCrawlerServiceImpl</span> <span class="keyword">implements</span> <span class="title">SongCrawlerService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String ARTIEST_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/artists?id="</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String S_D_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/song/detail?ids="</span>;</span><br><span class="line">  <span class="comment">// okHttpClient 实例</span></span><br><span class="line">  <span class="keyword">private</span> OkHttpClient okHttpClient;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 歌单数据仓库</span></span><br><span class="line">  <span class="keyword">private</span> Map&lt;String, Artist&gt; artists;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1. 构建 okHttpClient 实例</span></span><br><span class="line">    okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">    artists = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 参数判断，未输入参数则直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (artistId == <span class="keyword">null</span> || artistId.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行初始化</span></span><br><span class="line">    init();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化歌曲及歌单</span></span><br><span class="line">    initArtistHotSongs(artistId);</span><br><span class="line">    assembleSongDetail(artistId);</span><br><span class="line">    assembleSongComment(artistId);</span><br><span class="line">    assembleSongUrl(artistId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Artist <span class="title">getArtist</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> artists.get(artistId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Song <span class="title">getSong</span><span class="params">(String artistId, String songId)</span> </span>&#123;</span><br><span class="line">    Artist artist = artists.get(artistId);</span><br><span class="line">    List&lt;Song&gt; songs = artist.getSongList();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (songs == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      <span class="keyword">if</span> (song.getId().equals(songId)) &#123;</span><br><span class="line">        <span class="keyword">return</span> song;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Map <span class="title">getSourceObj</span><span class="params">(String prefix, String postfix)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 构建歌单url</span></span><br><span class="line">    String aUrl = prefix + postfix;</span><br><span class="line">    <span class="comment">// 调用 okhttp3 获取返回数据</span></span><br><span class="line">    String content = getPageContentSync(aUrl);</span><br><span class="line">    <span class="comment">// 反序列化成 Map 对象</span></span><br><span class="line">    Map returnData = JSON.parseObject(content, Map<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> returnData;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Artist <span class="title">buildArtist</span><span class="params">(Map returnData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 从 Map 对象中取得 歌单 数据。歌单也是一个子 Map 对象。</span></span><br><span class="line">    Map artistData = (Map) returnData.get(<span class="string">"artist"</span>);</span><br><span class="line">    Artist artist = <span class="keyword">new</span> Artist();</span><br><span class="line">    artist.setId(artistData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">    <span class="keyword">if</span> (artistData.get(<span class="string">"picUrl"</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">      artist.setPicUrl(artistData.get(<span class="string">"picUrl"</span>).toString());</span><br><span class="line">    &#125;</span><br><span class="line">    artist.setBriefDesc(artistData.get(<span class="string">"briefDesc"</span>).toString());</span><br><span class="line">    artist.setImg1v1Url(artistData.get(<span class="string">"img1v1Url"</span>).toString());</span><br><span class="line">    artist.setName(artistData.get(<span class="string">"name"</span>).toString());</span><br><span class="line">    artist.setAlias((List) artistData.get(<span class="string">"alias"</span>));</span><br><span class="line">    <span class="keyword">return</span> artist;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> List&lt;Song&gt; <span class="title">buildSongs</span><span class="params">(Map returnData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 从 Map 对象中取得一组 歌曲 数据</span></span><br><span class="line">    List songsData = (List) returnData.get(<span class="string">"hotSongs"</span>);</span><br><span class="line">    List&lt;Song&gt; songs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; songsData.size(); i++) &#123;</span><br><span class="line">      Map songData = (Map) songsData.get(i);</span><br><span class="line">      Song songObj = <span class="keyword">new</span> Song();</span><br><span class="line">      songObj.setId(songData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">      songObj.setName(songData.get(<span class="string">"name"</span>).toString());</span><br><span class="line"></span><br><span class="line">      songs.add(songObj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> songs;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">getPageContentSync</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//2.定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">    <span class="comment">//3.使用client去请求</span></span><br><span class="line">    Call call = okHttpClient.newCall(request);</span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//4.获得返回结果</span></span><br><span class="line">      result = call.execute().body().string();</span><br><span class="line">      System.out.println(<span class="string">"call "</span> + url + <span class="string">" , content's size="</span> + result.length());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initArtistHotSongs</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 取得整体数据对象。</span></span><br><span class="line">    Map returnData = getSourceObj(ARTIEST_API_PREFIX,artistId);</span><br><span class="line">    <span class="comment">// 构建填充了属性的 Artist 实例</span></span><br><span class="line">    Artist artist = buildArtist(returnData);</span><br><span class="line">    <span class="comment">// 构建一组填充了属性的 Song 实例</span></span><br><span class="line">    List&lt;Song&gt; songs = buildSongs(returnData);</span><br><span class="line">    <span class="comment">// 歌曲填入歌单</span></span><br><span class="line">    artist.setSongList(songs);</span><br><span class="line">    <span class="comment">// 存入本地</span></span><br><span class="line">    artists.put(artist.getId(), artist);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">assembleSongDetail</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    Artist artist = getArtist(artistId);</span><br><span class="line">    <span class="keyword">if</span>(artist==<span class="keyword">null</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;String&gt; songIds = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    List&lt;Song&gt; songs = artist.getSongList();</span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      songIds.add(song.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String sIdsParam = String.join(<span class="string">","</span>, songIds);</span><br><span class="line">    <span class="comment">// 抓取结果</span></span><br><span class="line">    Map songsDetailObj = getSourceObj(S_D_API_PREFIX, sIdsParam);</span><br><span class="line">    <span class="comment">// 原始数据中的 songs 是歌曲列表</span></span><br><span class="line">    List&lt;Map&gt; sourceSongs = (List&lt;Map&gt;) songsDetailObj.get(<span class="string">"songs"</span>);</span><br><span class="line">    <span class="comment">// 临时的 Map</span></span><br><span class="line">    Map&lt;String, Map&gt; sourceSongsMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">// 遍历歌曲列表</span></span><br><span class="line">    <span class="keyword">for</span> (Map songSourceData : sourceSongs) &#123;</span><br><span class="line">      String sId = songSourceData.get(<span class="string">"id"</span>).toString();</span><br><span class="line">      <span class="comment">// 原始歌曲数据对象放入一个临时的 Map 中</span></span><br><span class="line">      sourceSongsMap.put(sId, songSourceData);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 再次遍历歌单中的歌曲，填入详情数据</span></span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      String sId = song.getId();</span><br><span class="line">      <span class="comment">// 从临时的Map中取得对应的歌曲源数据，使用id直接获取，比较方便</span></span><br><span class="line">      Map songSourceData = sourceSongsMap.get(sId);</span><br><span class="line">      </span><br><span class="line">      List&lt;Map&gt; singersData = (List&lt;Map&gt;) songSourceData.get(<span class="string">"ar"</span>);</span><br><span class="line">      </span><br><span class="line">      List&lt;User&gt; singers = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">for</span>(Map singerData : singersData)&#123;</span><br><span class="line">        User singer = <span class="keyword">new</span> User();</span><br><span class="line">        singer.setId(singerData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">        singer.setNickName(singerData.get(<span class="string">"name"</span>).toString());</span><br><span class="line">        singers.add(singer);</span><br><span class="line">      &#125;</span><br><span class="line">        song.setSingers(singers);</span><br><span class="line">        </span><br><span class="line">        Map AlbumData = (Map) songSourceData.get(<span class="string">"al"</span>);</span><br><span class="line">        </span><br><span class="line">        Album album = <span class="keyword">new</span> Album();</span><br><span class="line">        </span><br><span class="line">        album.setId(AlbumData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">        album.setName(AlbumData.get(<span class="string">"name"</span>).toString());</span><br><span class="line">        <span class="keyword">if</span>(AlbumData.get(<span class="string">"picUrl"</span>)!=<span class="keyword">null</span>)&#123;</span><br><span class="line">          album.setPicUrl(AlbumData.get(<span class="string">"picUrl"</span>).toString());</span><br><span class="line">        &#125;</span><br><span class="line">        song.setAlbum(album);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">assembleSongComment</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">assembleSongUrl</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id><a href="#" class="headerlink" title></a></h3><p><img src="https://style.youkeda.com/img/ham/course/j12/3-2-1.svg" alt></p>
<p><strong>完成</strong><br>开发完毕<strong>assembleSongComment()和assembleSongurl()</strong>方法，对于参数指定歌单中的所有歌曲，补充完评论、热[门]评论、音乐文件地址数据。</p>
<p><strong>重构要求</strong><br><strong>1.重构组装批量参数的过程</strong><br>●定义新的<strong>buildManyIdParam()</strong> 方法,完成组装批量参数的过程,返回结果字符串。这个过程本节已经演示过,建议理解后自己敲代码，不要拷贝。</p>
<p>private string buildManyIdParam(List<Song> song<br>●别忘了修改<strong>assemblesongDetail()</strong>中的相关代码，改<br>为调用新方法</Song></p>
<p><strong>2.避免使用重复代码解析评论源数据</strong><br>热门评论的字段是| hotComments ，评论的字段是comments<br>。<br>可以自定义一个方法完成热[ ]评论和评论源数据的解析。<br>小提示:<br>方法参数是评论源数据列表List<Map>，返回值是<br>L i st<C omment><br>●此方法不演示了，请大家动脑筋思考。<br>●也可以应用重构的思想，先写出来解析热[ ]评论的过程，再重构方法。</C></Map></p>
<p>约定：调用评论API时，limit 参数设置为5</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.music.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Album;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Artist;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Comment;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Song;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.User;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.service.SongCrawlerService;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Call;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 音乐抓取服务的实现</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SongCrawlerServiceImpl</span> <span class="keyword">implements</span> <span class="title">SongCrawlerService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 歌单 API</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String ARTIEST_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/artists?id="</span>;</span><br><span class="line">  <span class="comment">// 歌曲详情 API</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String S_D_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/song/detail?ids="</span>;</span><br><span class="line">  <span class="comment">// 歌曲评论 API</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String S_C_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/comment/music?id="</span>;</span><br><span class="line">  <span class="comment">// 歌曲音乐文件 API</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String S_F_API_PREFIX = <span class="string">"http://neteaseapi.youkeda.com:3000/song/url?id="</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// okHttpClient 实例</span></span><br><span class="line">  <span class="keyword">private</span> OkHttpClient okHttpClient;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 歌单数据仓库</span></span><br><span class="line">  <span class="keyword">private</span> Map&lt;String, Artist&gt; artists;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1. 构建 okHttpClient 实例</span></span><br><span class="line">    okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">    artists = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 参数判断，未输入参数则直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (artistId == <span class="keyword">null</span> || artistId.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行初始化</span></span><br><span class="line">    init();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化歌曲及歌单</span></span><br><span class="line">    initArtistHotSongs(artistId);</span><br><span class="line">    assembleSongDetail(artistId);</span><br><span class="line">    assembleSongComment(artistId);</span><br><span class="line">    assembleSongUrl(artistId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Artist <span class="title">getArtist</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> artists.get(artistId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Song <span class="title">getSong</span><span class="params">(String artistId, String songId)</span> </span>&#123;</span><br><span class="line">    Artist artist = artists.get(artistId);</span><br><span class="line">    List&lt;Song&gt; songs = artist.getSongList();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (songs == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      <span class="keyword">if</span> (song.getId().equals(songId)) &#123;</span><br><span class="line">        <span class="keyword">return</span> song;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Map <span class="title">getSourceDataObj</span><span class="params">(String prefix, String postfix)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 构建歌单url</span></span><br><span class="line">    String aUrl = prefix + postfix;</span><br><span class="line">    <span class="comment">// 调用 okhttp3 获取返回数据</span></span><br><span class="line">    String content = getPageContentSync(aUrl);</span><br><span class="line">    <span class="comment">// 反序列化成 Map 对象</span></span><br><span class="line">    Map returnData = JSON.parseObject(content, Map<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> returnData;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> Artist <span class="title">buildArtist</span><span class="params">(Map returnData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 从 Map 对象中取得 歌单 数据。歌单也是一个子 Map 对象。</span></span><br><span class="line">    Map artistData = (Map) returnData.get(<span class="string">"artist"</span>);</span><br><span class="line">    Artist artist = <span class="keyword">new</span> Artist();</span><br><span class="line">    artist.setId(artistData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">    <span class="keyword">if</span> (artistData.get(<span class="string">"picUrl"</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">      artist.setPicUrl(artistData.get(<span class="string">"picUrl"</span>).toString());</span><br><span class="line">    &#125;</span><br><span class="line">    artist.setBriefDesc(artistData.get(<span class="string">"briefDesc"</span>).toString());</span><br><span class="line">    artist.setImg1v1Url(artistData.get(<span class="string">"img1v1Url"</span>).toString());</span><br><span class="line">    artist.setName(artistData.get(<span class="string">"name"</span>).toString());</span><br><span class="line">    artist.setAlias((List) artistData.get(<span class="string">"alias"</span>));</span><br><span class="line">    <span class="keyword">return</span> artist;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> List&lt;Song&gt; <span class="title">buildSongs</span><span class="params">(Map returnData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 从 Map 对象中取得一组 歌曲 数据</span></span><br><span class="line">    List songsData = (List) returnData.get(<span class="string">"hotSongs"</span>);</span><br><span class="line">    List&lt;Song&gt; songs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; songsData.size(); i++) &#123;</span><br><span class="line">      Map songData = (Map) songsData.get(i);</span><br><span class="line">      Song songObj = <span class="keyword">new</span> Song();</span><br><span class="line">      songObj.setId(songData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">      songObj.setName(songData.get(<span class="string">"name"</span>).toString());</span><br><span class="line"></span><br><span class="line">      songs.add(songObj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> songs;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">getPageContentSync</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//2.定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">    <span class="comment">//3.使用client去请求</span></span><br><span class="line">    Call call = okHttpClient.newCall(request);</span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//4.获得返回结果</span></span><br><span class="line">      result = call.execute().body().string();</span><br><span class="line">      System.out.println(<span class="string">"call "</span> + url + <span class="string">" , content's size="</span> + result.length());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initArtistHotSongs</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 取得整体数据对象。</span></span><br><span class="line">    Map returnData = getSourceDataObj(ARTIEST_API_PREFIX, artistId);</span><br><span class="line">    <span class="comment">// 构建填充了属性的 Artist 实例</span></span><br><span class="line">    Artist artist = buildArtist(returnData);</span><br><span class="line">    <span class="comment">// 构建一组填充了属性的 Song 实例</span></span><br><span class="line">    List&lt;Song&gt; songs = buildSongs(returnData);</span><br><span class="line">    <span class="comment">// 歌曲填入歌单</span></span><br><span class="line">    artist.setSongList(songs);</span><br><span class="line">    <span class="comment">// 存入本地</span></span><br><span class="line">    artists.put(artist.getId(), artist);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">assembleSongDetail</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    Artist artist = getArtist(artistId);</span><br><span class="line">    <span class="comment">// 取不到歌单说明参数输入错误</span></span><br><span class="line">    <span class="keyword">if</span> (artist == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除其它语句，保留必要的语句</span></span><br><span class="line">    List&lt;Song&gt; songs = artist.getSongList();</span><br><span class="line">    String sIdsParam = buildManyIdParam(songs);</span><br><span class="line">    <span class="comment">// 抓取结果</span></span><br><span class="line">    Map songsDetailObj = getSourceDataObj(S_D_API_PREFIX, sIdsParam);</span><br><span class="line">    <span class="comment">// 原始数据中的 songs 是歌曲列表</span></span><br><span class="line">    List&lt;Map&gt; sourceSongs = (List&lt;Map&gt;) songsDetailObj.get(<span class="string">"songs"</span>);</span><br><span class="line">    <span class="comment">// 临时的 Map</span></span><br><span class="line">    Map&lt;String, Map&gt; sourceSongsMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">// 遍历歌曲列表</span></span><br><span class="line">    <span class="keyword">for</span> (Map songSourceData : sourceSongs) &#123;</span><br><span class="line">      String sId = songSourceData.get(<span class="string">"id"</span>).toString();</span><br><span class="line">      <span class="comment">// 原始歌曲数据对象放入一个临时的 Map 中</span></span><br><span class="line">      sourceSongsMap.put(sId, songSourceData);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 再次遍历歌单中的歌曲，填入详情数据</span></span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      String sId = song.getId();</span><br><span class="line">      <span class="comment">// 从临时的Map中取得对应的歌曲源数据，使用id直接获取，比较方便</span></span><br><span class="line">      Map songSourceData = sourceSongsMap.get(sId);</span><br><span class="line">      <span class="comment">// 源歌曲数据中，ar 字段是歌手列表</span></span><br><span class="line">      List&lt;Map&gt; singersData = (List&lt;Map&gt;) songSourceData.get(<span class="string">"ar"</span>);</span><br><span class="line">      <span class="comment">// 歌手集合</span></span><br><span class="line">      List&lt;User&gt; singers = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">      <span class="keyword">for</span> (Map singerData : singersData) &#123;</span><br><span class="line">        <span class="comment">// 歌手对象</span></span><br><span class="line">        User singer = <span class="keyword">new</span> User();</span><br><span class="line">        singer.setId(singerData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">        singer.setNickName(singerData.get(<span class="string">"name"</span>).toString());</span><br><span class="line">        <span class="comment">// 歌手集合放入歌手对象</span></span><br><span class="line">        singers.add(singer);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 歌手集合放入歌曲</span></span><br><span class="line">      song.setSingers(singers);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 专辑</span></span><br><span class="line">      Map albumData = (Map) songSourceData.get(<span class="string">"al"</span>);</span><br><span class="line">      Album album = <span class="keyword">new</span> Album();</span><br><span class="line">      album.setId(albumData.get(<span class="string">"id"</span>).toString());</span><br><span class="line">      album.setName(albumData.get(<span class="string">"name"</span>).toString());</span><br><span class="line">      <span class="keyword">if</span> (albumData.get(<span class="string">"picUrl"</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        album.setPicUrl(albumData.get(<span class="string">"picUrl"</span>).toString());</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 专辑对象放入歌曲</span></span><br><span class="line">      song.setAlbum(album);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">assembleSongComment</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    Artist artist = getArtist(artistId);</span><br><span class="line">    <span class="comment">// 取不到歌单说明参数输入错误</span></span><br><span class="line">    <span class="keyword">if</span> (artist == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    List&lt;Song&gt; songs = artist.getSongList();</span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      String sIdsParam = song.getId() + <span class="string">"&amp;limit=5"</span>;</span><br><span class="line">      <span class="comment">// 抓取结果</span></span><br><span class="line">      Map songsCommentObj = getSourceDataObj(S_C_API_PREFIX, sIdsParam);</span><br><span class="line">      <span class="comment">// 热门评论列表</span></span><br><span class="line">      List&lt;Map&gt; hotCommentsObj = (List&lt;Map&gt;) songsCommentObj.get(<span class="string">"hotComments"</span>);</span><br><span class="line">      <span class="comment">// 热门评论列表</span></span><br><span class="line">      List&lt;Map&gt; commontsObj = (List&lt;Map&gt;) songsCommentObj.get(<span class="string">"comments"</span>);</span><br><span class="line"></span><br><span class="line">      song.setHotComments(buildComments(hotCommentsObj));</span><br><span class="line">      song.setComments(buildComments(commontsObj));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">assembleSongUrl</span><span class="params">(String artistId)</span> </span>&#123;</span><br><span class="line">    Artist artist = getArtist(artistId);</span><br><span class="line">    <span class="comment">// 取不到歌单说明参数输入错误</span></span><br><span class="line">    <span class="keyword">if</span> (artist == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除其它语句，保留必要的语句</span></span><br><span class="line">    List&lt;Song&gt; songs = artist.getSongList();</span><br><span class="line">    String sIdsParam = buildManyIdParam(songs);</span><br><span class="line">    <span class="comment">// 抓取结果</span></span><br><span class="line">    Map songsFileObj = getSourceDataObj(S_F_API_PREFIX, sIdsParam);</span><br><span class="line">    <span class="comment">// 原始数据中的 data 是音乐文件列表</span></span><br><span class="line">    List&lt;Map&gt; datas = (List&lt;Map&gt;) songsFileObj.get(<span class="string">"data"</span>);</span><br><span class="line">    <span class="comment">// 临时的 Map</span></span><br><span class="line">    Map&lt;String, Map&gt; sourceSongsMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">// 遍历音乐文件列表</span></span><br><span class="line">    <span class="keyword">for</span> (Map songFileData : datas) &#123;</span><br><span class="line">      String sId = songFileData.get(<span class="string">"id"</span>).toString();</span><br><span class="line">      <span class="comment">// 原始音乐文件数据对象放入一个临时的 Map 中</span></span><br><span class="line">      sourceSongsMap.put(sId, songFileData);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 再次遍历歌单中的歌曲，填入音乐文件URL</span></span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      String sId = song.getId();</span><br><span class="line">      <span class="comment">// 从临时的Map中取得对应的音乐文件源数据，使用id直接获取，比较方便</span></span><br><span class="line">      Map songFileData = sourceSongsMap.get(sId);</span><br><span class="line">      <span class="comment">// 源音乐文件数据中，url 字段就是文件地址</span></span><br><span class="line">      <span class="keyword">if</span> (songFileData != <span class="keyword">null</span> &amp;&amp; songFileData.get(<span class="string">"url"</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        String songFileUrl = songFileData.get(<span class="string">"url"</span>).toString();</span><br><span class="line">        song.setSourceUrl(songFileUrl);</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> List&lt;Comment&gt; <span class="title">buildComments</span><span class="params">(List&lt;Map&gt; commontsObj)</span> </span>&#123;</span><br><span class="line">    List&lt;Comment&gt; comments = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Map sourceComment : commontsObj) &#123;</span><br><span class="line">      Comment commont = <span class="keyword">new</span> Comment();</span><br><span class="line">      commont.setContent(sourceComment.get(<span class="string">"content"</span>).toString());</span><br><span class="line">      commont.setId(sourceComment.get(<span class="string">"commentId"</span>).toString());</span><br><span class="line">      commont.setLikedCount(sourceComment.get(<span class="string">"likedCount"</span>).toString());</span><br><span class="line">      commont.setTime(sourceComment.get(<span class="string">"time"</span>).toString());</span><br><span class="line"></span><br><span class="line">      User user = <span class="keyword">new</span> User();</span><br><span class="line">      Map sourceUserData = (Map)sourceComment.get(<span class="string">"user"</span>);</span><br><span class="line">      user.setId(sourceUserData.get(<span class="string">"userId"</span>).toString());</span><br><span class="line">      user.setNickName(sourceUserData.get(<span class="string">"nickname"</span>).toString());</span><br><span class="line">      user.setAvatar(sourceUserData.get(<span class="string">"avatarUrl"</span>).toString());</span><br><span class="line">      commont.setCommentUser(user);</span><br><span class="line"></span><br><span class="line">      comments.add(commont);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> comments;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">buildManyIdParam</span><span class="params">(List&lt;Song&gt; songs)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 收集一个歌单中所有歌曲的id，放入一个list</span></span><br><span class="line">    List&lt;String&gt; songIds = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Song song : songs) &#123;</span><br><span class="line">      songIds.add(song.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 一个歌单中所有歌曲的id，组装成用逗号分割的字符串，形如：347230,347231。记住这个用法，很方便</span></span><br><span class="line">    String sIdsParam = String.join(<span class="string">","</span>, songIds);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> sIdsParam;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.music.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Artist;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.model.Song;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.service.SongCrawlerService;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.music.service.impl.SongCrawlerServiceImpl;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查服务是否可以正确返回对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SongCrawlerTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String SA_DING_DING = <span class="string">"萨顶顶"</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String A_ID = <span class="string">"9270"</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String ZUO_SHOU_ZHI_YUE = <span class="string">"左手指月"</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String S_ID = <span class="string">"536096151"</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    SongCrawlerService songService = <span class="keyword">new</span> SongCrawlerServiceImpl();</span><br><span class="line">    songService.start(A_ID);</span><br><span class="line"></span><br><span class="line">    Artist artist = songService.getArtist(A_ID);</span><br><span class="line">    System.out.println(<span class="string">"歌单名称："</span> + artist.getName());</span><br><span class="line">    <span class="keyword">if</span> (!SA_DING_DING.equals(artist.getName())) &#123;</span><br><span class="line">      System.out.println(<span class="string">"歌单名称错误，不是本测试用例指定的歌单。"</span>);</span><br><span class="line">      System.exit(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Song song = songService.getSong(A_ID, S_ID);</span><br><span class="line">    System.out.println(<span class="string">"歌曲名称："</span> + song.getName());</span><br><span class="line">    <span class="keyword">if</span> (!ZUO_SHOU_ZHI_YUE.equals(song.getName())) &#123;</span><br><span class="line">      System.out.println(<span class="string">"歌曲名称错误，不是本测试用例指定的歌曲。"</span>);</span><br><span class="line">      System.exit(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!SA_DING_DING.equals(song.getSingers().get(<span class="number">0</span>).getNickName())) &#123;</span><br><span class="line">      System.out.println(<span class="string">"歌曲名称错误，不是本测试用例指定的歌曲。"</span>);</span><br><span class="line">      System.exit(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="string">"香蜜沉沉烬如霜 电视原声音乐专辑"</span>.equals(song.getAlbum().getName())) &#123;</span><br><span class="line">      System.out.println(<span class="string">"专辑名称错误，不是本测试用例指定的歌曲的专辑。"</span>);</span><br><span class="line">      System.exit(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (song.getSourceUrl() == <span class="keyword">null</span>) &#123;</span><br><span class="line">      System.out.println(<span class="string">"歌曲名称错误，不是本测试用例指定的歌曲。"</span>);</span><br><span class="line">      System.exit(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (song.getHotComments() == <span class="keyword">null</span> || song.getHotComments().isEmpty()) &#123;</span><br><span class="line">      System.out.println(<span class="string">"歌曲热门评论错误，没有正确抓取评论数据。"</span>);</span><br><span class="line">      System.exit(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"歌曲所属专辑名称："</span> + song.getAlbum().getName());</span><br><span class="line">    System.out.println(<span class="string">"歌曲的歌手名称："</span> + song.getSingers().get(<span class="number">0</span>).getNickName());</span><br><span class="line">    System.out.println(<span class="string">"歌曲音乐为文件地址："</span> + song.getSourceUrl());</span><br><span class="line">    System.out.println(<span class="string">"歌曲热门评论："</span> + song.getHotComments().get(<span class="number">0</span>).getContent());</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"歌曲服务运行成功。非常棒！"</span>);</span><br><span class="line">    System.exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/02/day20/" data-id="ckdn9i6nh000mjwuxblmr1ilt" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AE%9E%E6%88%98%E7%BD%91%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90/" rel="tag">实战网易云音乐</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-day19" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/28/day19/" class="article-date">
  <time datetime="2020-07-28T14:02:53.000Z" itemprop="datePublished">2020-07-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/28/day19/">day19</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h2><p><strong>递归</strong>在编程世界中的表现就是<strong>函数自己调用自己</strong>。</p>
<h3 id="递归在数学中的应用"><a href="#递归在数学中的应用" class="headerlink" title="递归在数学中的应用"></a>递归在数学中的应用</h3><p>大家还记得在高中学的阶乘的计算么? 比如:<br><strong>n! = 1 * 2 * 3 * 4 * …… * (n-1) * n</strong><br><strong>循环实现</strong><br>大家利用现在的循环知识，如何实现呢?代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Recursive</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">factorial</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> factorial = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">      factorial *= i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> factorial;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(factorial(<span class="number">10</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="递归实现"><a href="#递归实现" class="headerlink" title="递归实现"></a>递归实现</h4><p>如果用递归思想，应该怎么实现呢?我们对上面的公式简化下，如果用数学表达公式来表示，可以简单理解为：<br><strong>f(1) = 1</strong><br><strong>f(n) = f(n-1) * n</strong><br>我们来分析下这个公式强调的概念。首先<strong>f(1) = 1</strong>这个就不用多说，当<strong>n= 1</strong>时,结果是<br>重点理解下<strong>f(n) = f(n-1)*n</strong>，这其实就是一种递归的概念，我们为了求<strong>f(n)</strong>，我们不需要关心其他的，我们只需要知道，它是在f(n-1) 的基础 上在乘以n就可以得到。</p>
<p>换一句话说: .我们在求<strong>f(n</strong>)的时候， 我们假设已经搞定 <strong>f(n-1)</strong>了，我们只需要考虑在<strong>f(n-1)</strong> 基础上所需要增加的操作。</p>
<p>那如何用代码来实现呢</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Recursive</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">factorial</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//#1. 当 n = 1 时，递归结束</span></span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//#2. 把 factorial(n - 1) 的结果和 n 相乘，剩下的交给 factorial(n - 1) 来解决。</span></span><br><span class="line">    <span class="keyword">return</span> n * factorial(n - <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(factorial(<span class="number">10</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="汉诺塔的问题"><a href="#汉诺塔的问题" class="headerlink" title="汉诺塔的问题"></a>汉诺塔的问题</h4><p>汉诺塔问题是源于印度一个古老传说的益智玩具。大梵天创造世界的时候做了三根金刚石柱子，在一根柱子上从下往上<br>按照大小顺序摞着64片黄金盘。大梵天命令婆罗门]把圆从下开始按大小顺序重新摆放在另一根柱子上。齟规定，在小圆盘上坏能放大圆盘，在三根柱子之间- -次只能移动一个圆盘。</p>
<p><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/PY1/10/%E6%B1%89%E8%AF%BA%E5%A1%94.png" alt></p>
<p>如上图所示，为了显示方便，我们把圆盘减少到5个。现在要求庙里的老和尚把这64个全部移动到第三个柱子上。<br>一、此时老和尚(后面我们叫他第1个和尚)，这也太难 了吧!所以他想:<br>1.我把上面的63个盘子视为一个整体，让我徒弟(第2个和尚)把这63个盘子移动到第二根柱子上(这个过程包含很多步)<br>2.完成后叫我一声，我把最后一个盘子移动到第三个柱子上<br>3.再让我徒弟把63个盘子移动到第三个柱子上(这个过程包含很多步)，我的任务就完成了<br>●在这里对第一个和尚来说，只有两个盘子，上面的盘子是1-63层，反正是徒弟实现的，怎么实现，作为师傅的不管<br>●移动63个盘子是很大的工作量，我们接下来会一步步拆解</p>
<p>二、此时第二个和尚懵逼了，师傅你怕不是在逗我?还好我也有徒弟，于是他叫来他徒弟(我们把他叫为第3个和尚)， 他有样学样对他徒弟说:<br>1.你把前面62个盘子移动到第三个柱子上(这个过程包含很多步)<br>2.完成后叫我一声，我把倒数第2个盘子移动到第二个柱子上<br>3.然后你再把第三个柱子的62个盘子移动到第二个柱子上(这个过程包含很多步)<br>4.然后第二个柱子上已经有63个盘子，我再去找师傅，告诉他我完成了任务<br>5.最后师傅让我把63个盘子移动到第三个柱子，我又来找我的徒弟了<br>6.第3个徒弟，你把62个盘子移开，放到第一个柱子上<br>7.我把倒数第2个盘子移动到第三个柱子上<br>8.第3个徒弟，再把62个盘子移动到第三个柱子上。在这里对第二个和尚来说，只贿两个盘子，上面到盘子 是1-62层，反正是徒弟实现的，作为师傅的不管,最下面那个盘子是师傅(第1个和尚)移动的，他也不管接下来就比较简单了。</p>
<p>当第64个和尚移动第1个盘子,把它移开,然后第63个和尚移动他自己的任务，以此类推。</p>
<p><img src="https://style.youkeda.com/img/course/a1/5/1-1.svg" alt></p>
<p>这就是递归思维。<br><strong>实战缩减版场景</strong><br>我们再来图际一下这个任务，首先是两个盘子的情况:</p>
<p><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/PY1/9/%E6%B1%89%E8%AF%BA%E5%A1%942%E5%B1%82.gif" alt></p>
<p>我们可以看到一共移动了3次盘子，也就是2^2-1<br>然后是3个盘子的情况:</p>
<p><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/PY1/9/%E6%B1%89%E8%AF%BA%E5%A1%943%E5%B1%82.gif" alt></p>
<p>我们可以看到一共移动了7次盘子,也就是2^3-1那么可知64个盘子，我们需要移动2^64-1次盘子，由此可知这个任务的复杂度。大家现在只需要理解这种思维方式，如果有兴趣可以自己尝试<br>写一下代码。<br>从上面的两个问题，我们可以看到，使用递归函数,可以简化进关系。代码比较复杂，对现在的大家可能会很难，很痛苦，暂时我们不考虑学习。学习完整个课程以后，如果大家有兴趣可以自己去实现以下。</p>
<h2 id="递归应该如何实现"><a href="#递归应该如何实现" class="headerlink" title="递归应该如何实现"></a>递归应该如何实现</h2><p>1、<strong>基准条件</strong></p>
<p>什么叫基准条件?我们也可以理解为递归结束条件!如果没有结束条件， 就会出现死循环了，这点特别重要。<br>我们以<strong>阶乘</strong>为案例，如果我们在<strong>factorial</strong>函数中去掉</p>
<p>if (n == 1) {<br>    return 1;<br>}</p>
<p>最终代码为：</p>
<p>public static int factorial(int n) {<br>    return n * factorial(n - 1);<br>}</p>
<p>试想一下会出现什么问题？阶乘的结果将是</p>
<p>n! = n * (n - 1) * … * 1 * 0 * -1 * -2 * …</p>
<p>这将是一个<strong>死循环</strong>。<br>所以上面if (n == 1)这个结束条件，或者叫做<strong>基准条件</strong>非常<br>重要。<br>那汉诺塔问题的基准条件是什么呢?<br>同样的道理， 是第64个和尚处理最上面一个盘子的逻辑。</p>
<h3 id="2-递归公式"><a href="#2-递归公式" class="headerlink" title="2.递归公式"></a>2.递归公式</h3><p>解决了递归<strong>基准条件</strong>之后，我们需要考虑递归如何执行下去?<br>也就是递归公式。<br>对于阶乘的递归公式很容易找寻<br>                       <strong>f(n)=n<em>f(n- 1)</em></strong><br><strong>递归公式总是 描述自己和下一个递归函数直接的递进关系</strong><br><strong>那汉诺塔的递归公式是什么呢?</strong><br>第一个和尚的递归公式，应该是如果把上面63个盘子，当<br>做一个盘子，应该怎么搬运。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>所以在之后碰到问题以后，我们可以按照如下流程进行思考:<br>(1)找出<strong>基准条件</strong>。<br>(2)思考在基准条件下，会出现什么<strong>情况</strong>。<br>(3)思考基准条件<strong>前一步</strong>的情况，或者函数执行情况。<br>(4)配合<strong>递归公式</strong>，继续<strong>往前推进</strong>。<br>(5)最后实现完善的代码。❸<br>我们来实践几道题目，巩固一下递归能力。</p>
<h2 id="斐波那契数列的排列例题-代码案例："><a href="#斐波那契数列的排列例题-代码案例：" class="headerlink" title="斐波那契数列的排列例题-代码案例："></a>斐波那契数列的排列例题-代码案例：</h2><p>在数学中，有一种数列叫斐波那契数列的排列。如:<br>0，1，1，2，3，5，8，13，21，34，55，89，….|以此类推<br>下去。<br>我们想获取第N个斐波那契数应该怎么用代码实现呢?<br>从上面的例子我们发现，<strong>第三个数字开始每个数总是等于前面</strong><br><strong>两个数的和。</strong><br>从这个规律，可以得到:<br><strong>基准条件</strong><br>第0， 1个元素是0和1<br><strong>递归公式</strong><br><img src="https://qgt-document.oss-cn-beijing.aliyuncs.com/PY1/10/%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Recursive</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">fibonacci</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> n;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> fibonacci(n-<span class="number">1</span>)+fibonacci(n-<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"fibonacci(1) = "</span> + fibonacci(<span class="number">1</span>));</span><br><span class="line">    System.out.println(<span class="string">"fibonacci(3) = "</span> + fibonacci(<span class="number">3</span>));</span><br><span class="line">    System.out.println(<span class="string">"fibonacci(10) = "</span> + fibonacci(<span class="number">10</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h2 id="分治思想"><a href="#分治思想" class="headerlink" title="分治思想"></a>分治思想</h2><p>举个例子:<br>我们从小到大读书期间，学校为了方便学生管理，会将学生分为<strong>多个年级</strong>，每个年级又会分为<strong>多个班级</strong>，每个班级甚至还会分为<strong>很多小组</strong>。那疫情期间，学校有统计任务了,需要统计每 个同学包括其家人的籍贯，出行情况，那该如何做呢?我们知道，学校将任务分配给每个年级主任，年级主任分配给每个班级,每个班主任分配给每个组长，每个组长在分配给每个人。后在反过来一层层汇总学生信息，-级级反馈给上级。</p>
<p>这就是一个经典的分支案例，如果用计算机语言来描述的话:</p>
<p>分而治之的思想是采用了<strong>递归</strong>的思想,将原问题分成<strong>几个规模较小但是类似于原问题的子问题</strong>，通过递归的方式来求解这些小问题，最后将子问题的解合并来得到原问题的解。</p>
<p><img src="https://style.youkeda.com/img/course/a1/5/4-1.svg" alt></p>
<h3 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h3><p>利用<strong>分治思想</strong>，我们可以实现一种更高效的排序算法—<strong>归并排序</strong>。<br>归并排序的核心思路<br>将大数组分解成小数组,将悔个小数组排好序，再将这些有<br>序的小数组合并成大数组。➊<br>我们来看一个具体案例，仍然用之前的数组</p>
<p>9, 2, 4, 7, 5, 3</p>
<p><img src="https://style.youkeda.com/img/course/a1/5/4-2.svg" alt></p>
<p>从图中，我们可以看出，我们分为如下几步：</p>
<p><strong>一、分</strong><br>2分法拆分原数组，直到每个数组里面只剩一个元素位置<br>(1)<strong>9，2，4，7，5，3</strong>拆分为<strong>9，2，4</strong>和<strong>7，5，3</strong>。<br>(2)<strong>9，2，4</strong>拆分为<strong>9,2</strong>和<strong>4</strong>，右侧数组也一样。<br>(3)<strong>9，2</strong>拆分为<strong>9和2</strong>。<br><strong>二、治</strong><br>将拆分的数组进行合并，并且在合并的时候保证合并的数组<br>是有序的。<br>(1)<strong>9和2</strong>，合并为<strong>2, 9</strong>，我们暂时只关心左侧部分。<br>(2)<strong>2，9</strong>和<strong>4</strong>，合并为<strong>2，4,9</strong>。<br>(3)|<strong>2，4，9</strong>和<strong>3，5，7</strong>，合并为<strong>2，3，4，5，7，9</strong>。</p>
<p><strong>分-代码实现</strong><br>在拆分的过程中，有两个核心逻辑<br><strong>1.如何递归进行数组的拆分</strong><br><strong>2.如何用原始数组创建两个子数组</strong><br>我们两个函数来表示</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 归并排序， 返回排好序的数组</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] mergeSort(<span class="keyword">int</span>[] array) &#123;</span><br><span class="line"><span class="comment">//拷贝原数组的部分内容，从left到right</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] subArray(<span class="keyword">int</span>[] source, <span class="keyword">int</span> left,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>接下来,我们首先完成第二个函数,拷贝原数组。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 拷贝原数组的部分内容，从 left 到 right</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] subArray(<span class="keyword">int</span>[] source, <span class="keyword">int</span> left, <span class="keyword">int</span> right) &#123;</span><br><span class="line">    <span class="comment">// 创建一个新数组</span></span><br><span class="line">    <span class="keyword">int</span>[] result = <span class="keyword">new</span> <span class="keyword">int</span>[right - left];</span><br><span class="line">    <span class="comment">// 依次赋值进去</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = left; i &lt; right; i++) &#123;</span><br><span class="line">        result[i - left] = source[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这部分逻辑比较简单,我就不多加介绍了，重点看来mergesort:，如何实现递归拆分原数组。<br>我们先找准基准条件:<strong>数组元素只有一一个，则直接返回</strong>。代码如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 归并排序，返回排好序的数组</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] mergeSort(<span class="keyword">int</span>[] array) &#123;</span><br><span class="line">  <span class="keyword">if</span>(array.length == <span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> array;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在数组元素不止一个的情况下，我们需要从数组中间进行拆分，分别调用<strong>mergeSort</strong>，代码如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sort</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 归并排序，返回排好序的数组</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] mergeSort(<span class="keyword">int</span>[] array) &#123;</span><br><span class="line">    <span class="comment">// 为了方便查看结果，我们将每个数组进行打印</span></span><br><span class="line">    System.out.println(Arrays.toString(array));</span><br><span class="line">    <span class="keyword">if</span> (array.length == <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> middle = array.length / <span class="number">2</span>;</span><br><span class="line">    <span class="comment">// 处理 0 到 middle 左侧数组部分</span></span><br><span class="line">    <span class="keyword">int</span>[] left = mergeSort(subArray(array, <span class="number">0</span>, middle));</span><br><span class="line">    <span class="comment">// 处理 middle 到 array.length 右侧数组部分</span></span><br><span class="line">    <span class="keyword">int</span>[] right = mergeSort(subArray(array, middle, array.length));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// TODO处理合并问题</span></span><br><span class="line">    <span class="keyword">return</span> array;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 拷贝原数组的部分内容，从 left 到 right</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] subArray(<span class="keyword">int</span>[] source, <span class="keyword">int</span> left, <span class="keyword">int</span> right) &#123;</span><br><span class="line">    <span class="comment">// 创建一个新数组</span></span><br><span class="line">    <span class="keyword">int</span>[] result = <span class="keyword">new</span> <span class="keyword">int</span>[right - left];</span><br><span class="line">    <span class="comment">// 依次赋值进去</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = left; i &lt; right; i++) &#123;</span><br><span class="line">      result[i - left] = source[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">9</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="comment">// Arrays.toString 可以方便打印数组内容</span></span><br><span class="line">    System.out.println(<span class="string">"raw: "</span> + Arrays.toString(array));</span><br><span class="line">    <span class="keyword">int</span>[] result = mergeSort(array);</span><br><span class="line">    System.out.println(<span class="string">"result: "</span> + Arrays.toString(result));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>大家重点理解上面#1 #2 注释的代码，理解创建子数组，然.后递归分治的逻辑(我们暂时忽略合并排序的逻辑)<br>。</p>
<h2 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h2><p><strong>快速排序</strong>：<strong>是现在编程语言自带排序函数中，使用的最多的算法。</strong><br>例如我们常见的 <strong>List. sort()</strong>。快速排序也是现在面试官最喜欢面试的排序的算法，没有之实现的原理、 复杂度都有一定的难度。那很多人不服了，为什么不是<strong>归并排序</strong>呢?<br>从上节课我们发现<strong>归并排序会创建新的数组，所以空间复杂度会偏大</strong>。同时在平时日常多见的平均情况下，快速排序确实在性能上表现优异多。</p>
<h4 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h4><p><strong>分区</strong><br>在归并排序中，我们会将数组二分解。<br>在快速排序中，分解的逻辑也差不多，首先我们随机选中一个数字当做轴，目标是将原始数组根据轴进行分区分拆，比轴小的放在左边，比轴大的放在右边。</p>
<p>那如何做到一点呢?我们来实战一-下,一步步实现。首先我们给定一个原始数组<br>1，6，4，2，5，3。<br>第一步,我们选择哪个数字为轴呢?理论上选择任意值都可以，那我们就以最后一个元愫3作为轴吧(选择轴本身是一定的技巧和方法,此处我们只考虑简单的情况，大家有精力的可以自己去研究)。</p>
<p>紧接着,我们放置左右两个指针，分别指向索引0和索弓|倒数<br>第二个，如图所示:</p>
<p><img src="https://style.youkeda.com/img/course/a1/5/5-2.svg" alt></p>
<p>紧接着我们需要将除3以外的剩下数字进行分区，分配到小于3和大于3两部分。<br>主要逻辑如下:<br>(1)左指针依次往右侧移动，当遇到大于或者等于轴3的值，则停止<br>(2)右指针相反，依次往左侧移动，当遇到小于或者等于轴3的值,则停止<br>(3)将左右两个指针指向的值进行互换<br>(4)互换以后，然后继续按照上面(1) - (3) 执行，直到左指针和右指针重叠。<br>(5)将左右两个指针指向的值和轴3互换我们还是一步步演示一下。</p>
<p><strong>第一步</strong><br>首先执行(1) (2) 两步，那最终指针停留在如下图所示，左指针指向6 |,右指针指向2。</p>
<p><img src="https://style.youkeda.com/img/course/a1/5/5-3.svg" alt></p>
<p>从图中，我们看到紧接着交换左右指针指向的值(也就是交换6和2的位置)。<br><strong>第二步</strong><br>我们继续推进左指针和右指针，左指针移动到4停止，右指针也是左移到4停止，这时候我们发现左右指针重合了。所以接下来需要执行(5)步骤,让4和轴3进行交换,如下图所示:</p>
<p><img src="https://style.youkeda.com/img/course/a1/5/5-4.svg" alt></p>
<p>从图中可以看出，这时候轴3，已经在它正确的位置。虽然3左边和3右边还是乱序，但-步步来嘛。<br>下面我们开始<strong>第二次分区。</strong><br>通过第一次分区 ，我们将数组分为左侧和右侧两部分，按照递归的思想，我们继续将左右两侧数组按照选轴分区重复排序。</p>
<p><img src="https://style.youkeda.com/img/course/a1/5/5-5.svg" alt></p>
<p>总结下，其实快速排序的宗旨<br>通过每次轴分区 ，都能完成轴的位置定位。<br><strong>时间复杂度</strong><br>那快速排序的时间复杂度是多少呢?和归并排序一样,每一-次分区需要全数组比较一次所以为0(N)。那需要多少次分区呢，按照二分法排序法应该为0(1og(N)) ,所以最终的结果为<strong>0(Nlog(N))。</strong><br>但是有一-种最坏的情况，如果元素的数组本身是有序的，大家想想会发生什么情况?如下图所示</p>
<p><img src="https://style.youkeda.com/img/course/a1/5/5-6.svg" alt></p>
<p>我们每次分区，实际.上相当于没有分区，因为轴永远是最大的值，这种情况下的时间复杂度是<strong>0(N^2</strong>)但这种情况是极少了，所以一般我们忽略,大家只需要了解一下最坏情况即可。</p>
<h2 id="快速排序代码实现"><a href="#快速排序代码实现" class="headerlink" title="快速排序代码实现"></a>快速排序代码实现</h2><p>在准备将算法用代码实现的时候，我们得特别注意总分的思想，不要一开始就去死抠细.<br>节。<br>比如在此处，我们得站在高处想一想， 我们的算法逻辑可以分为几个大块?<br>首先，我们知道<strong>快速排序</strong>是一个递归思维，那么知道是递归思维，我们需要知道<strong>基准条件</strong><br>和<strong>递归公式</strong>到底是什么?<br>这个递归比较简单，分别是</p>
<p><strong>基准条件</strong>:当数组里元素于等于1个元素的时候结束<br><strong>递归公式</strong>:当海一-次分区,获取到轴位置后，左右分拆数组，继续快速排序，这就是<br>递归公式。<br>好，有了这里概括，我们来写一些代码的思路。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickSort</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 快速排序</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 调用快速排序的核心，传入left，right</span></span><br><span class="line">    quickSortCore(array, <span class="number">0</span>, array.length - <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 快速排序的核心，同样也是递归函数</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">quickSortCore</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 递归基准条件，left &gt;= right 即表示数组只有1个或者0个元素。</span></span><br><span class="line">    <span class="keyword">if</span> (left &gt;= right) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据轴分区</span></span><br><span class="line">    <span class="keyword">int</span> pivotIndex = partition(array, left, right);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 递归调用左侧和右侧数组分区</span></span><br><span class="line">    quickSortCore(array, left, pivotIndex - <span class="number">1</span>);</span><br><span class="line">    quickSortCore(array, pivotIndex + <span class="number">1</span>, right);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 对数组进行分区，并返回当前轴所在的位置</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">partition</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">9</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="comment">// Arrays.toString 可以方便打印数组内容</span></span><br><span class="line">    System.out.println(<span class="string">"raw: "</span> + Arrays.toString(array));</span><br><span class="line">    quickSort(array);</span><br><span class="line">    System.out.println(<span class="string">"result: "</span> + Arrays.toString(array));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为什么有了quickSortCore 还需要定义quickSort方法?因为为了方便外部调用，外部调用排序，只需要传入数组就行了，环需要再传入left，I right 。<br>这其实是接口友好的一种设计表现。➊在这里大家重点需要关心是整体实现思路。一定要掌握喔。接下来，请大家利用上一节学习的指针移动交换的逻辑，完成<strong>partition</strong>方法。</p>
<h1 id="快速排序代码案例："><a href="#快速排序代码案例：" class="headerlink" title="快速排序代码案例："></a>快速排序代码案例：</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickSort</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 快速排序</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 调用快速排序的核心，传入left，right</span></span><br><span class="line">    quickSortCore(array, <span class="number">0</span>, array.length - <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 快速排序的核心，同样也是递归函数</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">quickSortCore</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 递归基准条件，left &gt;= right 即表示数组只有1个或者0个元素。</span></span><br><span class="line">    <span class="keyword">if</span> (left &gt;= right) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据轴分区</span></span><br><span class="line">    <span class="keyword">int</span> pivotIndex = partition(array, left, right);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 递归调用左侧和右侧数组分区</span></span><br><span class="line">    quickSortCore(array, left, pivotIndex - <span class="number">1</span>);</span><br><span class="line">    quickSortCore(array, pivotIndex + <span class="number">1</span>, right);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 对数组进行分区，并返回当前轴所在的位置</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">partition</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pivot = array[right];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> leftIndex = left;</span><br><span class="line">    <span class="keyword">int</span> rightIndex = right - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">      <span class="comment">// 左指针移动</span></span><br><span class="line">      <span class="keyword">while</span> (array[leftIndex] &lt;= pivot &amp;&amp; leftIndex &lt; right) &#123;</span><br><span class="line">        leftIndex++;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 右指针移动</span></span><br><span class="line">      <span class="keyword">while</span> (array[rightIndex] &gt;= pivot &amp;&amp; rightIndex &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        rightIndex--;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (leftIndex &gt;= rightIndex) &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        swap(array, leftIndex, rightIndex);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    swap(array, leftIndex, right);</span><br><span class="line">    <span class="keyword">return</span> leftIndex;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> index1, <span class="keyword">int</span> index2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp = array[index1];</span><br><span class="line">    array[index1] = array[index2];</span><br><span class="line">    array[index2] = temp;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">9</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="comment">// Arrays.toString 可以方便打印数组内容</span></span><br><span class="line">    System.out.println(<span class="string">"raw: "</span> + Arrays.toString(array));</span><br><span class="line">    quickSort(array);</span><br><span class="line">    System.out.println(<span class="string">"result: "</span> + Arrays.toString(array));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="快速排序应用-快速选择-代码案例："><a href="#快速排序应用-快速选择-代码案例：" class="headerlink" title="快速排序应用 - 快速选择##     代码案例："></a>快速排序应用 - 快速选择##     代码案例：</h2><p><img src="https://style.youkeda.com/img/course/a1/5/5-7.svg" alt></p>
<p><strong>目标是找寻到30位同学成绩中，第6位同学的成绩!如果大家能顺利完成此处的代码，大家对快速排序已经真正的掌握了。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickSort</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 快速选择，返回选中的元素</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">quickFind</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> aim)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 调用快速选择的核心，传入left，right</span></span><br><span class="line">    <span class="keyword">return</span> quickFindCore(array, aim, <span class="number">0</span>, array.length - <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 快速选择的核心，同样也是递归函数</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">quickFindCore</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> aim, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 递归基准条件，left &gt;= right 即表示数组只有1个或者0个元素，返回当前的元素</span></span><br><span class="line">    <span class="keyword">if</span> (left &gt;= right) &#123;</span><br><span class="line">      <span class="keyword">return</span> array[left];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据轴分区</span></span><br><span class="line">    <span class="keyword">int</span> pivotIndex = partition(array, left, right);</span><br><span class="line">    <span class="comment">// 根据 aim 确定继续递归的方向</span></span><br><span class="line">    <span class="keyword">if</span> (pivotIndex &gt; aim) &#123;</span><br><span class="line">      <span class="keyword">return</span> quickFindCore(array, aim, left, pivotIndex - <span class="number">1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pivotIndex &lt; aim) &#123;</span><br><span class="line">      <span class="keyword">return</span> quickFindCore(array, aim, pivotIndex + <span class="number">1</span>, right);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> array[pivotIndex];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 对数组进行分区，并返回当前轴所在的位置</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">partition</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pivot = array[right];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> leftIndex = left;</span><br><span class="line">    <span class="keyword">int</span> rightIndex = right - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">      <span class="comment">// 左指针移动</span></span><br><span class="line">      <span class="keyword">while</span> (array[leftIndex] &lt; pivot &amp;&amp; leftIndex &lt; right) &#123;</span><br><span class="line">        leftIndex++;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 右指针移动</span></span><br><span class="line">      <span class="keyword">while</span> (array[rightIndex] &gt; pivot &amp;&amp; rightIndex &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        rightIndex--;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (leftIndex &gt;= rightIndex) &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        swap(array, leftIndex, rightIndex);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    swap(array, leftIndex, right);</span><br><span class="line">    <span class="keyword">return</span> leftIndex;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> index1, <span class="keyword">int</span> index2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp = array[index1];</span><br><span class="line">    array[index1] = array[index2];</span><br><span class="line">    array[index2] = temp;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">72</span>, <span class="number">77</span>, <span class="number">48</span>, <span class="number">17</span>, <span class="number">71</span>, <span class="number">2</span>, <span class="number">25</span>, <span class="number">97</span>, <span class="number">82</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">18</span>, <span class="number">15</span>, <span class="number">57</span>, <span class="number">7</span>, <span class="number">48</span>, <span class="number">93</span>, <span class="number">47</span>, <span class="number">38</span>, <span class="number">74</span>, <span class="number">18</span>, <span class="number">93</span>, <span class="number">98</span>, <span class="number">41</span>, <span class="number">54</span>, <span class="number">4</span>, <span class="number">47</span>, <span class="number">4</span>, <span class="number">63</span>, <span class="number">76</span>&#125;;</span><br><span class="line">    System.out.println(<span class="string">"raw: "</span> + Arrays.toString(array));</span><br><span class="line">    <span class="comment">// 目标是倒数第 6 个元素</span></span><br><span class="line">    <span class="keyword">int</span> result = quickFind(array, array.length - <span class="number">6</span>);</span><br><span class="line">    System.out.println(<span class="string">"result: "</span> + result);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/07/28/day19/" data-id="ckdn9i6ng000kjwuxc096118x" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%92%E5%BD%92%E3%80%81%E5%88%86%E6%B2%BB%E6%80%9D%E6%83%B3-%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E3%80%81%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F%E3%80%81%E5%BF%AB%E9%80%9F%E9%80%89%E6%8B%A9/" rel="tag">递归、分治思想-归并排序、快速排序、快速选择</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-day18" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/28/day18/" class="article-date">
  <time datetime="2020-07-28T02:37:09.000Z" itemprop="datePublished">2020-07-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/28/day18/">day18</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h4><p><strong>原理</strong>：对于一个数组，每一次循环<strong>让最大的元素冒泡到最后面</strong>。</p>
<p><strong>核心规则</strong>：</p>
<p>1.指向数组中两个相邻的元素( 最开始是数组的头两个元素)，并組比较他们的大小。<br>2.如果前者比后者大，则交换他们的位置。<br>3.如果后者比前者大，则不交换。<br>4.然后依次后移,每次循环将最大元素移动最后一个位置。</p>
<p><strong>实战案例：</strong></p>
<p>假设有一个数组为9, 2, 4, 7, 5, 3，我们希望将其变成<strong>自小而大</strong>的排列。</p>
<p><strong>第 1 步</strong>：按照上面思路，我们先比较<strong>9，2</strong>两个元素</p>
<p><img src="https://style.youkeda.com/img/course/a1/4/1-step-1.svg" alt></p>
<p>​                                        因为9比2大，则交换它们的位置。</p>
<p><strong>第 2 步</strong>：我们继续比较<strong>9, 4</strong>两个元素</p>
<p><img src="https://style.youkeda.com/img/course/a1/4/1-step-2.svg" alt></p>
<p>​                                    因为<strong>9比4大</strong>，则继续交换它们的位置。</p>
<p>以此类推。<br><strong>第5步</strong>:<br>9已经被交换到了倒数第二 个位置，继续比较9和最后个元素3</p>
<p><img src="https://style.youkeda.com/img/course/a1/4/1-step-5.svg" alt></p>
<p>因为9比3大，则交换它们的位置，这时候通过一次遍历，我们已经找到数组中<strong>最大的元素9</strong>。</p>
<p>我们继续开始第二次的循环遍历，再次回到<strong>第一个和第二个元素。</strong><br><strong>第6步</strong>:开始第二次的循环遍历，先比较2和4两个元愫</p>
<p><img src="https://style.youkeda.com/img/course/a1/4/1-step-6.svg" alt></p>
<p><strong>第 7 步</strong>：比较4和7两个元素</p>
<p><img src="https://style.youkeda.com/img/course/a1/4/1-step-7.svg" alt></p>
<p><code>4</code>比<code>7</code>小，因此也不需要交换了。</p>
<p><strong>第 8 步</strong>：比较7和5两个元素</p>
<p><img src="https://style.youkeda.com/img/course/a1/4/1-step-8.svg" alt></p>
<p><code>7</code>比<code>5</code>大，因此需要交换<code>7</code>和<code>5</code>的位置。</p>
<p><strong>第 9 步</strong>：比较<strong>7和3</strong>两个元素</p>
<p><img src="https://style.youkeda.com/img/course/a1/4/1-step-9.svg" alt></p>
<p><strong>7比3大，</strong>因此需要交换7和3的位置，同时完成第二次遍历,我们已经找到数组中<strong>第二大</strong>的<br>元素7。接下来我们再利用<strong>4次循环</strong>遍历，就能将数组的所有元素按升序排好。</p>
<h4 id="代码实现："><a href="#代码实现：" class="headerlink" title="代码实现："></a>代码实现：</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sort</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 冒泡排序</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 每次循环，都能冒泡出剩余元素中最大的元素，因此需要循环 array.length 次</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">      <span class="comment">// 每次遍历，只需要遍历 0 到 array.length - i - 1中元素，因此之后的元素都已经是最大的了</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; array.length - i - <span class="number">1</span>; j++) &#123;</span><br><span class="line">        <span class="comment">// 交换元素</span></span><br><span class="line">        <span class="keyword">if</span> (array[j] &gt; array[j + <span class="number">1</span>]) &#123;</span><br><span class="line">          <span class="keyword">int</span> temp = array[j + <span class="number">1</span>];</span><br><span class="line">          array[j + <span class="number">1</span>] = array[j];</span><br><span class="line">          array[j] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">9</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="comment">// Arrays.toString 可以方便打印数组内容</span></span><br><span class="line">    System.out.println(Arrays.toString(array));</span><br><span class="line">    bubbleSort(array);</span><br><span class="line">    System.out.println(Arrays.toString(array));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>第一处注释</strong>：我们知道每次冒泡，都能得到其中<strong>最大</strong>的元素，因此如果要将整个数组都排好序，需要冒泡<strong>数组个数</strong>次</p>
<p><strong>第二处</strong>：特别注意结束条件，array.length - i - 1。第一次遍历需要到数组结束为止，这时候已经得到最大元素9，并且放在数组末尾。第二次只需要遍历到倒数第二个元素即可。</p>
<p><strong>第三次</strong>：如何交换数组中的两个元素呢？这是最常用的思路</p>
<p><img src="https://style.youkeda.com/img/course/a1/4/1-swap.svg" alt></p>
<p>1.用临时变量存储第一个变量值<br>2.将第二个变量赋值给第一个变量<br>3.将临时变量赋值给第二个变量</p>
<p>最终我们可以看到排序以后的结果，从代码中我们比较的次数为:<br><strong>N+(N-1)+…+2+1=(N^2 +N) / 2</strong><br>最坏的情况下每次比较都需要交换，交换的次数也<br>为(<strong>N^2+N)/2</strong>所以整体的步数介于(N^2+ N)/2和(N^2+ N)<br>之间。❷.大0记法，最终的结果为<strong>0(N^2)</strong>。</p>
<h2 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h2><p><strong>定义</strong>：重点在<strong>选择</strong>，每次在剩余数组中，选择<strong>最大或者最小的一<em>个*</em></strong>，放在数组的一端。</p>
<p>核心规则有 4 点：</p>
<p>1.利用两个变量，一个存储当前<strong>最大值</strong>，一个存储当前<strong>最大值所在的索引</strong>。.<br>2.依次比较后面的元素，如果发现比<strong>当前最大值大</strong>,则更新最大值， 并且更新最大值所在的索引。<br>3.直到遍历结束，将最大值放在数组的最右边，也就是<strong>交换最右边元素和当前最大值元素</strong>。<br>4.重复上面的步骤</p>
<p><strong>实战案例：</strong></p>
<p>我们同样以冒泡排序实战案例作为例子，大家<strong>一定要一步步的跟随</strong>下面的步骤：</p>
<p><strong>我们来看第一次遍历：</strong></p>
<p><img src="https://style.youkeda.com/img/course/a1/4/2-step-1.svg" alt></p>
<p>我们运气非常不错，第一次就查到最大元素<strong>9</strong>，并记录最大元素索引位置为<strong>0</strong>。 </p>
<p>直到扫描结束，替换最后一个元素3和第 0 个元素9。</p>
<p><strong>到此位置，我们已经选择到最大元素 9。</strong></p>
<p><strong>第二次遍历</strong></p>
<p><img src="https://style.youkeda.com/img/course/a1/4/2-step-2.svg" alt></p>
<p>我们在第二次遍历的时候，不是那么顺利，我们依次找到的最大值和索引为</p>
<p>// 最大值，索引<br>3，0<br>3，0<br>4，2<br>7，2<br>7，2</p>
<p>扫描结束后，替换倒数第二个元素<strong>5</strong>和索引<strong>2</strong>的<br>值。<br><strong>时间复杂度</strong><br>时间复杂度和冒泡排序一样，执行次数如下<br><strong>N +(N-1)+…+2+1</strong><br>最终的结果为<strong>0(N^2)。</strong></p>
<p><strong>冒泡排序vs选择排序</strong><br>虽然我们都在说两个排序算法的时间复杂度都为<br><strong>0(N^2)</strong>，但很明显能感受到<strong>选择排序更快一点点</strong>。<br>为什么?<br><strong>冒泡需要频繁的交换相邻两个元素，而选择排序</strong><br><strong>每次遍历只需要交换一次,所以选择排序真实情</strong><br><strong>况速度比冒泡排序快- -倍</strong>。❹</p>
<p>案例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sort</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 选择排序</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">selectSort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">		<span class="keyword">int</span> min=i;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;array.length;j++) &#123;</span><br><span class="line">			<span class="keyword">if</span>(array[j]&lt;array[min]) &#123;</span><br><span class="line">				min=j;	<span class="comment">//取到最小值的下标</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//将最小值与第i+1个的值进行交换.使最小值放入指定位置</span></span><br><span class="line">		<span class="keyword">int</span> b=array[i];</span><br><span class="line">		array[i]=array[min];</span><br><span class="line">		array[min]=b;</span><br><span class="line">	&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">9</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="comment">// Arrays.toString 可以方便打印数组内容</span></span><br><span class="line">    System.out.println(Arrays.toString(array));</span><br><span class="line">    selectSort(array);</span><br><span class="line">    System.out.println(Arrays.toString(array));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h2><p>什么是插入排序?<br>重点在<strong>插入</strong>，每次抽离一个元素 当做临时元素,依次比较和移动之后的其他元素，最终将这个临<br>时元素插入对应的位置。</p>
<p>核心规则有4点:<br><strong>1.在第一轮，抽离数组末尾倒数第二个元素，作为临</strong><br><strong>时元素。</strong><br><strong>2.用临时元素与数组后面的元素进行对比，如果后面</strong><br><strong>的元素值小于临时元素,则左移。</strong><br><strong>3.如果后面的元素大于临时元素，或者已经移动到数</strong><br><strong>组末尾，则将临时元素插入当前的空隙中。</strong><br><strong>4.重复上面步骤，完成排序。</strong></p>
<p>此处的核心逻辑已经不是选择最大元素了，而是通过每次迭代，将部分元素排好序，以达到最终<br>全部排序的效果。</p>
<p>实战案例</p>
<p>我们同样以冒泡排序实战案例作为例子，大家-定<br>要一步步的跟随下面的步骤:</p>
<p>第一次迭代：</p>
<p><img src="https://style.youkeda.com/img/course/a1/4/3-step-1.svg" alt></p>
<p>(1)首先选中倒数第二 个元素5作为临时元素。<br>(2)依次与后面的元素进行对比，5 比3大,将3左移一个。<br>(3) 已经到达数组末尾，直接将5插入</p>
<p><strong>第二次迭代：</strong></p>
<p><img src="https://style.youkeda.com/img/course/a1/4/3-step-2.svg" alt></p>
<p>(1) 首先选中倒数第三个元素7作为临时元素。<br>(2)依次与后面的元素进行对此，7比3大,将3左移一个。<br>(3)7比5大，将5左移一个。<br>(4) 已经到达数组末尾，直接将7插入</p>
<p><strong>第三次迭代：</strong></p>
<p><img src="https://style.youkeda.com/img/course/a1/4/3-step-3.svg" alt></p>
<p>(1) 首先选中倒数第三个元素4作为临时元素。<br>(2)依次与后面的元素进行对此，4比3大,将3左移一个。<br>(3)  4比5小，直接将4插入当前空隙位置。<br>每次迭代，都将<strong>末尾部分数字排好序</strong>。</p>
<h4 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h4><p>那时间复杂度是多少呢?我们先来考虑最好和最坏的两种情况。<br><strong>最好的情况</strong><br>如果所有的数组元素本身就是升序排列，我们<strong>每次</strong><br><strong>迭代不需要进行移动</strong>，所以时间复杂度是0(N)<br><strong>最坏的情况</strong><br>如果所以的数组元素都是按降序排列，我们<strong>每次迭</strong><br><strong>代每次比较都需要移动</strong>，在这种情况下。比较的步数为0((N^2 + N) / 2)，移动的步数为.<br>0((N^2 + N) /2)。因此最差的情况为0(N^2 + N)，忽略常数为0(N^2)</p>
<p><strong>冒泡排序vs选择排序vs插入排序</strong><br>那问题来了，冒泡排序，选择排序，插入排序到底<br>孰胜孰劣?<br>冒泡排序相比较而言肯定是较差的。<br>选择排序和插入排序得分情况而定，<strong>如果原始数</strong><br><strong>组本身有很多元素按希望的顺序排好序,则选择</strong><br><strong>插入排序</strong>(如_上面最好极限情况，接近0(N)),否<br>则选择选择排序。<br>所以在实际场景中，我们需要根据真实数据特性,<br>选择对应的算法进行解决。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sort</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 插入排序</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertSort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">int</span> len;</span><br><span class="line">    <span class="comment">// 基本情况下的数组可以直接返回</span></span><br><span class="line">     <span class="keyword">if</span>(array == <span class="keyword">null</span> || (len = array.length) == <span class="number">0</span> || len == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> current;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// 第一个数默认已排序，从第二个数开始</span></span><br><span class="line">        current = array[i + <span class="number">1</span>];</span><br><span class="line">        <span class="comment">// 前一个数的下标</span></span><br><span class="line">        <span class="keyword">int</span> preIdx = i;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// 拿当前的数与之前已排序序列逐一往前比较，</span></span><br><span class="line">        <span class="comment">// 如果比较的数据比当前的大，就把该数往后挪一步</span></span><br><span class="line">        <span class="keyword">while</span> (preIdx &gt;= <span class="number">0</span> &amp;&amp; current &lt; array[preIdx]) &#123;</span><br><span class="line">            array[preIdx + <span class="number">1</span>] = array[preIdx];</span><br><span class="line">            preIdx--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// while循环跳出说明找到了位置</span></span><br><span class="line">        array[preIdx + <span class="number">1</span>] = current;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">9</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="comment">// Arrays.toString 可以方便打印数组内容</span></span><br><span class="line">    System.out.println(Arrays.toString(array));</span><br><span class="line">    insertSort(array);</span><br><span class="line">    System.out.println(Arrays.toString(array));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二分插入排序"><a href="#二分插入排序" class="headerlink" title="二分插入排序"></a>二分插入排序</h2><p>我们再次来深入理解下插入排序的算法规则!最核心的逻辑是查找应该插入的临时元素位置,类<br>似于<strong>在一个有序数组中查询，找到元素应该插入的位置</strong>。</p>
<p>  如图所示：</p>
<p><img src="https://style.youkeda.com/img/course/a1/4/4-1.svg" alt></p>
<p>第二次迭代，相当于在第一次迭代结果<strong>[3,5]</strong>中寻.找<strong>7</strong>应该插入的位置。第三次迭代，相当于在第二次迭代结果<strong>[3,5,7]</strong>中寻找<strong>4</strong>应该插入的位置。有没有感觉似曾相识,对于这种有列表，我们知道循环遍历并不是最优解，还有-个更好的方法二分查找法。因此，将插入排序和二分查找法结合一起可以进一步提高排序效率。</p>
<p><strong>二分插入法：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sort</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 查找应该插入的索引位置</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">searchIndex</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> left, <span class="keyword">int</span> right, <span class="keyword">int</span> aim)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 循环查找节点位置</span></span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">      <span class="keyword">int</span> middle = (left + right) / <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">int</span> value = array[middle];</span><br><span class="line">      <span class="keyword">if</span> (value &lt; aim) &#123;</span><br><span class="line">        left = middle + <span class="number">1</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        right = middle - <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果最终元素仍然大于目标元素，则将索引位置往左边移动一个</span></span><br><span class="line">    <span class="keyword">if</span>(array[left] &gt; aim)&#123;</span><br><span class="line">      <span class="keyword">return</span> left -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 否则就是当前位置</span></span><br><span class="line">    <span class="keyword">return</span> left;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 插入排序</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertSort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 从倒数第二位开始，遍历到底0位，遍历 N-1 次</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = array.length - <span class="number">2</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">      <span class="comment">// 存储当前抽离的元素</span></span><br><span class="line">      <span class="keyword">int</span> temp = array[i];</span><br><span class="line">      <span class="keyword">int</span> index = searchIndex(array, i + <span class="number">1</span>, array.length - <span class="number">1</span>, temp);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 根据插入的索引位置，进行数组的移动和插入</span></span><br><span class="line">      <span class="keyword">int</span> j = i + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">while</span> (j &lt;= index) &#123;</span><br><span class="line">        array[j - <span class="number">1</span>] = array[j];</span><br><span class="line">        j++;</span><br><span class="line">      &#125;</span><br><span class="line">      array[j - <span class="number">1</span>] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">9</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="comment">// Arrays.toString 可以方便打印数组内容</span></span><br><span class="line">    System.out.println(Arrays.toString(array));</span><br><span class="line">    insertSort(array);</span><br><span class="line">    System.out.println(Arrays.toString(array));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/07/28/day18/" data-id="ckdn9i6nf000ijwux4l25eebz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F%E3%80%81%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E3%80%81%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E3%80%81%E4%BA%8C%E5%88%86%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/" rel="tag">冒泡排序、选择排序、插入排序、二分插入排序</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-day17-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/26/day17-2/" class="article-date">
  <time datetime="2020-07-26T06:28:54.000Z" itemprop="datePublished">2020-07-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/26/day17-2/">day17-2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="有序数组查找"><a href="#有序数组查找" class="headerlink" title="有序数组查找"></a>有序数组查找</h2><p>什么叫做<strong>有序数组</strong>?<br>如果一个数组中的值是按一 定顺序进行排列的,我们就称为有序数组。<br> 比如数组**    [2， 3，22，75，80，90，100]，本节课以这个数组为例。<br>我们希望完成一个函数,查找某个数字是否存在数组中。例如: .</p>
<p>22存在数组中，引值是2<br>50不存在数组中</p>
<p>有没有发现这个问题和<strong>猜数字游戏</strong>非常相似，本节课开始我们将不再基于理论进<br>行讨论，我们开始写代码了。</p>
<h4 id="线性查找"><a href="#线性查找" class="headerlink" title="线性查找"></a>线性查找</h4><p>同样我们给出最粗暴的解决方案，依次遍历整个数组，判断给定的数字是否存<br>在。</p>
<p><img src="https://style.youkeda.com/img/course/a1/2/2-4-1.svg" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Find</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> aim)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (aim == array[i]) &#123;</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">22</span>, <span class="number">75</span>, <span class="number">80</span>, <span class="number">90</span>, <span class="number">100</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> result1 = find(array, <span class="number">22</span>);</span><br><span class="line">    <span class="keyword">if</span> (result1 == -<span class="number">1</span>) &#123;</span><br><span class="line">      System.out.println(<span class="string">"22 不存在数组中"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      System.out.println(<span class="string">"22 存在数组中，索引值是 "</span> + result1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> result2 = find(array, <span class="number">50</span>);</span><br><span class="line">    <span class="keyword">if</span> (result2 == -<span class="number">1</span>) &#123;</span><br><span class="line">      System.out.println(<span class="string">"50 不存在数组中"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      System.out.println(<span class="string">"50 存在数组中，索引值是 "</span> + result2);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们知道这种查找方法的时间复杂度为:  <strong>0(N)</strong>。<br>那有没有更快的查找办法呢?当然是有的，比如:<strong>二分查找法</strong>。</p>
<h4 id="二分查找法"><a href="#二分查找法" class="headerlink" title="二分查找法"></a>二分查找法</h4><p>和猜数字游戏类似，因为数组是有序的，我们可以<strong>先比对中间索引值</strong>，再来缩小<br>查找的范围。➊</p>
<p><img src="https://style.youkeda.com/img/course/a1/2/2-4-2.svg" alt></p>
<p>如图所示，我们只需要通过3步就能找到对应的元素。那话说回来了，图大家都看的懂,那代码怎么写呢?思考一下，有一个关键问题:<strong>怎么能让数组缩小呢?</strong> </p>
<p>为了不破坏原数组(因为原数组，可能还会在其他地方使用)。我们定义两个量left, right分别表示数组可筛选区域左侧和右侧的引(下标)</p>
<p>代码如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Find</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span>[] array, <span class="keyword">int</span> aim)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 初始化left = 最左侧, right = 最右侧</span></span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> right = array.length;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 当left &gt; right则表示遍历完成</span></span><br><span class="line">    <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">      <span class="comment">// 获取中间的值</span></span><br><span class="line">      <span class="keyword">int</span> middle = (left + right) / <span class="number">2</span>;</span><br><span class="line">      <span class="keyword">int</span> middleValue = array[middle];</span><br><span class="line">      <span class="keyword">if</span> (middleValue == aim) &#123;</span><br><span class="line">        <span class="comment">// 已经找到目标</span></span><br><span class="line">        <span class="keyword">return</span> middle;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (middleValue &lt; aim) &#123;</span><br><span class="line">        <span class="comment">// 目标在middle的右侧，重置left</span></span><br><span class="line">        left = middle + <span class="number">1</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 目标在middle的左侧，重置right</span></span><br><span class="line">        right = middle - <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">22</span>, <span class="number">75</span>, <span class="number">80</span>, <span class="number">90</span>, <span class="number">100</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> result1 = find(array, <span class="number">22</span>);</span><br><span class="line">    <span class="keyword">if</span> (result1 == -<span class="number">1</span>) &#123;</span><br><span class="line">      System.out.println(<span class="string">"22 不存在数组中"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;midd</span><br><span class="line">      System.out.println(<span class="string">"22 存在数组中，索引值是 "</span> + result1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> result2 = find(array, <span class="number">50</span>);</span><br><span class="line">    <span class="keyword">if</span> (result2 == -<span class="number">1</span>) &#123;</span><br><span class="line">      System.out.println(<span class="string">"50 不存在数组中"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      System.out.println(<span class="string">"50 存在数组中，索引值是 "</span> + result2);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="性能优化小案例-二分法查找"><a href="#性能优化小案例-二分法查找" class="headerlink" title="性能优化小案例 - 二分法查找"></a>性能优化小案例 - 二分法查找</h4><p>通讯录里有十个人，分别是：</p>
<p>[<br>  “Allen”,<br>  “Emma”,<br>  “James”,<br>  “Jeanne”,<br>  “Kelly”,<br>  “Kevin”,<br>  “Mary”,<br>  “Natasha”,<br>  “Olivia”,<br>  “Rose”<br>]</p>
<p>小提示：<br>在Java中可以使用<strong>String</strong>对象<strong>compareTo</strong>方法比.较字符串的先后顺序，语法规则为。<br>str1. compareTo(str2)结果如果是<strong>负数</strong>则表示 str1排序在str2前面。如果用Kelly和Kevin进行比较，案例如下:<br>         “Kelly”. compareTo(“Kevin”) // 结果为-10<br>         “Kevin”. compareTo(“Kelly”) // 结果为10<br>      从结果，我们知道Kelly排序在Kevin前面。</p>
<h6 id="代码："><a href="#代码：" class="headerlink" title="代码："></a>代码：</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(ArrayList&lt;String&gt; array, String aim)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 初始化left = 最左侧, right = 最右侧</span></span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> right = array.size();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 当left &gt; right则表示遍历完成</span></span><br><span class="line">    <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">      <span class="comment">// 获取中间的值</span></span><br><span class="line">      <span class="keyword">int</span> middle = (left + right) / <span class="number">2</span>;</span><br><span class="line">      String  middleValue = array.get(middle);</span><br><span class="line">      <span class="keyword">if</span> (middleValue.equals(aim)) &#123;</span><br><span class="line">        <span class="comment">// 已经找到目标</span></span><br><span class="line">        <span class="keyword">return</span> middle;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (middleValue.compareTo(aim) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 目标在middle的左侧，重置right</span></span><br><span class="line">        right = middle - <span class="number">1</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 目标在middle的you侧，重置right</span></span><br><span class="line">        left= middle+<span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ArrayList&lt;String&gt; array = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    array.add(<span class="string">"Allen"</span>);</span><br><span class="line">    array.add(<span class="string">"Emma"</span>);</span><br><span class="line">    array.add(<span class="string">"James"</span>);</span><br><span class="line">    array.add(<span class="string">"Jeanne"</span>);</span><br><span class="line">    array.add(<span class="string">"Kelly"</span>);</span><br><span class="line">    array.add(<span class="string">"Kevin"</span>);</span><br><span class="line">    array.add(<span class="string">"Mary"</span>);</span><br><span class="line">    array.add(<span class="string">"Natasha"</span>);</span><br><span class="line">    array.add(<span class="string">"Olivia"</span>);</span><br><span class="line">    array.add(<span class="string">"Rose"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> result1 = find(array, <span class="string">"Kelly"</span>);</span><br><span class="line">    <span class="keyword">if</span> (result1 == -<span class="number">1</span>) &#123;</span><br><span class="line">      System.out.println(<span class="string">"Kelly 不存在名单中"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      System.out.println(<span class="string">"Kelly 存在名单中，位置是 "</span> + result1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> result2 = find(array, <span class="string">"Edith"</span>);</span><br><span class="line">    <span class="keyword">if</span> (result2 == -<span class="number">1</span>) &#123;</span><br><span class="line">      System.out.println(<span class="string">"Edith 不存在名单中"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      System.out.println(<span class="string">"Edith 存在名单中，位置是 "</span> + result2);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="性能优化案例-二次问题"><a href="#性能优化案例-二次问题" class="headerlink" title="性能优化案例- 二次问题"></a>性能优化案例- 二次问题</h2><p>假定一个数字数组，数组里面每个数字介于0-10之间，请找出里面的重复数字。</p>
<p>案例： </p>
<p>数字数组为：[0, 8, 2, 3, 5, 6, 2, 10, 8]</p>
<p>重复数字为：[8, 2]</p>
<h4 id="暴力破解法"><a href="#暴力破解法" class="headerlink" title="暴力破解法"></a>暴力破解法</h4><p>每次获取一个元素，依次判断这个元素和之后的元素是否由重复，图示如下：</p>
<p><img src="https://style.youkeda.com/img/course/a1/2/2-5-1.svg" alt></p>
<p>第一步，我们选择第一个元素0，判断与后面7各元素是否相同。</p>
<p>第二步，我们选择第二个元素8，判断与后面6各元素是否相同。</p>
<p>以此类推。。。。。。</p>
<p><strong>完善代码</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Second</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;Integer&gt; <span class="title">repeat</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</span><br><span class="line">    ArrayList&lt;Integer&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++)&#123;</span><br><span class="line">      <span class="comment">// 以此判断i位置元素和后面j位置元素是否相等</span></span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; array.length; j++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(array[i] == array[j])&#123;</span><br><span class="line">          result.add(array[i]);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">0</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">8</span>&#125;;</span><br><span class="line">    System.out.println(repeat(array));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="标记法"><a href="#标记法" class="headerlink" title="标记法"></a>标记法</h4><p>假设给定一个数字数组，数组里面<strong>每个数字介于 0 - 10 之间</strong>，请找出里面<strong>重复</strong>的数字</p>
<p>从这个题目要求我们知道数组里面每个数字都是<strong>介于 0 - 10 之间</strong>。 我们是否可以先用<strong>11 长度的数组来标记 0 - 10 这 11 个数字是否存在；空 表示不存在，1 表示存在</strong></p>
<p>如下图所示：</p>
<p><img src="https://style.youkeda.com/img/course/a1/2/2-5-6.svg" alt></p>
<p>假设现在有一个数组为 0，2，3 ，那么exists数组中索引0，2，3位置会被标记成1.</p>
<p><strong>如何判断重复呢？</strong> </p>
<p>我们知道，一旦出一个数字就将exists对应索引位置的值设置为1.下次如果遇到对应的位置已经为1，则表示 重复了。</p>
<p>步骤：</p>
<h5 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h5><p><img src="https://style.youkeda.com/img/course/a1/2/2-5-2.svg" alt></p>
<p>我们首先申请一个数组，数组名称为exists， 表示数字是否存在。</p>
<p>数组的长度为11，并且数组里面的值默认都为0，表示0~10这11各数默认都不存在。</p>
<h5 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a>第一步</h5><p><img src="https://style.youkeda.com/img/course/a1/2/2-5-3.svg" alt></p>
<p>第一步我们扫描到数字0，因此我们将exists数组中索引值为0的数字设置为1.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exists[<span class="number">0</span>] = <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h5 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h5><p><img src="https://style.youkeda.com/img/course/a1/2/2-5-4.svg" alt></p>
<p>第二步，我们扫描到数字8，因此我们将exists数组中的索引值为8的数字设置为1.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exists[<span class="number">8</span>] = <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h5 id="以此类推"><a href="#以此类推" class="headerlink" title="以此类推"></a>以此类推</h5><h6 id="第六步"><a href="#第六步" class="headerlink" title="第六步"></a>第六步</h6><p>第六步的时候，我们的exists数组 0，2，3，5，8 索引位置已经设置为1.</p>
<p><img src="https://style.youkeda.com/img/course/a1/2/2-5-5.svg" alt></p>
<p>我们扫描到原始数组第六位为2，我们发现exists数组中索引为2 的位置为1了，所以我们知道2这个数字重复了。</p>
<h5 id="代码完善"><a href="#代码完善" class="headerlink" title="代码完善"></a>代码完善</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Second</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;Integer&gt; <span class="title">repeat</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</span><br><span class="line">    ArrayList&lt;Integer&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">int</span>[] exists = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">11</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">      <span class="keyword">int</span> value = array[i];</span><br><span class="line">        <span class="comment">// 将Array中的值存入exisets中</span></span><br><span class="line">      <span class="comment">// 如果当前位置已经为1，则表示重复</span></span><br><span class="line">      <span class="keyword">if</span> (exists[value] == <span class="number">1</span><span class="comment">// 有存在的值，再将值存入exists中去可知谁重复了) &#123;</span></span><br><span class="line">        result.add(value);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 否则将当前位置设置为1</span></span><br><span class="line">        exists[value] = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] array = &#123;<span class="number">0</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">8</span>&#125;;</span><br><span class="line">    System.out.println(repeat(array));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从代码可以看出，一次循环就能完成题目要求，所以时间复杂度为** 0（N）。**</p>
<p>有同学可能会问，那不是多声明了<strong>exists</strong> 一段空间么？ 空间复杂度不是提高了吗？</p>
<p>这其实是<strong>空间换时间</strong>的经典案例。我们在之前提到过，在编程中除非特殊情况，我们只考虑时间复杂度，忽略空间复杂度</p>
<h4 id="例题："><a href="#例题：" class="headerlink" title="例题："></a>例题：</h4><p>给定一个字符串，例如   “abcdkioudofanzdfpqwe”    ，请找出字符串中重复<br>的字符。<br>为了简化题目,我们约定字符串里面的字符全是小写,介于    a-z 。<br>请使用标记法，时间复杂度为0(N)，完成题目要求，最终输出的结果<br>为:<br>     [d,o，a,d,f]<br>需要大家在标记法思维上稍加一点灵活性，请仔细阅读下面的2个小提<br>示。</p>
<h6 id="小提示"><a href="#小提示" class="headerlink" title="小提示"></a>小提示</h6><p>一、字符串获取字符<br>在Java中，字符串可以通过索引值，获取到对应的字符。<br>string str = “ abcdk ioudof anzdfpqwe”;<br>str.charAt(0) //<br>‘a’<br>str.charAt(3) // ‘d’</p>
<h6 id="二、ASCII编码"><a href="#二、ASCII编码" class="headerlink" title="二、ASCII编码"></a>二、ASCII编码</h6><p>ASCII码<br>大家可以简单了解一下ASCII码的文档,通过文档我们知道a对应的<br>的ASCII为97，并且b,C,d依次递增为98、99、100<br>所以我们可以得出以下结论o<br>b-a=1</p>
<p>c-a=2</p>
<p>d-a=3</p>
<p>因此，如果我们将a标记在  <strong>exists 数组</strong>的索引0的位置，那么b对应<br>的索引为1。➊</p>
<h5 id="代码：-1"><a href="#代码：-1" class="headerlink" title="代码："></a>代码：</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Second</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;Character&gt; <span class="title">repeat</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">    ArrayList&lt;Character&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">int</span>[] exists = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">26</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">      <span class="keyword">char</span> c = str.charAt(i);</span><br><span class="line">      <span class="keyword">if</span> (exists[c - <span class="string">'a'</span>] == <span class="number">1</span>) &#123;</span><br><span class="line">        result.add(c);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        exists[c - <span class="string">'a'</span>] = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String str = <span class="string">"abcdkioudofanzdfpqwe"</span>;</span><br><span class="line">    System.out.println(repeat(str));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="计算机内存管理"><a href="#计算机内存管理" class="headerlink" title="计算机内存管理"></a>计算机内存管理</h2><h4 id="内存的工作原理"><a href="#内存的工作原理" class="headerlink" title="内存的工作原理"></a>内存的工作原理</h4><p>我们可以简单的将内存当作寄存柜</p>
<p><img src="https://style.youkeda.com/img/course/a1/3/1.jpg" alt></p>
<p>假设我们去游泳，需要将东西先<strong>寄存</strong>起来，寄存处有几个大箱子，每个箱子都有很多抽屉。<br>每个抽屉里可以放一样东西，如果你有4样东西，就需要放在4个抽屉里。每个抽屉都有自己的编号，方便你查找和记录。接下来，你就去游泳了，当你结束的时候，再将4个抽屉里面的东西带走。</p>
<p>这其实就是计算机内存的工作原理。</p>
<p>每个抽屉，都可以当做内存的一个<strong>存储单元</strong>，而抽屉编号可以当做每个存储单元的<strong>内存地址</strong></p>
<p><img src="https://style.youkeda.com/img/course/a1/3/1-1.svg" alt></p>
<p><strong>为什么连续两个方格内存地址差 8？</strong></p>
<p>因为我们现在电脑基本是 <strong>64</strong> 位，64 位表示内存存储最小使用单位为 <strong>64 个 bit</strong>，也就是 <strong>8 个 byte</strong> </p>
<h2 id="数组-存储和读取"><a href="#数组-存储和读取" class="headerlink" title="数组-存储和读取"></a>数组-存储和读取</h2><h3 id="数组存储"><a href="#数组存储" class="headerlink" title="数组存储"></a>数组存储</h3><p><strong>定义：</strong>数组（Array）是一种<strong>线性表数据结构</strong>。它用一组连续的内存空间，来存储一组具有<strong>相同类型的数据</strong>。</p>
<p><strong>线性数据结构</strong>:表示数组中数据都是按前后这种线性顺序排列的。<br><strong>相同数据类型</strong>:数组中的每个值的数据类型都相同。</p>
<p><img src="https://style.youkeda.com/img/course/a1/3/1-1-5.svg" alt></p>
<h4 id="数组读取"><a href="#数组读取" class="headerlink" title="数组读取"></a>数组读取</h4><p>每个数组都有对应的内存地址，我们将其称作为数组开始地址—<br><strong>start_ address</strong>。<br>数组在定义的时候，已经确定每个数组元素的<strong>数据类型</strong>了，也就是我们知<br>道每个元素需要的内存空间大小，我们称为— <strong>item_ size。</strong></p>
<p><img src="https://style.youkeda.com/img/course/a1/3/1-1-4.svg" alt></p>
<p>那么数组里每个元素内存地址都能被计算出来:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一个元素地址</span></span><br><span class="line">start_address</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二个元素地址</span></span><br><span class="line">start_address + item_size * <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第三个元素地址</span></span><br><span class="line">start_address + item_size * <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>第 N 个元素地址公式如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第N个元素地址</span></span><br><span class="line">start_address + item_size * (N - <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>从这个公式我们可以得到两点信息<br><strong>1.时间复杂度</strong><br>数组的索引|访问的时间复杂度是<strong>0(1)</strong><br><strong>2.为什么数组索引从0开始?</strong><br>内存地址的计算规则决定开始地址为   start_ address + item_ size*0，在计算机中为了方便位置的计算,<br>所以数组索引从0开始。➊</p>
<h4 id="例题：-1"><a href="#例题：-1" class="headerlink" title="例题："></a>例题：</h4><p>我们知道在Java中有一种是数据结构叫做Arraylist，我告诉大家它的.底层就是，用数组实现的。那我们来试试如何一步步用数组实现-个我们自定义的<strong>list,YKDArrayLis</strong>t右侧已经给大家建好的<strong>YKDArraylist</strong>类，下面需要大家完善<strong>size</strong>,<strong>get</strong>两个函数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YKDArrayList</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 此处需要声明一个数组，作为底层存储</span></span><br><span class="line">  <span class="keyword">int</span>[] array = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">20</span>];</span><br><span class="line">  <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">YKDArrayList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//因为还未学习插入，所以暂时内置数据</span></span><br><span class="line">    <span class="keyword">this</span>.array[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">this</span>.array[<span class="number">1</span>] = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">this</span>.array[<span class="number">2</span>] = <span class="number">30</span>;</span><br><span class="line">    <span class="keyword">this</span>.size = <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取数组的长度</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.size();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数组获取某个索引值</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span>  <span class="keyword">this</span>.array[index];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    YKDArrayList arrayList = <span class="keyword">new</span> YKDArrayList();</span><br><span class="line">    System.out.println(arrayList.get(<span class="number">0</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="数组插入"><a href="#数组插入" class="headerlink" title="数组插入"></a>数组插入</h2><p>往数组里面插入一个元素的速度，取决于你需要把它插入到哪个位置上。</p>
<p>假设我们在为周末的事情做规划，现在暂定规划如下</p>
<p>eat breakfast  // 吃早饭<br>shopping       // 购物<br>have lunch     // 吃午饭<br>have dinner    // 吃晚饭</p>
<p>如果把<strong>安排</strong>设置一个类，我们预留明天 20 个任务，那么代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Schedule</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  String[] array = <span class="keyword">new</span> String[<span class="number">20</span>];</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Schedule</span><span class="params">()</span></span>&#123;</span><br><span class="line">    array[<span class="number">0</span>] = <span class="string">"eat breakfirst"</span>;</span><br><span class="line">    array[<span class="number">1</span>] = <span class="string">"shopping"</span>;</span><br><span class="line">    array[<span class="number">2</span>] = <span class="string">"have lunch"</span>;</span><br><span class="line">    array[<span class="number">3</span>] = <span class="string">"have dinner"</span>;</span><br><span class="line">    <span class="keyword">this</span>.size = <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(String task)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.array[<span class="keyword">this</span>.size] = task;</span><br><span class="line">    <span class="keyword">this</span>.size++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.size; i++)&#123;</span><br><span class="line">      System.out.print(<span class="keyword">this</span>.array[i] + <span class="string">" --&gt; "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Schedule schedule = <span class="keyword">new</span> Schedule();</span><br><span class="line">    schedule.print();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="尾部插入"><a href="#尾部插入" class="headerlink" title="尾部插入"></a>尾部插入</h3><p>现在我们突然想在吃完饭之后去看场电影(watchmovie)， 我们怎么处理呢?通过之前的学习，对于每个数组，我们都清楚它的开头的内存地址，也知道数组包含多少个元素，每个元素占用的内存大小是多少。所以在尾部插入元素很容易计算，尾部插入元素内存地址为：</p>
<p>start_address + item_size * n  // n 为当前数组的个数</p>
<p><img src="https://style.youkeda.com/img/course/a1/3/3-1.svg" alt></p>
<p>一步即可实现，代码为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Schedule</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  String[] array = <span class="keyword">new</span> String[<span class="number">20</span>];</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Schedule</span><span class="params">()</span></span>&#123;</span><br><span class="line">    array[<span class="number">0</span>] = <span class="string">"eat breakfirst"</span>;</span><br><span class="line">    array[<span class="number">1</span>] = <span class="string">"shopping"</span>;</span><br><span class="line">    array[<span class="number">2</span>] = <span class="string">"have lunch"</span>;</span><br><span class="line">    array[<span class="number">3</span>] = <span class="string">"have dinner"</span>;</span><br><span class="line">    <span class="keyword">this</span>.size = <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 末尾插入</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(String task)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.array[<span class="keyword">this</span>.size] = task;</span><br><span class="line">    <span class="keyword">this</span>.size++;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.size; i++) &#123;</span><br><span class="line">      System.out.print(<span class="keyword">this</span>.array[i] + <span class="string">" --&gt; "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Schedule schedule = <span class="keyword">new</span> Schedule();</span><br><span class="line">    schedule.add(<span class="string">"watch movie"</span>);</span><br><span class="line">    schedule.print();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="中间插入"><a href="#中间插入" class="headerlink" title="中间插入"></a>中间插入</h4><p>那如果希望在下午吃了午饭后，喝一个下午茶（afternoon tea），那应该怎么处理呢？</p>
<p><img src="https://style.youkeda.com/img/course/a1/3/3-2.svg" alt></p>
<p>我们知道，需要在数组中间部分插入数据，但是为了<strong>保证数组的顺序和连续的内存空间，</strong>插入地方后<br>面部分数据，需要往后依次移动，如图所示:</p>
<p><img src="https://style.youkeda.com/img/course/a1/3/3-3.svg" alt></p>
<p>一共需要几步呢?<br>1.移动<strong>watch movie</strong><br>2.移动<strong>have dinner</strong><br>3.插入| <strong>afternoon tea</strong><br>需要3步操作，我们可以思考一下，如果插入在开始地方，需要几步呢?对的<strong>N</strong>步。<br>因此平均步数为<strong>(1+2+3+…+N)/N</strong>最终时间复杂度为<strong>0(N)</strong>，也就是数组的插入时间复杂度<br>为线性时间复杂度。。那如何用代码实现呢?我们新增一个<strong>insert3Position</strong>在索引位置为3的地方,插入一项任务。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Schedule</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  String[] array = <span class="keyword">new</span> String[<span class="number">20</span>];</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Schedule</span><span class="params">()</span></span>&#123;</span><br><span class="line">    array[<span class="number">0</span>] = <span class="string">"eat breakfirst"</span>;</span><br><span class="line">    array[<span class="number">1</span>] = <span class="string">"shopping"</span>;</span><br><span class="line">    array[<span class="number">2</span>] = <span class="string">"have lunch"</span>;</span><br><span class="line">    array[<span class="number">3</span>] = <span class="string">"have dinner"</span>;</span><br><span class="line">    <span class="keyword">this</span>.size = <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 末尾插入</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(String task)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.array[<span class="keyword">this</span>.size] = task;</span><br><span class="line">    <span class="keyword">this</span>.size++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 第三个位置插入</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert3Position</span><span class="params">(String task)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">3</span>;</span><br><span class="line">    <span class="comment">// 从右侧开始依次右移</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="keyword">this</span>.size - <span class="number">1</span>; i &gt;= index; i--) &#123;</span><br><span class="line">      <span class="keyword">this</span>.array[i + <span class="number">1</span>] = <span class="keyword">this</span>.array[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 插入元素</span></span><br><span class="line">    <span class="keyword">this</span>.array[index] = task;</span><br><span class="line">    <span class="comment">// 调整size</span></span><br><span class="line">    <span class="keyword">this</span>.size++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.size; i++) &#123;</span><br><span class="line">      System.out.print(<span class="keyword">this</span>.array[i] + <span class="string">" --&gt; "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Schedule schedule = <span class="keyword">new</span> Schedule();</span><br><span class="line">    schedule.add(<span class="string">"watch movie"</span>);</span><br><span class="line">    schedule.insert3Position(<span class="string">"afternoon tea"</span>);</span><br><span class="line">    schedule.print();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="空间不够"><a href="#空间不够" class="headerlink" title="空间不够"></a>空间不够</h2><p>当我们有4个朋友的时候，当前位置是满足要求的。如果突然多来了一个朋友，位置不够了，该怎<br>么办呢?我们需要重新找寻满足5个人位置的空间。这和数组空间不够的原理是一样的，我们需要通过3<br>步完成!</p>
<p><img src="https://style.youkeda.com/img/course/a1/3/3-5.svg" alt></p>
<p>如，上图所示，我们一起移动到下一排<br><strong>1.开辟新的内存空间</strong><br><strong>2.复制原来的数组到新的内存空间</strong><br><strong>3.再进行插入操作</strong><br>如果所有的内存空间都不足以存储我们的数组呢?这时候系统就会抛出异常— <strong>Out Of Memory</strong>内存<br>不够啦。</p>
<h2 id="数组删除"><a href="#数组删除" class="headerlink" title="数组删除"></a>数组删除</h2><p>数组的删除操作和插入操作<strong>刚好相反</strong>。我们简单过一下，如果是<strong>删除尾部元素,则直接删除</strong></p>
<p><img src="https://style.youkeda.com/img/course/a1/3/3-7.svg" alt></p>
<p>如果是删除中间元素通过两步执行<br><strong>1.删除中间元素</strong><br><strong>2.元素右侧其他元素依次左移</strong></p>
<p><img src="https://style.youkeda.com/img/course/a1/3/3-6.svg" alt></p>
<p>因此我们可以得知数组删除的时间复杂度也为0(N)。<br>o</p>
<h2 id="插入元素-例题："><a href="#插入元素-例题：" class="headerlink" title="插入元素  例题："></a>插入元素  例题：</h2><p><strong>本次作业需要完成add末尾，add中间两个函数</strong></p>
<p><strong>注意</strong><br>1.暂时只需要让YKDArrayList支持整数的存储，不<br>用考虑泛型。<br>2.因为需要完成插入函数,所以去掉之前的内置数<br>据。<br>3.在插入之后，记住需要<strong>修改size</strong>的值，暂不考虑空<br>间不足的情况。<br>4.在中间插入时候，需要判断插入位置是否出现越界<br>问题。➊</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YKDArrayList</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 此处需要声明一个数组，作为底层存储</span></span><br><span class="line">  <span class="keyword">int</span>[] array = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">20</span>];</span><br><span class="line">  <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">YKDArrayList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取数组的长度</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.size;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数组获取某个索引值</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.array[index];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 添加元素在末尾</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> element)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">     <span class="keyword">this</span>.array[<span class="keyword">this</span>.size] =element ;</span><br><span class="line">    <span class="keyword">this</span>.size++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 添加元素在中间</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> element)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index&lt;<span class="number">0</span>||index&gt;<span class="keyword">this</span>.size)&#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">// 从右侧开始依次右移</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="keyword">this</span>.size - <span class="number">1</span>; i &gt;= index; i--) &#123;</span><br><span class="line">      <span class="keyword">this</span>.array[i + <span class="number">1</span>] = <span class="keyword">this</span>.array[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 插入元素</span></span><br><span class="line">    <span class="keyword">this</span>.array[index] = element;</span><br><span class="line">    <span class="comment">// 调整size</span></span><br><span class="line">    <span class="keyword">this</span>.size++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.size; i++) &#123;</span><br><span class="line">      System.out.print(<span class="keyword">this</span>.array[i] + <span class="string">" --&gt; "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    YKDArrayList ykdArrayList = <span class="keyword">new</span> YKDArrayList();</span><br><span class="line">    ykdArrayList.add(<span class="number">1</span>);</span><br><span class="line">    ykdArrayList.add(<span class="number">2</span>);</span><br><span class="line">    ykdArrayList.add(<span class="number">3</span>);</span><br><span class="line">    ykdArrayList.add(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    ykdArrayList.add(<span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="删除-例题"><a href="#删除-例题" class="headerlink" title="删除  例题"></a>删除  例题</h2><p>本次作业需要完成<strong>remove函数</strong>，可以根据索引删除元素。</p>
<p><strong>注意</strong><br>1.暂时只需要让YKDArrayList支持整数的存储，不<br>用考虑泛型。<br>2.在删除之后，记住需要修改size的值。<br>3.在删除的时候，需要判断插入位置是否出现越界问<br>题。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YKDArrayList</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 此处需要声明一个数组，作为底层存储</span></span><br><span class="line">  <span class="keyword">int</span>[] array = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">20</span>];</span><br><span class="line">  <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">YKDArrayList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取数组的长度</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.size;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数组获取某个索引值</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.array[index];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 添加元素在末尾 </span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> element)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//相当于调用传入this.size</span></span><br><span class="line">    <span class="keyword">this</span>.add(<span class="keyword">this</span>.size, element);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 添加元素在中间</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> element)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; <span class="keyword">this</span>.size) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 元素依次右移</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="keyword">this</span>.size - <span class="number">1</span>; i &gt;= index; i--) &#123;</span><br><span class="line">      <span class="keyword">this</span>.array[i + <span class="number">1</span>] = <span class="keyword">this</span>.array[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 插入元素</span></span><br><span class="line">    <span class="keyword">this</span>.array[index] = element;</span><br><span class="line">    <span class="comment">// 调整size</span></span><br><span class="line">    <span class="keyword">this</span>.size++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 删除元素</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.remove(index);</span><br><span class="line">    <span class="keyword">this</span>.size--;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    YKDArrayList ykdArrayList = <span class="keyword">new</span> YKDArrayList();</span><br><span class="line">    ykdArrayList.add(<span class="number">1</span>);</span><br><span class="line">    ykdArrayList.add(<span class="number">2</span>);</span><br><span class="line">    ykdArrayList.add(<span class="number">3</span>);</span><br><span class="line">    ykdArrayList.add(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    ykdArrayList.add(<span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    ykdArrayList.remove(<span class="number">3</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="扩容-例题："><a href="#扩容-例题：" class="headerlink" title="扩容 例题："></a>扩容 例题：</h2><p>我们需要让YKDArrayList<strong>支持扩容</strong>，大致思路如下:</p>
<p>1.每次插入元素的时候，判断元素个数是否已经达到存储上限。<br>2.如果达到存储上限，则创建- -个新的数组(大小可<br>以设置为原来的2倍)准备用于存储数据<br>3.接下来拷贝原来的数组到新的数组<br>4.再继续执行在新的数组中执行插入操作➊</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YKDArrayList</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 此处需要声明一个数组，作为底层存储</span></span><br><span class="line">  <span class="keyword">int</span>[] array = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">20</span>];</span><br><span class="line">  <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">YKDArrayList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取数组的长度</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.size;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 数组获取某个索引值</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.array[index];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 添加元素在末尾 </span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> element)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//相当于调用传入this.size</span></span><br><span class="line">    <span class="keyword">this</span>.add(<span class="keyword">this</span>.size, element);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 添加元素在中间</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> element)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; <span class="keyword">this</span>.size) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">int</span> [] array1= <span class="keyword">new</span> <span class="keyword">int</span> [array.length*<span class="number">2</span>];</span><br><span class="line"> <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i &lt;array.length;i++)&#123;</span><br><span class="line">    array1[i]=array[i];</span><br><span class="line"> &#125;</span><br><span class="line">    <span class="comment">// 支持扩容</span></span><br><span class="line">    <span class="comment">// TODO</span></span><br><span class="line">    <span class="comment">// 元素依次右移</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="keyword">this</span>.size - <span class="number">1</span>; i &gt;= index; i--) &#123;</span><br><span class="line">      <span class="keyword">this</span>.array[i + <span class="number">1</span>] = <span class="keyword">this</span>.array[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 插入元素</span></span><br><span class="line">    <span class="keyword">this</span>.array[index] = element;</span><br><span class="line">    <span class="comment">// 调整size</span></span><br><span class="line">    <span class="keyword">this</span>.size++;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 删除元素</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt; <span class="keyword">this</span>.size - <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 元素依次左移</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = index; i &lt; <span class="keyword">this</span>.size - <span class="number">1</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">this</span>.array[i] = <span class="keyword">this</span>.array[i + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 删除最后一个元素</span></span><br><span class="line">    <span class="keyword">this</span>.array[<span class="keyword">this</span>.size - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 调整size</span></span><br><span class="line">    <span class="keyword">this</span>.size--;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    YKDArrayList ykdArrayList = <span class="keyword">new</span> YKDArrayList();</span><br><span class="line">    ykdArrayList.add(<span class="number">1</span>);</span><br><span class="line">    ykdArrayList.add(<span class="number">2</span>);</span><br><span class="line">    ykdArrayList.add(<span class="number">3</span>);</span><br><span class="line">    ykdArrayList.add(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    ykdArrayList.add(<span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    ykdArrayList.remove(<span class="number">3</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h4 id="数组的优势与劣势："><a href="#数组的优势与劣势：" class="headerlink" title="数组的优势与劣势："></a>数组的优势与劣势：</h4><p><strong>优势</strong>：数组的<strong>查询数据</strong>特别快，<strong>时间复杂度是 O(1</strong>)</p>
<p><strong>劣势</strong>：数组的<strong>插入和删除</strong>比较慢，时间复杂度是 O(N) 数组需<strong>要连续内存空间</strong>，并且会<strong>申请额外**</strong>的内存空间便于其扩展**，这种数据结构对内存要求比较高，利用率低。</p>
<p><strong>同时我们知道 Java 中的   ArrayList   ，实际上在底层就是利用数组实现的。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"> <span class="keyword">import</span> java.util.*;</span><br><span class="line"> <span class="keyword">import</span> java.lang.Object;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断是否为回文字符串</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isPalindrome</span><span class="params">(String content)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">int</span> length = content.length();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length / <span class="number">2</span>; i++) &#123;</span><br><span class="line">              <span class="keyword">if</span> (content.toCharArray()[i] != content.toCharArray()[length - i - <span class="number">1</span>]) &#123;</span><br><span class="line">                 <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(isPalindrome(<span class="string">"洞帘水挂水帘洞"</span>));</span><br><span class="line">    System.out.println(isPalindrome(<span class="string">"上海自来水来自海上"</span>));</span><br><span class="line">    System.out.println(isPalindrome(<span class="string">"maddam"</span>));</span><br><span class="line">    System.out.println(isPalindrome(<span class="string">"m"</span>));</span><br><span class="line">    System.out.println(isPalindrome(<span class="string">"maxcam"</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="括号匹配-例题："><a href="#括号匹配-例题：" class="headerlink" title="括号匹配 例题："></a>括号匹配 例题：</h2><p>在运行java代码的时候，运行工具会先帮我们进行语法校验，在语法校验中很重要的一步是—判断括<br>号是否匹配。<br>什么意思?<br>简单来说，<strong>有左括号就应该有右括号，有开即有合</strong>。</p>
<p><strong>符合要求的代码</strong><br>  如下代码就是符合要求的  :</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">(<span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(a == <span class="number">1</span>) &#123;</span><br><span class="line">    System.out.println(a);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>转换成字符串：</p>
<p>“public void run(int a){if(a == 1){System.out.println(a)}}”</p>
<p>不符合要求的代码</p>
<p>而如下代码就是<strong>不符合要求</strong>的：<br>public void run(int a) {<br>if(a == 1) // 此处缺少一个左大括号<br>System. out. println(a);<br>}<br>}<br>现在我们需要完善一下右 侧的方法，校验代码中的<br>括号是否符合规则。</p>
<p><strong>思路：</strong></p>
<p>可以是用一个整数来存储括号匹配情况，这个整数初始化为 0，遇到左括号则+1，遇到右括号则-1，最后程序运行结束后，查看整数是否为 0。</p>
<p><strong>注意</strong><br>1.需要同时判断圆括号()，大括号{}两种类型。<br>2.注意不能是右括号出现在左括号之前，例如}{。<br>3.暂时不用考虑语义化问题，例如{((}))，这种字.<br>符串也可以通过测试。</p>
<p><strong>代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 判断括号是否匹配</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isBracketMatch</span><span class="params">(String content)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 用两个整数存储括号值，出现左括号就+1，出现右括号则-1</span></span><br><span class="line">    <span class="keyword">int</span> bracketNum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> bigBracketNum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; content.length(); i++) &#123;</span><br><span class="line">      <span class="keyword">char</span> c = content.charAt(i);</span><br><span class="line">      <span class="keyword">if</span> (c == <span class="string">'('</span>) &#123;</span><br><span class="line">        bracketNum++;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (c == <span class="string">'&#123;'</span>) &#123;</span><br><span class="line">        bigBracketNum++;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (c == <span class="string">')'</span>) &#123;</span><br><span class="line">        bracketNum--;</span><br><span class="line">        <span class="comment">// 不能出现负值，负值表示右括号先出现。</span></span><br><span class="line">        <span class="keyword">if</span> (bracketNum &lt; <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (c == <span class="string">'&#125;'</span>) &#123;</span><br><span class="line">        bigBracketNum--;</span><br><span class="line">        <span class="comment">// 不能出现负值，负值表示右括号先出现。</span></span><br><span class="line">        <span class="keyword">if</span> (bigBracketNum &lt; <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">if</span> (bigBracketNum != <span class="number">0</span> || bracketNum != <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(isBracketMatch(<span class="string">"public void run(int a)&#123;if(a == 1)&#123;System.out.println(a)&#125;&#125;"</span>));</span><br><span class="line">    System.out.println(isBracketMatch(<span class="string">"public void run(int a)&#123;if(a == 1)System.out.println(a)&#125;&#125;"</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/07/26/day17-2/" data-id="ckdn9i6ne000gjwuxe4v97pnl" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%B0%8F%E6%A1%88%E4%BE%8B-%E4%BA%8C%E5%88%86%E6%B3%95%E6%9F%A5%E6%89%BE%E3%80%81-%E4%BA%8C%E6%AC%A1%E9%97%AE%E9%A2%98%EF%BC%88%E6%A0%87%E8%AE%B0%E6%B3%95%EF%BC%89%E3%80%81%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E3%80%81-%E6%95%B0%E7%BB%84-%E5%AD%98%E5%82%A8%E5%92%8C%E8%AF%BB%E5%8F%96%E3%80%81%E6%95%B0%E7%BB%84%E6%8F%92%E5%85%A5%E5%92%8C%E5%88%A0%E9%99%A4/" rel="tag">性能优化小案例-二分法查找、 二次问题（标记法）、计算机内存管理、 数组-存储和读取、数组插入和删除</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-day17" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/26/day17/" class="article-date">
  <time datetime="2020-07-26T04:49:21.000Z" itemprop="datePublished">2020-07-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/26/day17/">day17</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h2><p><strong>数据结构是<a href="https://baike.baidu.com/item/计算机/140338" target="_blank" rel="noopener">计算机</a>存储、组织<a href="https://baike.baidu.com/item/数据" target="_blank" rel="noopener">数据</a>的方式</strong>。数据结构是指相互之间存在一种或多种特定关系的<a href="https://baike.baidu.com/item/数据元素/715313" target="_blank" rel="noopener">数据元素</a>的集合。通常情况下，精心选择的数据结构可以带来更高的运行或者存储<a href="https://baike.baidu.com/item/效率/868847" target="_blank" rel="noopener">效率</a>。数据结构往往同高效的检索<a href="https://baike.baidu.com/item/算法/209025" target="_blank" rel="noopener">算法</a>和<a href="https://baike.baidu.com/item/索引/5716853" target="_blank" rel="noopener">索引</a>技术有关。</p>
<p><strong>数据结构(data structure)是带有结构特性的数据元素的集合</strong>，它研究的是数据的<a href="https://baike.baidu.com/item/逻辑结构/9663235" target="_blank" rel="noopener">逻辑结构</a>和数据的物理结构以及它们之间的相互关系，并对这种结构定义相适应的运算，设计出相应的算法，并确保经过这些运算以后所得到的新结构仍保持原来的结构类型。简而言之，数据结构是相互之间存在一种或多种特定关系的数据元素的集合，即带“结构”的数据元素的集合。“结构”就是指数据元素之间存在的关系，分为<strong>逻辑结构</strong>和<strong>存储结构</strong></p>
<h3 id="数据的逻辑结构"><a href="#数据的逻辑结构" class="headerlink" title="数据的逻辑结构"></a>数据的逻辑结构</h3><p>指反映数据<a href="https://baike.baidu.com/item/元素" target="_blank" rel="noopener">元素</a>之间的逻辑关系的<a href="https://baike.baidu.com/item/数据结构" target="_blank" rel="noopener">数据结构</a>，其中的<a href="https://baike.baidu.com/item/逻辑关系" target="_blank" rel="noopener">逻辑关系</a>是指数据元素之间的前后间关系，而与他们在计算机中的存储位置无关。逻辑结构包括： </p>
<p>1.集合：数据结构中的元素之间除了“同属一个集合” 的相互关系外，别无其他关系； </p>
<p>2.线性结构：数据结构中的元素存在一对一的相互关系； </p>
<p>3.<a href="https://baike.baidu.com/item/树形结构" target="_blank" rel="noopener">树形结构</a>：数据结构中的元素存在一对多的相互关系； </p>
<p>4.<a href="https://baike.baidu.com/item/图形结构" target="_blank" rel="noopener">图形结构</a>：数据结构中的元素存在多对多的相互关系</p>
<h3 id="数据的物理结构"><a href="#数据的物理结构" class="headerlink" title="数据的物理结构"></a>数据的物理结构</h3><p>指数据的<a href="https://baike.baidu.com/item/逻辑结构" target="_blank" rel="noopener">逻辑结构</a>在计算机存储空间的存放形式。 </p>
<p>数据的物理结构是数据结构在计算机中的表示（又称映像），它包括数据元素的机内表示和关系的机内表示。由于具体实现的方法有顺序、链接、索引、散列等多种，所以，一种数据结构可表示成一种或多种存储结构。 </p>
<p>数据元素的机内表示（映像方法）： 用二进制位（bit）的位串表示数据元素。通常称这种位串为节点（node）。当数据元素有若干个数据项组成时，位串中与各个数据项对应的子位串称为数据域（data field）。因此，节点是数据元素的机内表示（或机内映像）。 </p>
<p>关系的机内表示（映像方法）：数据元素之间的关系的机内表示可以分为顺序映像和非顺序映像，常用两种存储结构：顺序存储结构和链式存储结构。顺序映像借助元素在存储器中的相对位置来表示数据元素之间的逻辑关系。非顺序映像借助指示元素存储位置的指针（pointer）来表示数据元素之间的逻辑关系。</p>
<h3 id="数据存储结构"><a href="#数据存储结构" class="headerlink" title="数据存储结构"></a>数据存储结构</h3><p>数据的逻辑结构在<strong>计算机存储空间中的存放形式</strong>称为数据的物理结构(也称为存储结构)。一般来说，一种数据结构的逻辑结构根据需要可以表示成多种存储结构，常用的存储结构有顺序存储、链式存储、索引存储和哈希存储等。 </p>
<p>数据的顺序存储结构的<strong>特点</strong>是：借助元素在存储器中的相对位置来表示数据元素之间的逻辑关系；非顺序存储的特点是：借助指示元素存储地址的指针表示数据元素之间的逻辑关系</p>
<h2 id="常用的数据结构"><a href="#常用的数据结构" class="headerlink" title="常用的数据结构"></a>常用的数据结构</h2><p>在<a href="https://baike.baidu.com/item/计算机科学/9132" target="_blank" rel="noopener">计算机科学</a>的发展过程中，数据结构也随之发展。程序设计中常用的数据结构包括如下几个。 </p>
<h3 id="数组-Array"><a href="#数组-Array" class="headerlink" title="数组(Array)"></a>数组(Array)</h3><p><a href="https://baike.baidu.com/item/数组/3794097" target="_blank" rel="noopener">数组</a>是一种聚合数据类型，它是将具有相同类型的若干变量有序地组织在一起的集合。数组可以说是最基本的数据结构，在各种编程语言中都有对应。一个数组可以分解为多个数组元素，按照数据元素的类型，数组可以分为整型数组、字符型数组、浮点型数组、指针数组和结构数组等。数组还可以有一维、二维以及多维等表现形式。 </p>
<h3 id="栈-Stack"><a href="#栈-Stack" class="headerlink" title="栈( Stack)"></a>栈( Stack)</h3><p><a href="https://baike.baidu.com/item/栈/12808149" target="_blank" rel="noopener">栈</a>是一种特殊的<a href="https://baike.baidu.com/item/线性表/3228081" target="_blank" rel="noopener">线性表</a>，它只能在一个表的一个固定端进行数据结点的插入和删除操作。栈按照后进先出的原则来存储数据，也就是说，先插入的数据将被压入栈底，最后插入的数据在栈顶，读出数据时，从栈顶开始逐个读出。栈在汇编语言程序中，经常用于重要数据的现场保护。栈中没有数据时，称为空栈。 </p>
<h3 id="队列-Queue"><a href="#队列-Queue" class="headerlink" title="队列(Queue)"></a>队列(Queue)</h3><p><a href="https://baike.baidu.com/item/队列/14580481" target="_blank" rel="noopener">队列</a>和栈类似，也是一种特殊的线性表。和栈不同的是，队列只允许在表的一端进行插入操作，而在另一端进行删除操作。一般来说，进行插入操作的一端称为队尾，进行删除操作的一端称为队头。队列中没有元素时，称为空队列。 </p>
<h3 id="链表-Linked-List"><a href="#链表-Linked-List" class="headerlink" title="链表( Linked List)"></a>链表( Linked List)</h3><p><a href="https://baike.baidu.com/item/链表/9794473" target="_blank" rel="noopener">链表</a>是一种数据元素按照链式存储结构进行存储的数据结构，这种存储结构具有在物理上存在非连续的特点。链表由一系列数据结点构成，每个数据结点包括数据域和指针域两部分。其中，指针域保存了数据结构中下一个元素存放的地址。链表结构中数据元素的逻辑顺序是通过链表中的指针链接次序来实现的。 </p>
<h3 id="树-Tree"><a href="#树-Tree" class="headerlink" title="树( Tree)"></a>树( Tree)</h3><p><a href="https://baike.baidu.com/item/树/2699484" target="_blank" rel="noopener">树</a>是典型的非线性结构，它是包括，2个结点的有穷集合K。在树结构中，有且仅有一个根结点，该结点没有前驱结点。在树结构中的其他结点都有且仅有一个前驱结点，而且可以有两个后继结点，m≥0。</p>
<h3 id="图-Graph"><a href="#图-Graph" class="headerlink" title="图(Graph)"></a>图(Graph)</h3><p><a href="https://baike.baidu.com/item/图/13018767" target="_blank" rel="noopener">图</a>是另一种非线性数据结构。在图结构中，数据结点一般称为顶点，而边是顶点的有序偶对。如果两个顶点之间存在一条边，那么就表示这两个顶点具有相邻关系。 </p>
<p><a href="https://baike.baidu.com/item/堆/20606834" target="_blank" rel="noopener">堆</a>是一种特殊的树形数据结构，一般讨论的堆都是二叉堆。堆的特点是根结点的值是所有结点中最小的或者最大的，并且根结点的两个子树也是一个堆结构。 </p>
<h3 id="散列表-Hash"><a href="#散列表-Hash" class="headerlink" title="散列表(Hash)"></a>散列表(Hash)</h3><p>散列表源自于<a href="https://baike.baidu.com/item/散列函数/2366288" target="_blank" rel="noopener">散列函数</a>(Hash function)，其思想是如果在结构中存在关键字和T相等的记录，那么必定在F(T)的存储位置可以找到该记录，这样就可以不用进行比较操作而直接取得所查记录。</p>
<h2 id="常用算法"><a href="#常用算法" class="headerlink" title="常用算法"></a>常用算法</h2><p>数据结构研究的内容：就是如何按一定的逻辑结构，把数据组织起来，并选择适当的存储表示方法把逻辑结构组织好的数据存储到计算机的存储器里。算法研究的目的是为了更有效的处理数据，提高数据运算效率。数据的运算是定义在数据的逻辑结构上，但运算的具体实现要在存储结构上进行。一般有以下几种常用运算： </p>
<p>(1)检索。检索就是在数据结构里查找满足一定条件的节点。一般是给定一个某字段的值，找具有该字段值的节点。 </p>
<p>(2)插入。往数据结构中增加新的节点。 </p>
<p>(3)删除。把指定的结点从数据结构中去掉。 </p>
<p>(4)更新。改变指定节点的一个或多个字段的值。 </p>
<p>(5)排序。把节点按某种指定的顺序重新排列。例如递增或递减。</p>
<h2 id="大O-记法"><a href="#大O-记法" class="headerlink" title="大O 记法"></a>大O 记法</h2><h4 id="计算机怎么判断程序性能"><a href="#计算机怎么判断程序性能" class="headerlink" title="计算机怎么判断程序性能?"></a>计算机怎么判断程序性能?</h4><p>我们都知道，编程基本上是在和数据打交道,大多数程序基本都在处理<strong>获取数据、查询数<br>据、操作数据、返回数据</strong>相关的逻辑。因此出现了数据结构和算法，这两者出现本质为了解决如何能够<strong>更快、更省</strong>进行数据处理。➊这里的更快，也就是程序运行时间更短,对应的指标我们称之为<strong>时间复杂度</strong>。➊这里的更省，也就是程序运行所消耗的内存更少，对应的指标我们称之为<strong>空间复杂度</strong>。➊</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>所以我们需要一一个不用具体的测试数据和测试环境,就可以粗略地估计算法执行效率的方<br>法。这个方法我们称作为复杂度，我们称作为大0记法，在后面章节我们在时间和空间领域具体<br>介绍大0记法是如何计算的。大家一定要记住:复杂度分析(大0记法)是数据结构和算法的精髓和基石，只有掌握好它，才能更好的学习数据结构和算法。</p>
<h2 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h2><h4 id="如何计算时间复杂度"><a href="#如何计算时间复杂度" class="headerlink" title="如何计算时间复杂度"></a>如何计算时间复杂度</h4><p>我们使用<strong>步数</strong>作为时间复杂度的计算!什么叫做步数，大家可以简单理解数组的每次索引值的读取，就算作一步，也可以被称作为<strong>unit_ _time。</strong></p>
<h5 id="案例1-数组值获取-0-1"><a href="#案例1-数组值获取-0-1" class="headerlink" title="案例1:数组值获取(0(1))"></a>案例1:数组值获取(0(1))</h5><p>题目:我们需要获取数组的第4个位置的值。</p>
<p><img src="https://style.youkeda.com/img/course/a1/2/2-2-1.svg" alt></p>
<p>如下代码： </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a[] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;;</span><br><span class="line">System.out.println(a[<span class="number">3</span>]); <span class="comment">// step1</span></span><br></pre></td></tr></table></figure>

<p>如上<strong>step1</strong>，获取<strong>a</strong>第3个索引位置的值,我们把这个时间称作为1步。<br>实际上在计算机底层，<strong>计算机可以通过-步跳到任意-个索引的位置进行数据<br>的读取</strong>，因此这个时间也被称为单位时间<strong>unit _time。</strong><br><strong>为什么计算机可以-步读取数组索引值?</strong>这里给大家留个小问题，等到第三章<br>数组我们会具体解释到。<br>如果大0记法,我们称作为<strong>常数时间—0(1)。</strong><br>用通俗的话解释也就是:无论数组的长度多少，获取数组中某个值的都只是1<br>步。<br>随着数组数量增加，时间复杂度并不会提升。<br>如果用数学公式<strong>f(x)</strong>表示程序运行所需的时间(x 表示数组的长度，后面坐标图<br>都一样)，结果是:g</p>
<img src="https://style.youkeda.com/img/course/a1/2/O1.png" style="zoom:200%;">

<h4 id="猜数字游戏-O-logN"><a href="#猜数字游戏-O-logN" class="headerlink" title="猜数字游戏(O(logN))"></a>猜数字游戏(O(logN))</h4><p>在上一章,我们学习过的猜数字的游戏，我们知道需要的步数为10g(N),我们<br>称为<strong>对数时间—0(log(N))</strong>。<br>用数学公式表示如下: .</p>
<p><img src="https://style.youkeda.com/img/course/a1/2/Olog.png" alt></p>
<p>可以看到<strong>0(log(N))比0(1)</strong>增长的更快一些,性能更差一点。</p>
<h4 id="计算N的阶乘-O-N"><a href="#计算N的阶乘-O-N" class="headerlink" title="计算N的阶乘(O(N))"></a>计算N的阶乘(O(N))</h4><p>题目: 我们需要定义一个函数,这个函数能计算传入参数N的阶乘N!。<br><strong>f(N)= N <em>(N- 1)</em>(N- 2)<em>…*2</em> 1</strong><br>我们来看看下面的代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">factorial</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> result = <span class="number">1</span>; <span class="comment">//step1</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123; <span class="comment">//step2</span></span><br><span class="line">        result *= i;  <span class="comment">// step3</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://style.youkeda.com/img/course/a1/2/2-2-4.svg" alt></p>
<p>step1 : 初始化变量result: 1 步 </p>
<p>step2 : 初始化变量i1 步，i++相当于i = i + 1，需要执行 N 次，因此 step2 一共 N + 1 步。</p>
<p> step3 : 执行 N 步</p>
<p>(注意,在此处我们暂时只考虑数据赋值操作情况，暂时不考虑i &lt;= n代码)<br>在这种情况下，-共的时间复杂度为<strong>2N + 2</strong>。<br>如果大0记法,我们称作为<strong>线性时间—0(2N + 2)</strong>。<br><strong>忽略常量</strong>。<br>通过这两个案例，大家已经发现<strong>大0记法</strong>，表示的是<strong>代码执行时间随数据规模增<br>长的变化趋势</strong>，也就是需要把N想象成1W, 100W甚至更大。<br>而在这种情况下，<strong>常量、系数部分并不左右增长趋势</strong>,所以都可以忽略。<br>所以上面<strong>0(2N + 2)</strong>,通常我们会表示为<strong>O(N)</strong>。<br>因此上面三个案例，膠动:</p>
<p><img src="https://style.youkeda.com/img/course/a1/2/ON.png" alt></p>
<h4 id="计算一个数组中的所有组合方式（O-N-2-）"><a href="#计算一个数组中的所有组合方式（O-N-2-）" class="headerlink" title="计算一个数组中的所有组合方式（O(N^2)）"></a>计算一个数组中的所有组合方式（O(N^2)）</h4><p>我们需要定义一个函数，能打印传入参数的两两组合情况。 例如：我们传入一个数组<strong>{“hello”, “you”, “ke”, “da”}</strong>，里面有 4 个英文词语，我们希望两两组合，那么一共有哪些组合情况呢？</p>
<p><img src="https://style.youkeda.com/img/course/a1/2/2-2-3.svg" alt></p>
<p>代码如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public void combine(String args[]) &#123;</span><br><span class="line">    for (int i &#x3D; 0; i &lt; args.length; i++) &#123; &#x2F;&#x2F;step1</span><br><span class="line">        for (int j &#x3D; i + 1; j &lt; args.length; j++) &#123; &#x2F;&#x2F;step2</span><br><span class="line">            System.out.println(args[i] + args[j]); &#x2F;&#x2F;step3</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们分析下上面的时间复杂度（这里涉及到高中数学知识<strong>等差数列</strong>，简单给大家回顾一下）</p>
<p><img src="https://style.youkeda.com/img/course/a1/2/2-2-5.svg" alt></p>
<p>step1: int i = 01 步, i++N 步，因此一共 N+1 步 </p>
<p>step2: 分别执行 (N) + (N-1) + (N-2) + … + 2 + 1 = N*(N + 1) / 2 *</p>
<p><em>step3: 执行了 N</em>(N - 1) / 2</p>
<p>最终的结果为<strong>N^2 + N + 1</strong>步。<br>注意，此次有指数出现了，我们称为<strong>**指数时间–0(N^2 + N + 1),</strong>略常数为O(N^2)<strong>。<br>对于指数时间而言，线性时间都可以被忽略,例如: O(N^2 + N + 1)，最终忽<br>略以后的结果为O(N^2)<br>把三个案例放一起，我们看看时间复杂度的趋势(大家只需要关心右上角</strong>(X &gt;0区域) **) :</p>
<p><img src="https://style.youkeda.com/img/course/a1/2/ON2.png" alt></p>
<h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><p>从上面3个案例我们可以总结出规律:<strong>大0记法，只保留最大趋势公式，指数&gt;线性&gt;对数&gt;常数</strong>。</p>
<p>因此我们在计算时间复杂度的时候，实并不需要一行行看代码，<strong>只需要关注for循环嵌套情况。</strong></p>
<p>写代码的时候，如果能用<strong>线性复杂度</strong>的代码，替换<strong>指数复杂度</strong>的代码，那就是大大性能优化。</p>
<h2 id="空间复杂度"><a href="#空间复杂度" class="headerlink" title="空间复杂度"></a>空间复杂度</h2><p>空间复杂度是以一个<strong>基础数据类型</strong>值当做基础单位</p>
<h4 id="O-1"><a href="#O-1" class="headerlink" title="O(1)"></a>O(1)</h4><p>int a = 0;<br>int j = 0;</p>
<h4 id="O-N"><a href="#O-N" class="headerlink" title="O(N)"></a>O(N)</h4><p>int a[] = new int[n]</p>
<h3 id="优先考虑时间复杂度"><a href="#优先考虑时间复杂度" class="headerlink" title="优先考虑时间复杂度"></a>优先考虑时间复杂度</h3><dl><dt>在实际编程过程中，我们大多数情况<strong>只会考虑时间复杂度</strong>! !为什么呢?<br>因为我们默认计算机内存是足够大的，足够给我们使用的。<br>大家是否听说过<strong>摩尔定律</strong>。</dt><dd>当价格不变时，集成电路上可容纳的元器件的数目，约每隔18-24 个月便会增<br>加一倍，性能也将提升一倍。</dd></dl><p>换而言之，<strong>每个18-24个月，同样大小的芯片里可存储的数据量将翻一倍</strong>。<br>因此我们完全可以忽略内存空间不够的情况。<br><strong>除非</strong>，注意除非大家以后参与嵌入式开发,参与单片机相关的编程开发，要<br>注意空间问题。<br><strong>本课程之后的讨论，都只会基于时间复杂度问题展开</strong>。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/07/26/day17/" data-id="ckdn9i6nc000fjwuxbie8auut" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8%E5%89%8D%E8%A8%80%E3%80%81-%E5%A4%A7O%E8%AE%B0%E6%B3%95%E3%80%81%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E3%80%81%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/" rel="tag">数据结构及算法入门前言、 大O记法、时间复杂度、空间复杂度</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-day16" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/25/day16/" class="article-date">
  <time datetime="2020-07-25T02:54:05.000Z" itemprop="datePublished">2020-07-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/25/day16/">day16</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="SMTP"><a href="#SMTP" class="headerlink" title="SMTP"></a>SMTP</h2><p>SMTP是一个简单的基于文本的邮件传输协议,全称为(<strong>Simple Mail Transfer Protocol -简单<br>邮件传输协议</strong>)。在这个协议上我们可以指定-条邮件消息和一个或多个邮件接收者,然后<br>进行邮件输出。➊</p>
<h2 id="SMTP-应用"><a href="#SMTP-应用" class="headerlink" title="SMTP 应用"></a>SMTP 应用</h2><h2 id="开启QQ邮箱设置"><a href="#开启QQ邮箱设置" class="headerlink" title="开启QQ邮箱设置"></a>开启QQ邮箱设置</h2><p>1.打开QQ邮箱网页版。<br>2.在QQ邮箱头部找到邮箱设置，切换到账户下面，如图：</p>
<p><img src="https://style.youkeda.com/img/ham/course/j3/j3-8/4.png" alt></p>
<p>3.往下面翻，开启和 SMTP 有关的服务，如图前两项</p>
<p><img src="https://style.youkeda.com/img/ham/course/j3/j3-8/5.png" alt></p>
<p>4.开启过程中可能会有各种验证，最终会得到授权码，如图：</p>
<p><img src="https://style.youkeda.com/img/ham/course/j3/j3-8/6.png" alt></p>
<h6 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h6><p>●授权码没有空格，只是QQ邮箱为了分段<br>显示已。<br>●授权码不是邮箱的登录密码哦，不要混淆<br>了。</p>
<h3 id="javaMail"><a href="#javaMail" class="headerlink" title="javaMail"></a>javaMail</h3><p>在Java中我们可以调用JavaMail调用发送和接收邮件,我们首先配置maven依赖,如<br>pom文件中加入:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line"> &lt;groupId&gt;javax.mail&lt;<span class="regexp">/groupId&gt;</span></span><br><span class="line"><span class="regexp"> &lt;artifactId&gt;mail&lt;/</span>artifactId&gt;</span><br><span class="line"> &lt;version&gt;<span class="number">1.4</span>&lt;<span class="regexp">/version&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>dependency&gt;</span><br></pre></td></tr></table></figure>



<p>然后发送代码。固定用法，只需修改邮箱相关配置：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.Security;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> javax.mail.Authenticator;</span><br><span class="line"><span class="keyword">import</span> javax.mail.Message;</span><br><span class="line"><span class="keyword">import</span> javax.mail.PasswordAuthentication;</span><br><span class="line"><span class="keyword">import</span> javax.mail.Session;</span><br><span class="line"><span class="keyword">import</span> javax.mail.Transport;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.InternetAddress;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeMessage;</span><br><span class="line"><span class="keyword">import</span> com.sun.net.ssl.internal.ssl.Provider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MailClient</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//设置SSL连接、邮件环境</span></span><br><span class="line">      Security.addProvider(<span class="keyword">new</span> Provider());</span><br><span class="line">      <span class="keyword">final</span> String SSL_FACTORY = <span class="string">"javax.net.ssl.SSLSocketFactory"</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//配置邮箱信息</span></span><br><span class="line">      Properties props = System.getProperties();</span><br><span class="line">      <span class="comment">//邮件服务器</span></span><br><span class="line">      props.setProperty(<span class="string">"mail.smtp.host"</span>, <span class="string">"smtp.qq.com"</span>);</span><br><span class="line">      props.setProperty(<span class="string">"mail.smtp.socketFactory.class"</span>, SSL_FACTORY);</span><br><span class="line">      props.setProperty(<span class="string">"mail.smtp.socketFactory.fallback"</span>, <span class="string">"false"</span>);</span><br><span class="line">      <span class="comment">//邮件服务器端口</span></span><br><span class="line">      props.setProperty(<span class="string">"mail.smtp.port"</span>, <span class="string">"465"</span>);</span><br><span class="line">      props.setProperty(<span class="string">"mail.smtp.socketFactory.port"</span>, <span class="string">"465"</span>);</span><br><span class="line">      <span class="comment">//鉴权信息</span></span><br><span class="line">      props.setProperty(<span class="string">"mail.smtp.auth"</span>, <span class="string">"true"</span>);</span><br><span class="line">      <span class="comment">//建立邮件会话</span></span><br><span class="line">      Session session = Session.getDefaultInstance(props, <span class="keyword">new</span> Authenticator() &#123;</span><br><span class="line">        <span class="comment">//身份认证</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> PasswordAuthentication <span class="title">getPasswordAuthentication</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          <span class="comment">//1.账户 授权码</span></span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">new</span> PasswordAuthentication(<span class="string">"xxxxxxx@qq.com"</span>, <span class="string">"xxxx"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">//建立邮件对象</span></span><br><span class="line">      MimeMessage message = <span class="keyword">new</span> MimeMessage(session);</span><br><span class="line">      <span class="comment">//设置邮件的发件人</span></span><br><span class="line">      message.setFrom(<span class="keyword">new</span> InternetAddress(<span class="string">"xxxxxxx@qq.com"</span>));</span><br><span class="line">      <span class="comment">//2.设置邮件的收件人</span></span><br><span class="line">      message.setRecipients(Message.RecipientType.TO, <span class="string">"xxxxxxx@qq.com"</span>);</span><br><span class="line">      <span class="comment">//设置邮件的主题</span></span><br><span class="line">      message.setSubject(<span class="string">"通过javamail发出！！！"</span>);</span><br><span class="line">      <span class="comment">//文本部分</span></span><br><span class="line">      message.setContent(<span class="string">"文本邮件测试"</span>, <span class="string">"text/html;charset=UTF-8"</span>);</span><br><span class="line">      message.saveChanges();</span><br><span class="line">      <span class="comment">//发送邮件</span></span><br><span class="line">      Transport.send(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="特别说明"><a href="#特别说明" class="headerlink" title="特别说明"></a>特别说明</h6><p>1.注释1中账户和授权码<strong>改为</strong>你的QQ号和刚才申请保存的授权码.<br>2.注释2中message.setRecipients 可以设置多个收件人信息。用逗号分割多个收件人</p>
<p>xxxx@qq. com, xxxx@126. com<br>3.所有XXXX都改为自己的邮箱地址，否则你看不到邮件内容哦。</p>
<h2 id="例题：用java给自己发一份邮件"><a href="#例题：用java给自己发一份邮件" class="headerlink" title="例题：用java给自己发一份邮件"></a>例题：用java给自己发一份邮件</h2><p>自己的QQ邮箱给自己发一封邮件，注意一下约定条件<br>1.设置邮件主题为:优课达<br>2.设置邮件主题内容为: HELLOWORLD<br>3.发送邮件完毕后，在console打印: “发送成功”信息。<br>|注意:●右侧代码区的pom. xml文件中要加入JavaMail的依赖哦。</p>
<p>代码：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">  &lt;dependency&gt;</span><br><span class="line"> &lt;groupId&gt;javax.mail&lt;/groupId&gt;</span><br><span class="line"> &lt;artifactId&gt;mail&lt;/artifactId&gt;</span><br><span class="line"> &lt;version&gt;1.4&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.email;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.security.Security;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> javax.mail.Authenticator;</span><br><span class="line"><span class="keyword">import</span> javax.mail.Message;</span><br><span class="line"><span class="keyword">import</span> javax.mail.PasswordAuthentication;</span><br><span class="line"><span class="keyword">import</span> javax.mail.Session;</span><br><span class="line"><span class="keyword">import</span> javax.mail.Transport;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.InternetAddress;</span><br><span class="line"><span class="keyword">import</span> javax.mail.internet.MimeMessage;</span><br><span class="line"><span class="keyword">import</span> com.sun.net.ssl.internal.ssl.Provider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mail</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//设置SSL连接、邮件环境</span></span><br><span class="line">      Security.addProvider(<span class="keyword">new</span> Provider());</span><br><span class="line">      <span class="keyword">final</span> String SSL_FACTORY = <span class="string">"javax.net.ssl.SSLSocketFactory"</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//配置邮箱信息</span></span><br><span class="line">      Properties props = System.getProperties();</span><br><span class="line">      <span class="comment">//邮件服务器</span></span><br><span class="line">      props.setProperty(<span class="string">"mail.smtp.host"</span>, <span class="string">"smtp.qq.com"</span>);</span><br><span class="line">      props.setProperty(<span class="string">"mail.smtp.socketFactory.class"</span>, SSL_FACTORY);</span><br><span class="line">      props.setProperty(<span class="string">"mail.smtp.socketFactory.fallback"</span>, <span class="string">"false"</span>);</span><br><span class="line">      <span class="comment">//邮件服务器端口</span></span><br><span class="line">      props.setProperty(<span class="string">"mail.smtp.port"</span>, <span class="string">"465"</span>);</span><br><span class="line">      props.setProperty(<span class="string">"mail.smtp.socketFactory.port"</span>, <span class="string">"465"</span>);</span><br><span class="line">      <span class="comment">//鉴权信息</span></span><br><span class="line">      props.setProperty(<span class="string">"mail.smtp.auth"</span>, <span class="string">"true"</span>);</span><br><span class="line">      <span class="comment">//建立邮件会话</span></span><br><span class="line">      Session session = Session.getDefaultInstance(props, <span class="keyword">new</span> Authenticator() &#123;</span><br><span class="line">        <span class="comment">//身份认证</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> PasswordAuthentication <span class="title">getPasswordAuthentication</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          <span class="comment">//1.账户 授权码</span></span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">new</span> PasswordAuthentication(<span class="string">"1239142023@qq.com"</span>, <span class="string">"wrfvxyabwwxgjidi"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">//建立邮件对象</span></span><br><span class="line">      MimeMessage message = <span class="keyword">new</span> MimeMessage(session);</span><br><span class="line">      <span class="comment">//设置邮件的发件人</span></span><br><span class="line">      message.setFrom(<span class="keyword">new</span> InternetAddress(<span class="string">"1239142023@qq.com"</span>));</span><br><span class="line">      <span class="comment">//2.设置邮件的收件人</span></span><br><span class="line">      message.setRecipients(Message.RecipientType.TO, <span class="string">"1239142023@qq.com"</span>);</span><br><span class="line">      <span class="comment">//设置邮件的主题</span></span><br><span class="line">      message.setSubject(<span class="string">"优课达"</span>);</span><br><span class="line">      <span class="comment">//文本部分</span></span><br><span class="line">      message.setContent(<span class="string">"HELLOWORLD"</span>, <span class="string">"text/html;charset=UTF-8"</span>);</span><br><span class="line">      message.saveChanges();</span><br><span class="line">      <span class="comment">//发送邮件</span></span><br><span class="line">      Transport.send(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">"发送成功"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="实战天气"><a href="#实战天气" class="headerlink" title="实战天气"></a>实战天气</h2><h4 id="调用API"><a href="#调用API" class="headerlink" title="调用API"></a>调用API</h4><p>这一节我们将调用API ，查询余杭区的天气。中国天气官网查询实时天气的API为:<br><a href="http://www.weather.com.cn/data/sk/101210106.htmlq" target="_blank" rel="noopener">http://www.weather.com.cn/data/sk/101210106.htmlq</a><br>解读一下这个地址，地址中的<strong>101210106</strong>就是城市代码，我们要查询余杭区，则把这段数字<br>进行替换，替换后结果为:<a href="http://www.weather" target="_blank" rel="noopener">http://www.weather</a>. com.cn/data/sk/101210106.html</p>
<p>利用上面的天气查询API,完成需求:<br>1.从本章第一节的<strong>china-city- list.csv **文件中找到永川(隶属于重庆)的代号。<br>2.在类</strong>PageOperator <strong>中完成:从中国天气官网查询实时天气的 API中查询永川的天气。<br>3.从本章示例的返回结果数据中抽象出</strong>Weather| (天气模型)、WeatherInfo(天气详情模型)**，分析两个类所包含的属性，,梳理二者之间的关系。。根据示例的结果数据，完成两个类的数据属性。<br>4.在类 Pageoperator中完成:将天气API查询的结果 反序列化成天气模型对象。<br>5.在类Pageoperator中完成:打印城市名称到console，格式为: “city= 余杭”</p>
<h4 id="poxm-xml文件代码："><a href="#poxm-xml文件代码：" class="headerlink" title="poxm.xml文件代码："></a>poxm.xml文件代码：</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">          &lt;groupId&gt;com.squareup.okhttp3&lt;/groupId&gt;</span><br><span class="line">          &lt;artifactId&gt;okhttp&lt;/artifactId&gt;</span><br><span class="line">          &lt;version&gt;4.1.0&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;javax.mail&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mail&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.4&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;fastjson&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.2.62&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">          &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;</span><br><span class="line">          &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;</span><br><span class="line">          &lt;version&gt;3.9&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Weather-java文件代码"><a href="#Weather-java文件代码" class="headerlink" title="Weather.java文件代码"></a>Weather.java文件代码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">package com.youkeda.test.j3.c9.model;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * 天气模型</span><br><span class="line"> *&#x2F;</span><br><span class="line">public class Weather &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 天气详情</span><br><span class="line">    private WeatherInfo weatherinfo;</span><br><span class="line">  </span><br><span class="line">    public WeatherInfo getWeatherinfo() &#123;</span><br><span class="line">      return weatherinfo;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    public void setWeatherinfo(WeatherInfo weatherinfo) &#123;</span><br><span class="line">      this.weatherinfo &#x3D; weatherinfo;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h4 id="WeatherInfo-java文件代码"><a href="#WeatherInfo-java文件代码" class="headerlink" title="WeatherInfo.java文件代码"></a>WeatherInfo.java文件代码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.test.j3.c9.model;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 天气详情模型</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeatherInfo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String city;</span><br><span class="line">  <span class="keyword">private</span> String cityid;</span><br><span class="line">  <span class="keyword">private</span> String temp;</span><br><span class="line">  <span class="keyword">private</span> String WD;</span><br><span class="line">  <span class="keyword">private</span> String WS;</span><br><span class="line">  <span class="keyword">private</span> String SD;</span><br><span class="line">  <span class="keyword">private</span> String AP;</span><br><span class="line">  <span class="keyword">private</span> String njd;</span><br><span class="line">  <span class="keyword">private</span> String WSE;</span><br><span class="line">  <span class="keyword">private</span> String time;</span><br><span class="line">  <span class="keyword">private</span> String sm;</span><br><span class="line">  <span class="keyword">private</span> String isRadar;</span><br><span class="line">  <span class="keyword">private</span> String Radar;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getCity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> city;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCity</span><span class="params">(String city)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.city = city;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getCityid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> cityid;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCityid</span><span class="params">(String cityid)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.cityid = cityid;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getTemp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTemp</span><span class="params">(String temp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.temp = temp;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getWD</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> WD;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWD</span><span class="params">(String WD)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.WD = WD;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getWS</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> WS;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWS</span><span class="params">(String WS)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.WS = WS;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getSD</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> SD;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSD</span><span class="params">(String SD)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.SD = SD;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getAP</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> AP;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAP</span><span class="params">(String AP)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.AP = AP;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getNjd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> njd;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNjd</span><span class="params">(String njd)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.njd = njd;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getWSE</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> WSE;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWSE</span><span class="params">(String WSE)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.WSE = WSE;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getTime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> time;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTime</span><span class="params">(String time)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.time = time;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getSm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sm;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSm</span><span class="params">(String sm)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.sm = sm;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getIsRadar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> isRadar;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIsRadar</span><span class="params">(String isRadar)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.isRadar = isRadar;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getRadar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Radar;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRadar</span><span class="params">(String radar)</span> </span>&#123;</span><br><span class="line">    Radar = radar;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="PageOperator-java文件代码"><a href="#PageOperator-java文件代码" class="headerlink" title="PageOperator.java文件代码"></a>PageOperator.java文件代码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.test.j3.c9;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.youkeda.test.j3.c9.model.Weather;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Call;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageOperator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// okHttpClient 实例</span></span><br><span class="line">  <span class="keyword">private</span> OkHttpClient okHttpClient;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">PageOperator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1. 构建 okHttpClient 实例</span></span><br><span class="line">    okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getPageContentSync</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 参数判断，未输入参数则直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(url)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">    <span class="comment">//3.使用client去请求</span></span><br><span class="line">    Call call = okHttpClient.newCall(request);</span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">//4.获得返回结果</span></span><br><span class="line">      result = call.execute().body().string();</span><br><span class="line">      System.out.println(<span class="string">"call "</span> + url + <span class="string">" , content's size="</span> + result.length());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    PageOperator po = <span class="keyword">new</span> PageOperator();</span><br><span class="line">    String content = po.getPageContentSync(<span class="string">"http://www.weather.com.cn/data/sk/101040200.html"</span>);</span><br><span class="line">    Weather weather = JSON.parseObject(content, Weather<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    System.out.println(<span class="string">"city="</span> + weather.getWeatherinfo().getCity());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/07/25/day16/" data-id="ckdn9i6n9000bjwux7621fen4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SMTP%E3%80%81javaMail%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81%E3%80%81%E5%AE%9E%E6%88%98%E5%A4%A9%E6%B0%94/" rel="tag">SMTP、javaMail邮件发送、实战天气</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-day15" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/24/day15/" class="article-date">
  <time datetime="2020-07-24T14:15:12.000Z" itemprop="datePublished">2020-07-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/24/day15/">day15</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="写入文本文件"><a href="#写入文本文件" class="headerlink" title="写入文本文件"></a>写入文本文件</h3><p>在程序中写入字符串内容的语句:➊<br>import java.io.File;<br>import java. io.FileWriter;<br>//文件对象<br>File file = new File(“foo.txt”);<br>//写入内容<br>FileWriter fileWritter =<br>new Filewriter(file. getName()<br>fileWritter .Write(content);<br>//关闭<br>filewritter.close();</p>
<p><strong>file指文件类，FileWriter指给文件写入内容的类</strong></p>
<h3 id="写入二进制文件"><a href="#写入二进制文件" class="headerlink" title="写入二进制文件"></a>写入二进制文件</h3><p>假设文件数据的变量是| byte[] data, 那么写入本地文件的代码如下:<br>import java. io.File;<br>import java. io.Fileoutputstream;<br>// 文件对象<br>File file = new File(“china-city-list.xlsx”);<br>//写文件<br>File0utputStream fos = new Fileoutputstream(file);<br>fos.write(data);<br>//必须刷新并关闭<br>fos. flush();<br>fos.close();</p>
<h3 id="例题：请求txt文件，将内容写入本地文件h-txt文本文件"><a href="#例题：请求txt文件，将内容写入本地文件h-txt文本文件" class="headerlink" title="例题：请求txt文件，将内容写入本地文件h.txt文本文件"></a>例题：请求txt文件，将内容写入本地文件h.txt文本文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.test.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Call;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Response;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApiAsker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// okHttpClient 实例</span></span><br><span class="line">    OkHttpClient okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">    <span class="comment">// 定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">    <span class="comment">// 返回结果字符串</span></span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 执行请求</span></span><br><span class="line">      Response response = okHttpClient.newCall(request).execute();</span><br><span class="line">      <span class="comment">// 获取响应内容</span></span><br><span class="line">      result = response.body().string();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      <span class="comment">// 抓取异常</span></span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String url = <span class="string">"https://style.youkeda.com/img/ham/course/py2/h.txt"</span>;</span><br><span class="line">    ApiAsker asker = <span class="keyword">new</span> ApiAsker();</span><br><span class="line">    String content = asker.getContent(url);</span><br><span class="line">  </span><br><span class="line">    System.out.println(<span class="string">"文件内容："</span> + content);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 内容写文件</span></span><br><span class="line">       File file = <span class="keyword">new</span> File(<span class="string">"h.txt"</span>);  </span><br><span class="line"></span><br><span class="line">      FileWriter fileWritter = <span class="keyword">new</span> FileWriter(file.getName());  </span><br><span class="line">      fileWritter.write(content);  </span><br><span class="line"></span><br><span class="line">      fileWritter.close();  </span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">"下载成功"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="例题：-请求线上excel文件写入本地xzq-201907-xlsx-文件"><a href="#例题：-请求线上excel文件写入本地xzq-201907-xlsx-文件" class="headerlink" title="例题： 请求线上excel文件写入本地xzq_201907.xlsx 文件"></a>例题： 请求线上excel文件写入本地xzq_201907.xlsx 文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.test.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> okhttp3.Call;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Response;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelAsker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">byte</span>[] getFile(String url) &#123;</span><br><span class="line">    <span class="comment">// okHttpClient 实例</span></span><br><span class="line">    OkHttpClient okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">    <span class="comment">// 定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">    <span class="keyword">byte</span>[] bytes = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 执行请求</span></span><br><span class="line">      Response response = okHttpClient.newCall(request).execute();</span><br><span class="line">      bytes = response.body().bytes();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      <span class="comment">// 抓取异常</span></span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bytes;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String url = <span class="string">"https://style.youkeda.com/img/ham/course/py2/xzq_201907.xlsx"</span>;</span><br><span class="line">    ExcelAsker asker = <span class="keyword">new</span> ExcelAsker();</span><br><span class="line">    <span class="keyword">byte</span>[] data = asker.getFile(url);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 写文件</span></span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">"xzq_201907.xlsx"</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 写文件</span></span><br><span class="line">        FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(file);</span><br><span class="line">         fos.write(data);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 必须刷新并关闭</span></span><br><span class="line">       fos.flush();</span><br><span class="line">        fos.close();</span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">"下载成功"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="下载图片"><a href="#下载图片" class="headerlink" title="下载图片"></a>下载图片</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.test.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Call;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Response;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ImageAsker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">byte</span>[] getImage(String url) &#123;</span><br><span class="line">    <span class="comment">// okHttpClient 实例</span></span><br><span class="line">    OkHttpClient okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">    <span class="comment">// 定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">    <span class="keyword">byte</span>[] bytes = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 执行请求</span></span><br><span class="line">      Response response = okHttpClient.newCall(request).execute();</span><br><span class="line">      bytes = response.body().bytes();</span><br><span class="line">      System.out.println(<span class="string">"图片大小为： "</span> + bytes.length + <span class="string">" 字节"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      <span class="comment">// 抓取异常</span></span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bytes;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String url = <span class="string">"https://n.sinaimg.cn/news/1_img/dfic/72f96829/125/w1024h701/20191209/e270-iknhexh8551480.jpg"</span>;</span><br><span class="line">    ImageAsker asker = <span class="keyword">new</span> ImageAsker();</span><br><span class="line">    <span class="keyword">byte</span>[] data = asker.getImage(url);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      File file = <span class="keyword">new</span> File(<span class="string">"e270-iknhexh8551480.jpg"</span>);</span><br><span class="line"></span><br><span class="line">      FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(file);</span><br><span class="line">      fos.write(data);</span><br><span class="line"></span><br><span class="line">      fos.flush();</span><br><span class="line">      fos.close();</span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">"下载成功"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="解析excel"><a href="#解析excel" class="headerlink" title="解析excel"></a>解析excel</h2><h4 id="依赖库：easyexce"><a href="#依赖库：easyexce" class="headerlink" title="依赖库：easyexce"></a>依赖库：easyexce</h4><p>在pom.xml 文件中写入：</p>
<dependency>
  <groupId>com.alibaba</groupId>
  <artifactId>easyexcel</artifactId>
  <version>2.1.6</version>
</dependency>

<h4 id="调用库"><a href="#调用库" class="headerlink" title="调用库"></a>调用库</h4><p>大家都知道，excel| 文件是多sheet 模式的，每各sheet实际上是一个表格，表格又分为行和列。<br>所以解析数据的路径一定是:sheet -&gt;行-&gt;列牢记计算机中，第一个单元格的位置是 0.第一个sheet第一行、第一列的位置是0,0,0</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取第一个sheet</span></span><br><span class="line">List&lt;Map&lt;Integer, String&gt;&gt; sheetDatas = EasyExcel.read(<span class="string">"xzq_201907.xlsx"</span>).sheet(<span class="number">0</span>).doReadSync();</span><br><span class="line"><span class="comment">// List 中每个元素表示一行</span></span><br><span class="line"><span class="keyword">for</span> (Map&lt;Integer, String&gt; rowData : sheetDatas) &#123;</span><br><span class="line">  <span class="comment">// Map 中用序号指代每一列</span></span><br><span class="line">  <span class="keyword">for</span> (Integer index : rowData.keySet()) &#123;</span><br><span class="line">    <span class="comment">// 列值</span></span><br><span class="line">    String columnValue = rowData.get(index);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>解析文件的第一个步骤是读取文件内容,调用<strong>EasyExcel.read()</strong>方法，传入文件名称。然后这里解析的第一个工作表，所以调用<strong>sheet()</strong>方法，传入参数0。最后的doReadsync()表示同步方式读取文件内容,<strong>返回一个读取到的内容集合list.。</strong>这是一个连贯的写法。返回的List集合中，系统用Map类表示一行数据(因为系统不知道excel|对应什么具体的对象，其实Map可以当做一种通用的对象)</p>
<p><img src="https://style.youkeda.com/img/ham/course/py2/j14-5-3-1.svg" alt></p>
<h3 id="自动转换为类"><a href="#自动转换为类" class="headerlink" title="自动转换为类"></a>自动转换为类</h3><p>在不能提前确定excel文件每一列的含义时， 或者复杂场景下excel文件的列经常变化，用Map 表示每-列的数据比较好。但是如果知道| excel 文件每一列的含义,用<strong>自定义类</strong>来表示,会更加直观。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取第一个sheet</span></span><br><span class="line">List&lt;DemoData&gt; sheetDatas = EasyExcel.read(<span class="string">"xzq_201907.xlsx"</span>).head(DemoData<span class="class">.<span class="keyword">class</span>).<span class="title">sheet</span>(0).<span class="title">doReadSync</span>()</span>;</span><br></pre></td></tr></table></figure>

<p>注意这里多调用了一个方法:<strong>. head(DemoData.class) ,DemoData就是自定义的类</strong>，表示-行数据，类的每个属性都表示一列的值。Map更灵活，自定义类更直观易理解。一 般列数不太多(不超过10个)、不会变化,鹏定义类返回值为List<DemoData> 就表示把<strong>每一行</strong>都转换为-个<strong>DemoData的实例对象</strong>，放入<strong>List 集合</strong>中。</DemoData></p>
<p><img src="https://style.youkeda.com/img/ham/course/py2/j14-5-3-2.svg" alt></p>
<h3 id="例题："><a href="#例题：" class="headerlink" title="例题："></a>例题：</h3><dependencies>

<pre><code>  &lt;dependency&gt;
    &lt;groupId&gt;com.squareup.okhttp3&lt;/groupId&gt;
    &lt;artifactId&gt;okhttp&lt;/artifactId&gt;
    &lt;version&gt;4.1.0&lt;/version&gt;
  &lt;/dependency&gt;

  &lt;!-- JSON 操作库 --&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;
    &lt;version&gt;1.2.62&lt;/version&gt;
  &lt;/dependency&gt;

  &lt;!-- excel 操作库 --&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
    &lt;artifactId&gt;easyexcel&lt;/artifactId&gt;
    &lt;version&gt;2.1.6&lt;/version&gt;
  &lt;/dependency&gt;

&lt;/dependencies&gt;</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.test.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoData</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String code1;</span><br><span class="line">  <span class="keyword">private</span> String city1;</span><br><span class="line">  <span class="keyword">private</span> String code2;</span><br><span class="line">  <span class="keyword">private</span> String city2;</span><br><span class="line">  <span class="keyword">private</span> String code3;</span><br><span class="line">  <span class="keyword">private</span> String city3;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getCode1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> code1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode1</span><span class="params">(String code1)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.code1 = code1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getCity1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> city1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCity1</span><span class="params">(String city1)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.city1 = city1;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getCode2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> code2;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode2</span><span class="params">(String code2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.code2 = code2;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getCity2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> city2;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCity2</span><span class="params">(String city2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.city2 = city2;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getCode3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> code3;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode3</span><span class="params">(String code3)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.code3 = code3;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getCity3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> city3;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCity3</span><span class="params">(String city3)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.city3 = city3;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.test.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Response;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelAsker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">byte</span>[] getFile(String url) &#123;</span><br><span class="line">    <span class="comment">// okHttpClient 实例</span></span><br><span class="line">    OkHttpClient okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">    <span class="comment">// 定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder().url(url).build();</span><br><span class="line">    <span class="keyword">byte</span>[] bytes = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 执行请求</span></span><br><span class="line">      Response response = okHttpClient.newCall(request).execute();</span><br><span class="line">      bytes = response.body().bytes();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      <span class="comment">// 抓取异常</span></span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bytes;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String url = <span class="string">"https://style.youkeda.com/img/ham/course/py2/xzq_201907.xlsx"</span>;</span><br><span class="line">    ExcelAsker asker = <span class="keyword">new</span> ExcelAsker();</span><br><span class="line">    <span class="keyword">byte</span>[] data = asker.getFile(url);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      File file = <span class="keyword">new</span> File(<span class="string">"xzq_201907.xlsx"</span>);</span><br><span class="line"></span><br><span class="line">      FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(file);</span><br><span class="line">      fos.write(data);</span><br><span class="line"></span><br><span class="line">      fos.flush();</span><br><span class="line">      fos.close();</span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">"下载成功"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    List&lt;DemoData&gt; sheetDatas = EasyExcel.read(<span class="string">"xzq_201907.xlsx"</span>).head(DemoData<span class="class">.<span class="keyword">class</span>).<span class="title">sheet</span>(0).<span class="title">doReadSync</span>()</span>;</span><br><span class="line">    <span class="keyword">for</span> (DemoData rowData : sheetDatas) &#123;</span><br><span class="line">      System.out.println(JSON.toJSONString(rowData));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><p><strong>步骤：打开豆瓣网，登录，打开我的豆瓣找到cookie,复制cookie的值到cookie.txt，编码实现</strong><img src="https://style.youkeda.com/img/ham/course/py2/py2-6-1-5.png" style="zoom: 25%;"></p>
<h3 id="例题：-1"><a href="#例题：-1" class="headerlink" title="例题："></a>例题：</h3> <dependencies>
      <dependency>
        <groupId>com.squareup.okhttp3</groupId>    
        <artifactId>okhttp</artifactId>    
        <version>4.1.0</version>    
      </dependency>
    </dependencies>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.test.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 读文件工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReadFileTool</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 读取指定文件的内容</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">readContent</span><span class="params">(String fileName)</span> </span>&#123;</span><br><span class="line">    FileReader fr = <span class="keyword">null</span>;</span><br><span class="line">    StringBuilder strBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      fr = <span class="keyword">new</span> FileReader(fileName);</span><br><span class="line">      <span class="keyword">int</span> ch = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span> ((ch = fr.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">        strBuilder.append((<span class="keyword">char</span>) ch);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (fr != <span class="keyword">null</span>) &#123;</span><br><span class="line">          fr.close();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> strBuilder.toString();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.test.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Call;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Response;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageAsker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// okHttpClient 实例</span></span><br><span class="line">    OkHttpClient okHttpClient = <span class="keyword">new</span> OkHttpClient();</span><br><span class="line">    <span class="comment">// 定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder()</span><br><span class="line">        .url(url)</span><br><span class="line">        .addHeader(<span class="string">"User-Agent"</span>, <span class="string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36"</span>)</span><br><span class="line">        .addHeader(<span class="string">"Referer"</span>, <span class="string">"https://www.douban.com/mine"</span>)</span><br><span class="line">        .addHeader(<span class="string">"Host"</span>, <span class="string">"www.douban.com"</span>)</span><br><span class="line">        .addHeader(<span class="string">"cookie"</span>,ReadFileTool.readContent(<span class="string">"cookie.txt"</span>))</span><br><span class="line">        .build();</span><br><span class="line">    <span class="comment">// 返回结果字符串</span></span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 执行请求</span></span><br><span class="line">      Response response = okHttpClient.newCall(request).execute();</span><br><span class="line">      result = response.body().string();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String url = <span class="string">"https://www.douban.com/mine"</span>;</span><br><span class="line">    PageAsker asker = <span class="keyword">new</span> PageAsker();</span><br><span class="line">    String content = asker.getContent(url);</span><br><span class="line"></span><br><span class="line">    System.out.println(content);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="session"><a href="#session" class="headerlink" title="session"></a>session</h2><h4 id="一、先登录，再收集信息"><a href="#一、先登录，再收集信息" class="headerlink" title="一、先登录，再收集信息"></a>一、先登录，再收集信息</h4><p><img src="https://style.youkeda.com/img/ham/course/py2/py2-6-1-7.png" alt></p>
<p><img src="https://style.youkeda.com/img/ham/course/py2/py2-6-1-6.png" alt></p>
<h4 id="二、需要收集的关键信息包括"><a href="#二、需要收集的关键信息包括" class="headerlink" title="二、需要收集的关键信息包括:"></a>二、需要收集的关键信息包括:</h4><p>  1.登录地址<br>2.执行方式(GET/POST) </p>
<p>3.HOST</p>
<p>4.Referer</p>
<p>5.User-Agent<br>6.表单数据，数据名称和数据值。<br>由于每个网站登录相关的信息都不一样，所以必须在手动登录的过程中收集信息。大家学会这个方法,就可以模拟期网站登录。</p>
<h4 id="三、编码实现"><a href="#三、编码实现" class="headerlink" title="三、编码实现"></a>三、编码实现</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.test.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Cookie;</span><br><span class="line"><span class="keyword">import</span> okhttp3.CookieJar;</span><br><span class="line"><span class="keyword">import</span> okhttp3.FormBody;</span><br><span class="line"><span class="keyword">import</span> okhttp3.FormBody.Builder;</span><br><span class="line"><span class="keyword">import</span> okhttp3.HttpUrl;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageLoginer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 用 CookieJar 实现 cookie 的存储，便于登录后请求其它 URL 可以复用</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> OkHttpClient okHttpClient = <span class="keyword">new</span> OkHttpClient.Builder()</span><br><span class="line">      .cookieJar(<span class="keyword">new</span> CookieJar() &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> HashMap&lt;String, List&lt;Cookie&gt;&gt; cookieStore = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveFromResponse</span><span class="params">(HttpUrl url, List&lt;Cookie&gt; cookies)</span> </span>&#123;</span><br><span class="line">          cookieStore.put(<span class="string">"mtime.com"</span>, cookies);</span><br><span class="line">          System.out.println(<span class="string">"[saveFromResponse]url.host()="</span> + url.host());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> List&lt;Cookie&gt; <span class="title">loadForRequest</span><span class="params">(HttpUrl url)</span> </span>&#123;</span><br><span class="line">          System.out.println(<span class="string">"[loadForRequest]url.host()="</span> + url.host());</span><br><span class="line">          List&lt;Cookie&gt; cookies = cookieStore.get(<span class="string">"mtime.com"</span>);</span><br><span class="line">          <span class="keyword">return</span> cookies != <span class="keyword">null</span> ? cookies : <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      .build();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">postContent</span><span class="params">(String url, Map&lt;String, String&gt; formData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//post方式提交的数据</span></span><br><span class="line">    Builder builder = <span class="keyword">new</span> FormBody.Builder();</span><br><span class="line">    <span class="comment">// 放入表单数据</span></span><br><span class="line">    <span class="keyword">for</span> (String key : formData.keySet()) &#123;</span><br><span class="line">      builder.add(key, formData.get(key));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 构建 FormBody 对象</span></span><br><span class="line">    FormBody formBody = builder.build();</span><br><span class="line">    <span class="comment">// 指定 post 方式提交FormBody</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder()</span><br><span class="line">        .url(url)</span><br><span class="line">        .post(formBody)</span><br><span class="line">        .addHeader(<span class="string">"User-Agent"</span>,</span><br><span class="line">            <span class="string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36"</span>)</span><br><span class="line">        .addHeader(<span class="string">"Referer"</span>,</span><br><span class="line">            <span class="string">"https://passport.mtime.com/member/signin/?redirectUrl=http%3A%2F%2Fwww.mtime.com%2F"</span>)</span><br><span class="line">        .addHeader(<span class="string">"Host"</span>, <span class="string">"passport.mtime.com"</span>)</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回结果字符串</span></span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      result = okHttpClient.newCall(request).execute().body().string();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      System.out.println(<span class="string">"request "</span> + url + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 登录页面 url</span></span><br><span class="line">    String url = <span class="string">"https://passport.mtime.com/member/signinLogin"</span>;</span><br><span class="line">    <span class="comment">// 登录表单数据</span></span><br><span class="line">    Map&lt;String, String&gt; formData = <span class="keyword">new</span> HashMap();</span><br><span class="line">    formData.put(<span class="string">"loginEmailText"</span>, <span class="string">"13777467803"</span>);</span><br><span class="line">    formData.put(<span class="string">"loginPasswordText"</span>, <span class="string">"aa787bc9cc97ba5d27cc042ecffe1489"</span>);</span><br><span class="line">    formData.put(<span class="string">"isvcode"</span>, <span class="string">"true"</span>);</span><br><span class="line">    formData.put(<span class="string">"isAutoSign"</span>, <span class="string">"false"</span>);</span><br><span class="line"></span><br><span class="line">    PageLoginer asker = <span class="keyword">new</span> PageLoginer();</span><br><span class="line">    String content = asker.postContent(url, formData);</span><br><span class="line"></span><br><span class="line">    System.out.println(content);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="复用session"><a href="#复用session" class="headerlink" title="复用session"></a>复用session</h3><h4 id="实现："><a href="#实现：" class="headerlink" title="实现："></a>实现：</h4><p>不知道大家注意没有，在上一节中,我们把OkHttpClient 对象进行重构，不再定义为postContent() 方法的变量。而是改为类变量:private static final OkHttpClient okHttpClient目的就是在整个类中，使用同一个okHttpClient 执行HTTP请求，提升效率。重构在本节课就派上用场了。</p>
<p>分析执行两次请求的过程，实际上过程是类似的，区别是Request不同，所以，又做了一次重构,把真正执行的过程封装成一个方法:doExcute， 被其它| postContent() 和getContent()方法调用。这么做就是抽象的过程，目的是减少重复代码，提高可阅读性和可维护性。重构会伴随我们整个编程的生涯。请大家认真体会这个过程，还可以动手试一下,如果不重构，代码会是什么样的?</p>
<h3 id="代码案例-："><a href="#代码案例-：" class="headerlink" title="代码案例 ："></a>代码案例 ：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.youkeda.test.http;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Cookie;</span><br><span class="line"><span class="keyword">import</span> okhttp3.CookieJar;</span><br><span class="line"><span class="keyword">import</span> okhttp3.FormBody;</span><br><span class="line"><span class="keyword">import</span> okhttp3.FormBody.Builder;</span><br><span class="line"><span class="keyword">import</span> okhttp3.HttpUrl;</span><br><span class="line"><span class="keyword">import</span> okhttp3.OkHttpClient;</span><br><span class="line"><span class="keyword">import</span> okhttp3.Request;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageLoginer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 用 CookieJar 实现 cookie 的存储，便于登录后请求其它 URL 可以复用</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> OkHttpClient okHttpClient = <span class="keyword">new</span> OkHttpClient.Builder()</span><br><span class="line">      .cookieJar(<span class="keyword">new</span> CookieJar() &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> HashMap&lt;String, List&lt;Cookie&gt;&gt; cookieStore = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveFromResponse</span><span class="params">(HttpUrl url, List&lt;Cookie&gt; cookies)</span> </span>&#123;</span><br><span class="line">          cookieStore.put(<span class="string">"mtime.com"</span>, cookies);</span><br><span class="line">          <span class="comment">//System.out.println("[saveFromResponse]url.host()=" + url.host());</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> List&lt;Cookie&gt; <span class="title">loadForRequest</span><span class="params">(HttpUrl url)</span> </span>&#123;</span><br><span class="line">          <span class="comment">//System.out.println("[loadForRequest]url.host()=" + url.host());</span></span><br><span class="line">          List&lt;Cookie&gt; cookies = cookieStore.get(<span class="string">"mtime.com"</span>);</span><br><span class="line">          <span class="keyword">return</span> cookies != <span class="keyword">null</span> ? cookies : <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      .build();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 向指定的 URL 提交数据，并返回提交后的结果</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">postContent</span><span class="params">(String url, Map&lt;String, String&gt; formData)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//post方式提交的数据</span></span><br><span class="line">    Builder builder = <span class="keyword">new</span> FormBody.Builder();</span><br><span class="line">    <span class="comment">// 放入表单数据</span></span><br><span class="line">    <span class="keyword">for</span> (String key : formData.keySet()) &#123;</span><br><span class="line">      builder.add(key, formData.get(key));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 构建 FormBody 对象</span></span><br><span class="line">    FormBody formBody = builder.build();</span><br><span class="line">    <span class="comment">// 指定 post 方式提交FormBody</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder()</span><br><span class="line">        .url(url)</span><br><span class="line">        .post(formBody)</span><br><span class="line">        .addHeader(<span class="string">"User-Agent"</span>,</span><br><span class="line">            <span class="string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36"</span>)</span><br><span class="line">        .addHeader(<span class="string">"Referer"</span>,</span><br><span class="line">            <span class="string">"https://passport.mtime.com/member/signin/?redirectUrl=http%3A%2F%2Fwww.mtime.com%2F"</span>)</span><br><span class="line">        .addHeader(<span class="string">"Host"</span>, <span class="string">"passport.mtime.com"</span>)</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> doExcute(request);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 根据输入的url，读取页面内容并返回</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 定义一个request</span></span><br><span class="line">    Request request = <span class="keyword">new</span> Request.Builder()</span><br><span class="line">        .url(url)</span><br><span class="line">        .addHeader(<span class="string">"User-Agent"</span>,</span><br><span class="line">            <span class="string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36"</span>)</span><br><span class="line">        .addHeader(<span class="string">"Host"</span>, <span class="string">"my.mtime.com"</span>)</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> doExcute(request);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> String <span class="title">doExcute</span><span class="params">(Request request)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 返回结果字符串</span></span><br><span class="line">    String result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      result = okHttpClient.newCall(request).execute().body().string();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      <span class="comment">// 抓取异常</span></span><br><span class="line">      System.out.println(<span class="string">"request "</span> + request.url() + <span class="string">" error . "</span>);</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    PageLoginer asker = <span class="keyword">new</span> PageLoginer();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 完成登录</span></span><br><span class="line">    String url = <span class="string">"https://passport.mtime.com/member/signinLogin"</span>;</span><br><span class="line">    <span class="comment">// 登录表单数据</span></span><br><span class="line">    Map&lt;String, String&gt; formData = <span class="keyword">new</span> HashMap();</span><br><span class="line">    formData.put(<span class="string">"loginEmailText"</span>, <span class="string">"13777467803"</span>);</span><br><span class="line">    formData.put(<span class="string">"loginPasswordText"</span>, <span class="string">"aa787bc9cc97ba5d27cc042ecffe1489"</span>);</span><br><span class="line">    formData.put(<span class="string">"isvcode"</span>, <span class="string">"true"</span>);</span><br><span class="line">    formData.put(<span class="string">"isAutoSign"</span>, <span class="string">"false"</span>);</span><br><span class="line">    String content = asker.postContent(url, formData);</span><br><span class="line">    System.out.println(<span class="string">"login result:"</span>);</span><br><span class="line">    System.out.println(content);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 请求我的订单</span></span><br><span class="line">    String myOrderUrl = <span class="string">"http://my.mtime.com/account/ecommerce/orderList/"</span>;</span><br><span class="line">    String myOrderContent = asker.getContent(myOrderUrl);</span><br><span class="line">    System.out.println(<span class="string">"orderList result:"</span>);</span><br><span class="line">    System.out.println(myOrderContent);</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</dependencies>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/07/24/day15/" data-id="ckdn9i6n7000ajwuxg6nu435x" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E5%9B%BE%E7%89%87%E3%80%81%E8%A7%A3%E6%9E%90excel%E3%80%81cookie%E3%80%81session%E3%80%81%E5%A4%8D%E7%94%A8session/" rel="tag">下载文件图片、解析excel、cookie、session、复用session</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B-Response-%E7%BD%91%E9%A1%B5-Response-%E9%9D%9E%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6-Response-JSON/" rel="tag">Java网络编程 Response-网页 Response-非文本文件 Response-JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SMTP%E3%80%81javaMail%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81%E3%80%81%E5%AE%9E%E6%88%98%E5%A4%A9%E6%B0%94/" rel="tag">SMTP、javaMail邮件发送、实战天气</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/User-Agent%E3%80%81Referer%E3%80%81Host/" rel="tag">User-Agent、Referer、Host</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css-%E5%AE%9A%E4%BD%8D-position/" rel="tag">css 定位- position</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css%E7%9B%92%E6%A8%A1%E5%9E%8B/" rel="tag">css盒模型</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B-GET%E8%AF%B7%E6%B1%82/" rel="tag">java网络编程   GET请求</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" rel="tag">java面向对象-项目实战</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/list%E5%92%8C%E6%95%B0%E7%BB%84%E7%9A%84%E8%BD%AC%E6%8D%A2%E4%BB%A5%E5%8F%8A-%E9%9B%86%E5%90%88List%E7%9A%84%E6%93%8D%E4%BD%9C/" rel="tag">list和数组的转换以及 集合List的操作</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E5%9B%BE%E7%89%87%E3%80%81%E8%A7%A3%E6%9E%90excel%E3%80%81cookie%E3%80%81session%E3%80%81%E5%A4%8D%E7%94%A8session/" rel="tag">下载文件图片、解析excel、cookie、session、复用session</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F%E3%80%81%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E3%80%81%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E3%80%81%E4%BA%8C%E5%88%86%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/" rel="tag">冒泡排序、选择排序、插入排序、二分插入排序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9B%BE%E4%BA%91/" rel="tag">图云</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9E%E6%88%98%E7%BD%91%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90/" rel="tag">实战网易云音乐</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%B0%8F%E6%A1%88%E4%BE%8B-%E4%BA%8C%E5%88%86%E6%B3%95%E6%9F%A5%E6%89%BE%E3%80%81-%E4%BA%8C%E6%AC%A1%E9%97%AE%E9%A2%98%EF%BC%88%E6%A0%87%E8%AE%B0%E6%B3%95%EF%BC%89%E3%80%81%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E3%80%81-%E6%95%B0%E7%BB%84-%E5%AD%98%E5%82%A8%E5%92%8C%E8%AF%BB%E5%8F%96%E3%80%81%E6%95%B0%E7%BB%84%E6%8F%92%E5%85%A5%E5%92%8C%E5%88%A0%E9%99%A4/" rel="tag">性能优化小案例-二分法查找、 二次问题（标记法）、计算机内存管理、 数组-存储和读取、数组插入和删除</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8%E5%89%8D%E8%A8%80%E3%80%81-%E5%A4%A7O%E8%AE%B0%E6%B3%95%E3%80%81%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E3%80%81%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/" rel="tag">数据结构及算法入门前言、 大O记法、时间复杂度、空间复杂度</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%92%E5%BD%92%E3%80%81%E5%88%86%E6%B2%BB%E6%80%9D%E6%83%B3-%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E3%80%81%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F%E3%80%81%E5%BF%AB%E9%80%9F%E9%80%89%E6%8B%A9/" rel="tag">递归、分治思想-归并排序、快速排序、快速选择</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Java%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B-Response-%E7%BD%91%E9%A1%B5-Response-%E9%9D%9E%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6-Response-JSON/" style="font-size: 10px;">Java网络编程 Response-网页 Response-非文本文件 Response-JSON</a> <a href="/tags/SMTP%E3%80%81javaMail%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81%E3%80%81%E5%AE%9E%E6%88%98%E5%A4%A9%E6%B0%94/" style="font-size: 10px;">SMTP、javaMail邮件发送、实战天气</a> <a href="/tags/User-Agent%E3%80%81Referer%E3%80%81Host/" style="font-size: 10px;">User-Agent、Referer、Host</a> <a href="/tags/css-%E5%AE%9A%E4%BD%8D-position/" style="font-size: 10px;">css 定位- position</a> <a href="/tags/css%E7%9B%92%E6%A8%A1%E5%9E%8B/" style="font-size: 10px;">css盒模型</a> <a href="/tags/java%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B-GET%E8%AF%B7%E6%B1%82/" style="font-size: 10px;">java网络编程   GET请求</a> <a href="/tags/java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" style="font-size: 10px;">java面向对象-项目实战</a> <a href="/tags/list%E5%92%8C%E6%95%B0%E7%BB%84%E7%9A%84%E8%BD%AC%E6%8D%A2%E4%BB%A5%E5%8F%8A-%E9%9B%86%E5%90%88List%E7%9A%84%E6%93%8D%E4%BD%9C/" style="font-size: 10px;">list和数组的转换以及 集合List的操作</a> <a href="/tags/%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E5%9B%BE%E7%89%87%E3%80%81%E8%A7%A3%E6%9E%90excel%E3%80%81cookie%E3%80%81session%E3%80%81%E5%A4%8D%E7%94%A8session/" style="font-size: 10px;">下载文件图片、解析excel、cookie、session、复用session</a> <a href="/tags/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F%E3%80%81%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E3%80%81%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E3%80%81%E4%BA%8C%E5%88%86%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F/" style="font-size: 10px;">冒泡排序、选择排序、插入排序、二分插入排序</a> <a href="/tags/%E5%9B%BE%E4%BA%91/" style="font-size: 10px;">图云</a> <a href="/tags/%E5%AE%9E%E6%88%98%E7%BD%91%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90/" style="font-size: 10px;">实战网易云音乐</a> <a href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%B0%8F%E6%A1%88%E4%BE%8B-%E4%BA%8C%E5%88%86%E6%B3%95%E6%9F%A5%E6%89%BE%E3%80%81-%E4%BA%8C%E6%AC%A1%E9%97%AE%E9%A2%98%EF%BC%88%E6%A0%87%E8%AE%B0%E6%B3%95%EF%BC%89%E3%80%81%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E3%80%81-%E6%95%B0%E7%BB%84-%E5%AD%98%E5%82%A8%E5%92%8C%E8%AF%BB%E5%8F%96%E3%80%81%E6%95%B0%E7%BB%84%E6%8F%92%E5%85%A5%E5%92%8C%E5%88%A0%E9%99%A4/" style="font-size: 10px;">性能优化小案例-二分法查找、 二次问题（标记法）、计算机内存管理、 数组-存储和读取、数组插入和删除</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%8F%8A%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8%E5%89%8D%E8%A8%80%E3%80%81-%E5%A4%A7O%E8%AE%B0%E6%B3%95%E3%80%81%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E3%80%81%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6/" style="font-size: 10px;">数据结构及算法入门前言、 大O记法、时间复杂度、空间复杂度</a> <a href="/tags/%E9%80%92%E5%BD%92%E3%80%81%E5%88%86%E6%B2%BB%E6%80%9D%E6%83%B3-%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E3%80%81%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F%E3%80%81%E5%BF%AB%E9%80%9F%E9%80%89%E6%8B%A9/" style="font-size: 10px;">递归、分治思想-归并排序、快速排序、快速选择</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/08/08/day26/">day26</a>
          </li>
        
          <li>
            <a href="/2020/08/08/day25/">day25</a>
          </li>
        
          <li>
            <a href="/2020/08/02/day21/">day21</a>
          </li>
        
          <li>
            <a href="/2020/08/02/day20/">day20</a>
          </li>
        
          <li>
            <a href="/2020/07/28/day19/">day19</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>